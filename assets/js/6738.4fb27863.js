/*! For license information please see 6738.4fb27863.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6738],{66738:(t,i,s)=>{function e(t){var i=t.width,s=t.height;if(i<0)throw new Error("Negative width is not allowed for Size");if(s<0)throw new Error("Negative height is not allowed for Size");return{width:i,height:s}}function h(t,i){return t.width===i.width&&t.height===i.height}s.r(i),s.d(i,{ColorType:()=>Vs,CrosshairMode:()=>vt,LastPriceAnimationMode:()=>Ks,LineStyle:()=>w,LineType:()=>g,MismatchDirection:()=>ji,PriceLineSource:()=>Ds,PriceScaleMode:()=>ys,TickMarkType:()=>Bs,TrackingModeExitMode:()=>Ns,createChart:()=>Eh,createChartEx:()=>Ch,customSeriesDefaultOptions:()=>Th,isBusinessDay:()=>Is,isUTCTimestamp:()=>js,version:()=>zh});var n=function(){function t(t){var i=this;this._resolutionListener=function(){return i._onResolutionChanged()},this._resolutionMediaQueryList=null,this._observers=[],this._window=t,this._installResolutionListener()}return t.prototype.dispose=function(){this._uninstallResolutionListener(),this._window=null},Object.defineProperty(t.prototype,"value",{get:function(){return this._window.devicePixelRatio},enumerable:!1,configurable:!0}),t.prototype.subscribe=function(t){var i=this,s={next:t};return this._observers.push(s),{unsubscribe:function(){i._observers=i._observers.filter((function(t){return t!==s}))}}},t.prototype._installResolutionListener=function(){if(null!==this._resolutionMediaQueryList)throw new Error("Resolution listener is already installed");var t=this._window.devicePixelRatio;this._resolutionMediaQueryList=this._window.matchMedia("all and (resolution: ".concat(t,"dppx)")),this._resolutionMediaQueryList.addListener(this._resolutionListener)},t.prototype._uninstallResolutionListener=function(){null!==this._resolutionMediaQueryList&&(this._resolutionMediaQueryList.removeListener(this._resolutionListener),this._resolutionMediaQueryList=null)},t.prototype._reinstallResolutionListener=function(){this._uninstallResolutionListener(),this._installResolutionListener()},t.prototype._onResolutionChanged=function(){var t=this;this._observers.forEach((function(i){return i.next(t._window.devicePixelRatio)})),this._reinstallResolutionListener()},t}();var r=function(){function t(t,i,s){var h;this._canvasElement=null,this._bitmapSizeChangedListeners=[],this._suggestedBitmapSize=null,this._suggestedBitmapSizeChangedListeners=[],this._devicePixelRatioObservable=null,this._canvasElementResizeObserver=null,this._canvasElement=t,this._canvasElementClientSize=e({width:this._canvasElement.clientWidth,height:this._canvasElement.clientHeight}),this._transformBitmapSize=null!=i?i:function(t){return t},this._allowResizeObserver=null===(h=null==s?void 0:s.allowResizeObserver)||void 0===h||h,this._chooseAndInitObserver()}return t.prototype.dispose=function(){var t,i;if(null===this._canvasElement)throw new Error("Object is disposed");null===(t=this._canvasElementResizeObserver)||void 0===t||t.disconnect(),this._canvasElementResizeObserver=null,null===(i=this._devicePixelRatioObservable)||void 0===i||i.dispose(),this._devicePixelRatioObservable=null,this._suggestedBitmapSizeChangedListeners.length=0,this._bitmapSizeChangedListeners.length=0,this._canvasElement=null},Object.defineProperty(t.prototype,"canvasElement",{get:function(){if(null===this._canvasElement)throw new Error("Object is disposed");return this._canvasElement},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canvasElementClientSize",{get:function(){return this._canvasElementClientSize},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bitmapSize",{get:function(){return e({width:this.canvasElement.width,height:this.canvasElement.height})},enumerable:!1,configurable:!0}),t.prototype.resizeCanvasElement=function(t){this._canvasElementClientSize=e(t),this.canvasElement.style.width="".concat(this._canvasElementClientSize.width,"px"),this.canvasElement.style.height="".concat(this._canvasElementClientSize.height,"px"),this._invalidateBitmapSize()},t.prototype.subscribeBitmapSizeChanged=function(t){this._bitmapSizeChangedListeners.push(t)},t.prototype.unsubscribeBitmapSizeChanged=function(t){this._bitmapSizeChangedListeners=this._bitmapSizeChangedListeners.filter((function(i){return i!==t}))},Object.defineProperty(t.prototype,"suggestedBitmapSize",{get:function(){return this._suggestedBitmapSize},enumerable:!1,configurable:!0}),t.prototype.subscribeSuggestedBitmapSizeChanged=function(t){this._suggestedBitmapSizeChangedListeners.push(t)},t.prototype.unsubscribeSuggestedBitmapSizeChanged=function(t){this._suggestedBitmapSizeChangedListeners=this._suggestedBitmapSizeChangedListeners.filter((function(i){return i!==t}))},t.prototype.applySuggestedBitmapSize=function(){if(null!==this._suggestedBitmapSize){var t=this._suggestedBitmapSize;this._suggestedBitmapSize=null,this._resizeBitmap(t),this._emitSuggestedBitmapSizeChanged(t,this._suggestedBitmapSize)}},t.prototype._resizeBitmap=function(t){var i=this.bitmapSize;h(i,t)||(this.canvasElement.width=t.width,this.canvasElement.height=t.height,this._emitBitmapSizeChanged(i,t))},t.prototype._emitBitmapSizeChanged=function(t,i){var s=this;this._bitmapSizeChangedListeners.forEach((function(e){return e.call(s,t,i)}))},t.prototype._suggestNewBitmapSize=function(t){var i=this._suggestedBitmapSize,s=e(this._transformBitmapSize(t,this._canvasElementClientSize)),n=h(this.bitmapSize,s)?null:s;null===i&&null===n||null!==i&&null!==n&&h(i,n)||(this._suggestedBitmapSize=n,this._emitSuggestedBitmapSizeChanged(i,n))},t.prototype._emitSuggestedBitmapSizeChanged=function(t,i){var s=this;this._suggestedBitmapSizeChangedListeners.forEach((function(e){return e.call(s,t,i)}))},t.prototype._chooseAndInitObserver=function(){var t=this;this._allowResizeObserver?new Promise((function(t){var i=new ResizeObserver((function(s){t(s.every((function(t){return"devicePixelContentBoxSize"in t}))),i.disconnect()}));i.observe(document.body,{box:"device-pixel-content-box"})})).catch((function(){return!1})).then((function(i){return i?t._initResizeObserver():t._initDevicePixelRatioObservable()})):this._initDevicePixelRatioObservable()},t.prototype._initDevicePixelRatioObservable=function(){var t=this;if(null!==this._canvasElement){var i=o(this._canvasElement);if(null===i)throw new Error("No window is associated with the canvas");this._devicePixelRatioObservable=function(t){return new n(t)}(i),this._devicePixelRatioObservable.subscribe((function(){return t._invalidateBitmapSize()})),this._invalidateBitmapSize()}},t.prototype._invalidateBitmapSize=function(){var t,i;if(null!==this._canvasElement){var s=o(this._canvasElement);if(null!==s){var h=null!==(i=null===(t=this._devicePixelRatioObservable)||void 0===t?void 0:t.value)&&void 0!==i?i:s.devicePixelRatio,n=this._canvasElement.getClientRects(),r=void 0!==n[0]?function(t,i){return e({width:Math.round(t.left*i+t.width*i)-Math.round(t.left*i),height:Math.round(t.top*i+t.height*i)-Math.round(t.top*i)})}(n[0],h):e({width:this._canvasElementClientSize.width*h,height:this._canvasElementClientSize.height*h});this._suggestNewBitmapSize(r)}}},t.prototype._initResizeObserver=function(){var t=this;null!==this._canvasElement&&(this._canvasElementResizeObserver=new ResizeObserver((function(i){var s=i.find((function(i){return i.target===t._canvasElement}));if(s&&s.devicePixelContentBoxSize&&s.devicePixelContentBoxSize[0]){var h=s.devicePixelContentBoxSize[0],n=e({width:h.inlineSize,height:h.blockSize});t._suggestNewBitmapSize(n)}})),this._canvasElementResizeObserver.observe(this._canvasElement,{box:"device-pixel-content-box"}))},t}();function o(t){return t.ownerDocument.defaultView}var l=function(){function t(t,i,s){if(0===i.width||0===i.height)throw new TypeError("Rendering target could only be created on a media with positive width and height");if(this._mediaSize=i,0===s.width||0===s.height)throw new TypeError("Rendering target could only be created using a bitmap with positive integer width and height");this._bitmapSize=s,this._context=t}return t.prototype.useMediaCoordinateSpace=function(t){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),this._context.scale(this._horizontalPixelRatio,this._verticalPixelRatio),t({context:this._context,mediaSize:this._mediaSize})}finally{this._context.restore()}},t.prototype.useBitmapCoordinateSpace=function(t){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),t({context:this._context,mediaSize:this._mediaSize,bitmapSize:this._bitmapSize,horizontalPixelRatio:this._horizontalPixelRatio,verticalPixelRatio:this._verticalPixelRatio})}finally{this._context.restore()}},Object.defineProperty(t.prototype,"_horizontalPixelRatio",{get:function(){return this._bitmapSize.width/this._mediaSize.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_verticalPixelRatio",{get:function(){return this._bitmapSize.height/this._mediaSize.height},enumerable:!1,configurable:!0}),t}();function a(t,i){var s=t.canvasElementClientSize;if(0===s.width||0===s.height)return null;var e=t.bitmapSize;if(0===e.width||0===e.height)return null;var h=t.canvasElement.getContext("2d",i);return null===h?null:new l(h,s,e)}const u={upColor:"#26a69a",downColor:"#ef5350",wickVisible:!0,borderVisible:!0,borderColor:"#378658",borderUpColor:"#26a69a",borderDownColor:"#ef5350",wickColor:"#737375",wickUpColor:"#26a69a",wickDownColor:"#ef5350",cornerRadius:0,roundedWickTip:!1},c={upColor:"#26a69a",downColor:"#ef5350",openVisible:!0,thinBars:!0},d={color:"#2196f3",lineStyle:0,lineWidth:3,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},f={topColor:"rgba( 46, 220, 135, 0.4)",bottomColor:"rgba( 40, 221, 100, 0)",invertFilledArea:!1,lineColor:"#33D778",lineStyle:0,lineWidth:3,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},p={baseValue:{type:"price",price:0},topFillColor1:"rgba(38, 166, 154, 0.28)",topFillColor2:"rgba(38, 166, 154, 0.05)",topLineColor:"rgba(38, 166, 154, 1)",bottomFillColor1:"rgba(239, 83, 80, 0.05)",bottomFillColor2:"rgba(239, 83, 80, 0.28)",bottomLineColor:"rgba(239, 83, 80, 1)",lineWidth:3,lineStyle:0,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},m={color:"#26a69a",base:0,cornerRadius:.2},v={color:"#2196f3"},b={title:"",visible:!0,lastValueVisible:!0,priceLineVisible:!0,priceLineSource:0,priceLineWidth:1,priceLineColor:"",priceLineStyle:2,baseLineVisible:!0,baseLineWidth:1,baseLineColor:"#B2B5BE",baseLineStyle:0,priceFormat:{type:"price",precision:2,minMove:.01}};var g,w,y;function S(t,i){const s={0:[],1:[t.lineWidth,t.lineWidth],2:[2*t.lineWidth,2*t.lineWidth],3:[6*t.lineWidth,6*t.lineWidth],4:[t.lineWidth,4*t.lineWidth]}[i];t.setLineDash(s)}function _(t,i,s,e){t.beginPath();const h=t.lineWidth%2?.5:0;t.moveTo(s,i+h),t.lineTo(e,i+h),t.stroke()}function M(t,i){if(!t)throw new Error("Assertion failed"+(i?": "+i:""))}function x(t){if(void 0===t)throw new Error("Value is undefined");return t}function C(t){if(null===t)throw new Error("Value is null");return t}function E(t){return C(x(t))}(y=g||(g={}))[y.Simple=0]="Simple",y[y.WithSteps=1]="WithSteps",y[y.Curved=2]="Curved",function(t){t[t.Solid=0]="Solid",t[t.Dotted=1]="Dotted",t[t.Dashed=2]="Dashed",t[t.LargeDashed=3]="LargeDashed",t[t.SparseDotted=4]="SparseDotted"}(w||(w={}));const T={khaki:"#f0e68c",azure:"#f0ffff",aliceblue:"#f0f8ff",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",gray:"#808080",green:"#008000",honeydew:"#f0fff0",floralwhite:"#fffaf0",lightblue:"#add8e6",lightcoral:"#f08080",lemonchiffon:"#fffacd",hotpink:"#ff69b4",lightyellow:"#ffffe0",greenyellow:"#adff2f",lightgoldenrodyellow:"#fafad2",limegreen:"#32cd32",linen:"#faf0e6",lightcyan:"#e0ffff",magenta:"#f0f",maroon:"#800000",olive:"#808000",orange:"#ffa500",oldlace:"#fdf5e6",mediumblue:"#0000cd",transparent:"#0000",lime:"#0f0",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",midnightblue:"#191970",orchid:"#da70d6",mediumorchid:"#ba55d3",mediumturquoise:"#48d1cc",orangered:"#ff4500",royalblue:"#4169e1",powderblue:"#b0e0e6",red:"#f00",coral:"#ff7f50",turquoise:"#40e0d0",white:"#fff",whitesmoke:"#f5f5f5",wheat:"#f5deb3",teal:"#008080",steelblue:"#4682b4",bisque:"#ffe4c4",aquamarine:"#7fffd4",aqua:"#0ff",sienna:"#a0522d",silver:"#c0c0c0",springgreen:"#00ff7f",antiquewhite:"#faebd7",burlywood:"#deb887",brown:"#a52a2a",beige:"#f5f5dc",chocolate:"#d2691e",chartreuse:"#7fff00",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cadetblue:"#5f9ea0",tomato:"#ff6347",fuchsia:"#f0f",blue:"#00f",salmon:"#fa8072",blanchedalmond:"#ffebcd",slateblue:"#6a5acd",slategray:"#708090",thistle:"#d8bfd8",tan:"#d2b48c",cyan:"#0ff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",blueviolet:"#8a2be2",black:"#000",darkmagenta:"#8b008b",darkslateblue:"#483d8b",darkkhaki:"#bdb76b",darkorchid:"#9932cc",darkorange:"#ff8c00",darkgreen:"#006400",darkred:"#8b0000",dodgerblue:"#1e90ff",darkslategray:"#2f4f4f",dimgray:"#696969",deepskyblue:"#00bfff",firebrick:"#b22222",forestgreen:"#228b22",indigo:"#4b0082",ivory:"#fffff0",lavenderblush:"#fff0f5",feldspar:"#d19275",indianred:"#cd5c5c",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightskyblue:"#87cefa",lightslategray:"#789",lightslateblue:"#8470ff",snow:"#fffafa",lightseagreen:"#20b2aa",lightsalmon:"#ffa07a",darksalmon:"#e9967a",darkviolet:"#9400d3",mediumpurple:"#9370d8",mediumaquamarine:"#66cdaa",skyblue:"#87ceeb",lavender:"#e6e6fa",lightsteelblue:"#b0c4de",mediumvioletred:"#c71585",mintcream:"#f5fffa",navajowhite:"#ffdead",navy:"#000080",olivedrab:"#6b8e23",palevioletred:"#d87093",violetred:"#d02090",yellow:"#ff0",yellowgreen:"#9acd32",lawngreen:"#7cfc00",pink:"#ffc0cb",paleturquoise:"#afeeee",palegoldenrod:"#eee8aa",darkolivegreen:"#556b2f",darkseagreen:"#8fbc8f",darkturquoise:"#00ced1",peachpuff:"#ffdab9",deeppink:"#ff1493",violet:"#ee82ee",palegreen:"#98fb98",mediumseagreen:"#3cb371",peru:"#cd853f",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",purple:"#800080",seagreen:"#2e8b57",seashell:"#fff5ee",papayawhip:"#ffefd5",mediumslateblue:"#7b68ee",plum:"#dda0dd",mediumspringgreen:"#00fa9a"};function z(t){return t<0?0:t>255?255:Math.round(t)||0}function k(t){return t<=0||t>0?t<0?0:t>1?1:Math.round(1e4*t)/1e4:0}const W=/^#([0-9a-f])([0-9a-f])([0-9a-f])([0-9a-f])?$/i,R=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i,O=/^rgb\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*\)$/,P=/^rgba\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?[\d]{0,10}(?:\.\d+)?)\s*\)$/;function L(t){(t=t.toLowerCase())in T&&(t=T[t]);{const i=P.exec(t)||O.exec(t);if(i)return[z(parseInt(i[1],10)),z(parseInt(i[2],10)),z(parseInt(i[3],10)),k(i.length<5?1:parseFloat(i[4]))]}{const i=R.exec(t);if(i)return[z(parseInt(i[1],16)),z(parseInt(i[2],16)),z(parseInt(i[3],16)),1]}{const i=W.exec(t);if(i)return[z(17*parseInt(i[1],16)),z(17*parseInt(i[2],16)),z(17*parseInt(i[3],16)),1]}throw new Error(`Cannot parse color: ${t}`)}function N(t){const i=L(t);return{t:`rgb(${i[0]}, ${i[1]}, ${i[2]})`,i:(s=i,.199*s[0]+.687*s[1]+.114*s[2]>160?"black":"white")};var s}class K{constructor(){this.h=[]}l(t,i,s){const e={o:t,_:i,u:!0===s};this.h.push(e)}v(t){const i=this.h.findIndex((i=>t===i.o));i>-1&&this.h.splice(i,1)}p(t){this.h=this.h.filter((i=>i._!==t))}m(t,i,s){const e=[...this.h];this.h=this.h.filter((t=>!t.u)),e.forEach((e=>e.o(t,i,s)))}M(){return this.h.length>0}S(){this.h=[]}}function D(t,...i){for(const s of i)for(const i in s)void 0!==s[i]&&("object"!=typeof s[i]||void 0===t[i]||Array.isArray(s[i])?t[i]=s[i]:D(t[i],s[i]));return t}function V(t){return"number"==typeof t&&isFinite(t)}function B(t){return"number"==typeof t&&t%1==0}function A(t){return"string"==typeof t}function I(t){return"boolean"==typeof t}function j(t){const i=t;if(!i||"object"!=typeof i)return i;let s,e,h;for(e in s=Array.isArray(i)?[]:{},i)i.hasOwnProperty(e)&&(h=i[e],s[e]=h&&"object"==typeof h?j(h):h);return s}function Y(t){return null!==t}function F(t){return null===t?void 0:t}const $="-apple-system, BlinkMacSystemFont, 'Trebuchet MS', Roboto, Ubuntu, sans-serif";function X(t,i,s){return void 0===i&&(i=$),`${s=void 0!==s?`${s} `:""}${t}px ${i}`}class U{constructor(t){this.k={C:1,T:5,P:NaN,R:"",D:"",O:"",A:"",V:0,B:0,I:0,L:0,N:0},this.F=t}W(){const t=this.k,i=this.j(),s=this.H();return t.P===i&&t.D===s||(t.P=i,t.D=s,t.R=X(i,s),t.L=2.5/12*i,t.V=t.L,t.B=i/12*t.T,t.I=i/12*t.T,t.N=0),t.O=this.$(),t.A=this.U(),this.k}$(){return this.F.W().layout.textColor}U(){return this.F.q()}j(){return this.F.W().layout.fontSize}H(){return this.F.W().layout.fontFamily}}class q{constructor(){this.Y=[]}X(t){this.Y=t}K(t,i,s){this.Y.forEach((e=>{e.K(t,i,s)}))}}class Z{K(t,i,s){t.useMediaCoordinateSpace((t=>this.Z(t,i,s)))}G(t,i,s){t.useMediaCoordinateSpace((t=>this.J(t,i,s)))}J(t,i,s){}}class Q extends Z{constructor(){super(...arguments),this.tt=null}it(t){this.tt=t}Z({context:t}){if(null===this.tt||null===this.tt.nt)return;const i=this.tt.nt,s=this.tt,e=e=>{t.beginPath();for(let h=i.to-1;h>=i.from;--h){const i=s.st[h];t.moveTo(i.et,i.rt),t.arc(i.et,i.rt,e,0,2*Math.PI)}t.fill()};s.ht>0&&(t.fillStyle=s.lt,e(s.ot+s.ht)),t.fillStyle=s._t,e(s.ot)}}function H(){return{st:[{et:0,rt:0,ut:0,ct:0}],_t:"",lt:"",ot:0,ht:0,nt:null}}const G={from:0,to:1};class J{constructor(t,i){this.dt=new q,this.ft=[],this.vt=[],this.bt=!0,this.F=t,this.wt=i,this.dt.X(this.ft)}gt(t){const i=this.F.Mt();i.length!==this.ft.length&&(this.vt=i.map(H),this.ft=this.vt.map((t=>{const i=new Q;return i.it(t),i})),this.dt.X(this.ft)),this.bt=!0}xt(){return this.bt&&(this.St(),this.bt=!1),this.dt}St(){const t=2===this.wt.W().mode,i=this.F.Mt(),s=this.wt.kt(),e=this.F.yt();i.forEach(((i,h)=>{var n;const r=this.vt[h],o=i.Ct(s);if(t||null===o||!i.Tt())return void(r.nt=null);const l=C(i.Pt());r._t=o.Rt,r.ot=o.ot,r.ht=o.Dt,r.st[0].ct=o.ct,r.st[0].rt=i.At().Ot(o.ct,l.Vt),r.lt=null!==(n=o.Bt)&&void 0!==n?n:this.F.It(r.st[0].rt/i.At().Lt()),r.st[0].ut=s,r.st[0].et=e.zt(s),r.nt=G}))}}class tt{K(t,i,s){t.useBitmapCoordinateSpace((t=>this.Z(t,i,s)))}}class it extends tt{constructor(t){super(),this.Et=t}Z({context:t,bitmapSize:i,horizontalPixelRatio:s,verticalPixelRatio:e}){if(null===this.Et)return;const h=this.Et.Nt.Tt,n=this.Et.Ft.Tt,r=this.Et.Wt.Tt;if(!h&&!n)return;const o=Math.round(this.Et.et*s),l=Math.round(this.Et.rt*e);t.lineCap="butt",h&&o>=0&&(t.lineWidth=Math.floor(this.Et.Nt.ht*s),t.strokeStyle=this.Et.Nt.O,t.fillStyle=this.Et.Nt.O,S(t,this.Et.Nt.jt),function(t,i,s,e){t.beginPath();const h=t.lineWidth%2?.5:0;t.moveTo(i+h,0),t.lineTo(i+h,e),t.stroke()}(t,o,0,i.height)),n&&l>=0&&(t.lineWidth=Math.floor(this.Et.Ft.ht*e),t.strokeStyle=this.Et.Ft.O,t.fillStyle=this.Et.Ft.O,S(t,this.Et.Ft.jt),_(t,l,0,i.width)),r&&h&&n&&o>=0&&l>=0&&this.Ht(t,o,l,this.Et.Wt)}Ht(t,i,s,e){S(t,0),t.lineWidth=e.ht,t.strokeStyle=e.O,t.beginPath(),t.moveTo(i-e.$t,s),t.lineTo(i+e.$t,s),t.moveTo(i,s-e.$t),t.lineTo(i,s+e.$t),t.stroke()}}class st{constructor(t){this.bt=!0,this.Ut={Nt:{ht:1,jt:0,O:"",Tt:!1},Ft:{ht:1,jt:0,O:"",Tt:!1},et:0,rt:0,Wt:{$t:0,ht:1,O:"",Tt:!1}},this.qt=new it(this.Ut),this.Yt=t}gt(){this.bt=!0}xt(){return this.bt&&(this.St(),this.bt=!1),this.qt}St(){const t=this.Yt.Tt(),i=C(this.Yt.Xt()),s=i.Kt().W().crosshair,e=this.Ut;if(2===s.mode)return e.Ft.Tt=!1,void(e.Nt.Tt=!1);e.Ft.Tt=t&&this.Yt.Zt(i),e.Nt.Tt=t&&this.Yt.Gt(),e.Ft.ht=s.horzLine.width,e.Ft.jt=s.horzLine.style,e.Ft.O=s.horzLine.color,e.Nt.ht=s.vertLine.width,e.Nt.jt=s.vertLine.style,e.Nt.O=s.vertLine.color,e.Wt.Tt=s.centerMarker.visible,e.Wt.O=s.centerMarker.color,e.Wt.ht=s.centerMarker.lineWidth,e.Wt.$t=s.centerMarker.lineLength,e.et=this.Yt.Jt(),e.rt=this.Yt.Qt()}}function et(t,i,s,e,h,n){t.fillRect(i+n,s,e-2*n,n),t.fillRect(i+n,s+h-n,e-2*n,n),t.fillRect(i,s,n,h),t.fillRect(i+e-n,s,n,h)}function ht(t,i,s,e,h,n){t.save(),t.globalCompositeOperation="copy",t.fillStyle=n,t.fillRect(i,s,e,h),t.restore()}function nt(t,i){return t.map((t=>0===t?t:t+i))}function rt(t,i,s,e,h,n){const r=i+2.5;t.beginPath(),t.lineTo(r+e-n[1],s),0!==n[1]&&t.arcTo(r+e,s,r+e,s+n[1],n[1]),t.lineTo(r+e,s+h-n[2]),0!==n[2]&&t.arcTo(r+e,s+h,r+e-n[2],s+h,n[2]),t.lineTo(r+n[3],s+h),0!==n[3]&&t.arcTo(r,s+h,r,s+h-n[3],n[3]),t.lineTo(r,s+n[0]),0!==n[0]&&t.arcTo(r,s,r+n[0],s,n[0])}function ot(t,i,s,e,h,n,r=0,o=[0,0,0,0],l=""){if(t.save(),!r||!l||l===n)return rt(t,i+r/2,s+r/2,e-r,h-r,o),t.fillStyle=n,t.fill(),void t.restore();const a=r/2;"transparent"!==n&&(rt(t,i+r,s+r,e-2*r,h-2*r,nt(o,-a)),t.fillStyle=n,t.fill()),"transparent"!==l&&(rt(t,i+a,s+a,e-r,h-r,nt(o,-a)),t.lineWidth=r,t.strokeStyle=l,t.closePath(),t.stroke()),t.restore()}function lt(t,i,s,e,h,n,r){t.save(),t.globalCompositeOperation="copy";const o=t.createLinearGradient(0,0,0,h);o.addColorStop(0,n),o.addColorStop(1,r),t.fillStyle=o,t.fillRect(i,s,e,h),t.restore()}class at{constructor(t,i){this.it(t,i)}it(t,i){this.Et=t,this.ti=i}Lt(t,i){return this.Et.Tt?t.P+t.L+t.V:0}K(t,i,s,e){if(!this.Et.Tt||0===this.Et.ii.length)return;const h=this.Et.O,n=this.ti.t,r=this.Et.ni,o=t.useBitmapCoordinateSpace((t=>{const o=t.context;o.font=i.R;const l=this.si(t,i,s,e),a=l.ei,u=(t,i,s)=>{l.ri?ot(o,a.hi,a.li,a.ai,a.oi,t,a._i,[i,i,i,i],s):ot(o,a.ui,a.li,a.ai,a.oi,t,a._i,[i,i,i,i],s)};return u(n,r,"transparent"),this.Et.ci&&(o.fillStyle=h,o.fillRect(a.ui,a.di,a.fi-a.ui,a.vi)),u("transparent",r,n),this.Et.pi&&(o.fillStyle=i.A,o.fillRect(l.ri?a.mi-a._i:0,a.li,a._i,a.bi-a.li)),l}));t.useMediaCoordinateSpace((({context:t})=>{const s=o.wi;t.font=i.R,t.textAlign=o.ri?"right":"left",t.textBaseline="middle",t.fillStyle=h,t.fillText(this.Et.ii,s.gi,(s.li+s.bi)/2+s.Mi)}))}si(t,i,s,e){var h;const{context:n,bitmapSize:r,mediaSize:o,horizontalPixelRatio:l,verticalPixelRatio:a}=t,u=this.Et.ci||!this.Et.xi?i.T:0,c=this.Et.Si?i.C:0,d=i.L+this.ti.ki,f=i.V+this.ti.yi,p=i.B,m=i.I,v=this.Et.ii,b=i.P,g=s.Ci(n,v),w=Math.ceil(s.Ti(n,v)),y=b+d+f,S=i.C+p+m+w+u,_=Math.max(1,Math.floor(a));let M=Math.round(y*a);M%2!=_%2&&(M+=1);const x=c>0?Math.max(1,Math.floor(c*l)):0,C=Math.round(S*l),E=Math.round(u*l),T=null!==(h=this.ti.Pi)&&void 0!==h?h:this.ti.Ri,z=Math.round(T*a)-Math.floor(.5*a),k=Math.floor(z+_/2-M/2),W=k+M,R="right"===e,O=R?o.width-c:c,P=R?r.width-x:x;let L,N,K;return R?(L=P-C,N=P-E,K=O-u-p-c):(L=P+C,N=P+E,K=O+u+p),{ri:R,ei:{li:k,di:z,bi:W,ai:C,oi:M,ot:2*l,_i:x,hi:L,ui:P,fi:N,vi:_,mi:r.width},wi:{li:k/a,bi:W/a,gi:K,Mi:g}}}}class ut{constructor(t){this.Di={Ri:0,t:"#000",yi:3,ki:3},this.Oi={ii:"",Tt:!1,ci:!0,xi:!1,Bt:"",O:"#FFF",pi:!1,Si:!1,ni:11},this.Ai={ii:"",Tt:!1,ci:!1,xi:!0,Bt:"",O:"#FFF",pi:!0,Si:!0,ni:11},this.bt=!0,this.Vi=new(t||at)(this.Oi,this.Di),this.Bi=new(t||at)(this.Ai,this.Di)}ii(){return this.Ii(),this.Oi.ii}Ri(){return this.Ii(),this.Di.Ri}gt(){this.bt=!0}Lt(t,i=!1){return Math.max(this.Vi.Lt(t,i),this.Bi.Lt(t,i))}Li(){return this.Di.Pi||0}zi(t){this.Di.Pi=t}Ei(){return this.Ii(),this.Oi.Tt||this.Ai.Tt}Ni(){return this.Ii(),this.Oi.Tt}xt(t){return this.Ii(),this.Oi.ci=this.Oi.ci&&t.W().ticksVisible,this.Ai.ci=this.Ai.ci&&t.W().ticksVisible,this.Vi.it(this.Oi,this.Di),this.Bi.it(this.Ai,this.Di),this.Vi}Fi(){return this.Ii(),this.Vi.it(this.Oi,this.Di),this.Bi.it(this.Ai,this.Di),this.Bi}Ii(){this.bt&&(this.Oi.ci=!0,this.Ai.ci=!1,this.Wi(this.Oi,this.Ai,this.Di))}}class ct extends ut{constructor(t,i,s){super(),this.Yt=t,this.ji=i,this.Hi=s}Wi(t,i,s){if(t.Tt=!1,2===this.Yt.W().mode)return;const e=this.Yt.W().horzLine;if(!e.labelVisible)return;const h=this.ji.Pt();if(!this.Yt.Tt()||this.ji.$i()||null===h)return;const n=N(e.labelBackgroundColor);s.t=n.t,t.O=n.i;const r=.25*this.ji.P();s.ki=r,s.yi=r;const o=this.Hi(this.ji);s.Ri=o.Ri,t.ii=this.ji.Ui(o.ct,h),t.Tt=!0,t.ni=e.labelCornerRadius}}const dt=/[1-9]/g;class ft{constructor(){this.Et=null}it(t){this.Et=t}K(t,i){if(null===this.Et||!1===this.Et.Tt||0===this.Et.ii.length)return;const s=t.useMediaCoordinateSpace((({context:t})=>(t.font=i.R,Math.round(i.qi.Ti(t,C(this.Et).ii,dt)))));if(s<=0)return;const e=i.Yi,h=s+2*e,n=h/2,r=this.Et.Xi;let o=this.Et.Ri,l=Math.floor(o-n)+.5;l<0?(o+=Math.abs(0-l),l=Math.floor(o-n)+.5):l+h>r&&(o-=Math.abs(r-(l+h)),l=Math.floor(o-n)+.5);const a=l+h,u=Math.ceil(0+i.C+i.T+i.L+i.P+i.V);t.useBitmapCoordinateSpace((({context:t,horizontalPixelRatio:s,verticalPixelRatio:e})=>{const h=C(this.Et);t.fillStyle=h.t;const n=Math.round(l*s),r=Math.round(0*e),o=Math.round(a*s),c=Math.round(u*e),d=Math.round(h.ni);if(t.beginPath(),t.moveTo(n+d,r),t.lineTo(o-d,r),t.arcTo(o,r,o,r+d,d),t.lineTo(o,c-d),t.arcTo(o,c,o-d,c,d),t.lineTo(n+d,c),t.arcTo(n,c,n,c-d,d),t.lineTo(n,r+d),t.arcTo(n,r,n+d,r,d),t.fill(),h.ci){const n=Math.round(h.Ri*s),o=r,l=Math.round((o+i.T)*e);t.fillStyle=h.O;const a=Math.max(1,Math.floor(s)),u=Math.floor(.5*s);t.fillRect(n-u,o,a,l-o)}})),t.useMediaCoordinateSpace((({context:t})=>{const s=C(this.Et),h=0+i.C+i.T+i.L+i.P/2;t.font=i.R,t.textAlign="left",t.textBaseline="middle",t.textBaseline="alphabetic",t.fillStyle=s.O;const n=i.qi.Ci(t,"Apr0");t.translate(l+e,h+n),t.fillText(s.ii,0,0)}))}}class pt{constructor(t,i,s){this.bt=!0,this.qt=new ft,this.Ut={Tt:!1,t:"#4c525e",O:"white",ii:"",Xi:0,Ri:NaN,ci:!0,ni:10},this.wt=t,this.Ki=i,this.Hi=s}gt(){this.bt=!0}xt(){return this.bt&&(this.St(),this.bt=!1),this.qt.it(this.Ut),this.qt}St(){const t=this.Ut;if(t.Tt=!1,2===this.wt.W().mode)return;const i=this.wt.W().vertLine;if(!i.labelVisible)return;const s=this.Ki.yt();if(s.$i())return;t.Xi=s.Xi();const e=this.Hi();if(null===e)return;t.Ri=e.Ri;const h=s.Zi(this.wt.kt());t.ii=s.Gi(C(h)),t.Tt=!0;const n=N(i.labelBackgroundColor);t.t=n.t,t.O=n.i,t.ci=s.W().ticksVisible,t.ni=i.labelCornerRadius}}class mt{constructor(){this.Ji=null,this.Qi=0}tn(){return this.Qi}nn(t){this.Qi=t}At(){return this.Ji}sn(t){this.Ji=t}en(t){return[]}rn(){return[]}Tt(){return!0}}var vt;!function(t){t[t.Normal=0]="Normal",t[t.Magnet=1]="Magnet",t[t.Hidden=2]="Hidden"}(vt||(vt={}));class bt extends mt{constructor(t,i){super(),this.hn=null,this.ln=NaN,this.an=0,this.on=!0,this._n=new Map,this.un=!1,this.cn=NaN,this.dn=NaN,this.fn=NaN,this.vn=NaN,this.Ki=t,this.pn=i,this.mn=new J(t,this),this.bn=((t,i)=>s=>{const e=i(),h=t();if(s===C(this.hn).wn())return{ct:h,Ri:e};{const t=C(s.Pt());return{ct:s.gn(e,t),Ri:e}}})((()=>this.ln),(()=>this.dn));const s=((t,i)=>()=>{const s=this.Ki.yt().Mn(t()),e=i();return s&&Number.isFinite(e)?{ut:s,Ri:e}:null})((()=>this.an),(()=>this.Jt()));this.xn=new pt(this,t,s),this.Sn=new st(this)}W(){return this.pn}kn(t,i){this.fn=t,this.vn=i}yn(){this.fn=NaN,this.vn=NaN}Cn(){return this.fn}Tn(){return this.vn}Pn(t,i,s){this.un||(this.un=!0),this.on=!0,this.Rn(t,i,s)}kt(){return this.an}Jt(){return this.cn}Qt(){return this.dn}Tt(){return this.on}Dn(){this.on=!1,this.On(),this.ln=NaN,this.cn=NaN,this.dn=NaN,this.hn=null,this.yn()}An(t){return null!==this.hn?[this.Sn,this.mn]:[]}Zt(t){return t===this.hn&&this.pn.horzLine.visible}Gt(){return this.pn.vertLine.visible}Vn(t,i){this.on&&this.hn===t||this._n.clear();const s=[];return this.hn===t&&s.push(this.Bn(this._n,i,this.bn)),s}rn(){return this.on?[this.xn]:[]}Xt(){return this.hn}In(){this.Sn.gt(),this._n.forEach((t=>t.gt())),this.xn.gt(),this.mn.gt()}Ln(t){return t&&!t.wn().$i()?t.wn():null}Rn(t,i,s){this.zn(t,i,s)&&this.In()}zn(t,i,s){const e=this.cn,h=this.dn,n=this.ln,r=this.an,o=this.hn,l=this.Ln(s);this.an=t,this.cn=isNaN(t)?NaN:this.Ki.yt().zt(t),this.hn=s;const a=null!==l?l.Pt():null;return null!==l&&null!==a?(this.ln=i,this.dn=l.Ot(i,a)):(this.ln=NaN,this.dn=NaN),e!==this.cn||h!==this.dn||r!==this.an||n!==this.ln||o!==this.hn}On(){const t=this.Ki.Mt().map((t=>t.Nn().En())).filter(Y),i=0===t.length?null:Math.max(...t);this.an=null!==i?i:NaN}Bn(t,i,s){let e=t.get(i);return void 0===e&&(e=new ct(this,i,s),t.set(i,e)),e}}function gt(t){return"left"===t||"right"===t}class wt{constructor(t){this.Fn=new Map,this.Wn=[],this.jn=t}Hn(t,i){const s=function(t,i){return void 0===t?i:{$n:Math.max(t.$n,i.$n),Un:t.Un||i.Un}}(this.Fn.get(t),i);this.Fn.set(t,s)}qn(){return this.jn}Yn(t){const i=this.Fn.get(t);return void 0===i?{$n:this.jn}:{$n:Math.max(this.jn,i.$n),Un:i.Un}}Xn(){this.Kn(),this.Wn=[{Zn:0}]}Gn(t){this.Kn(),this.Wn=[{Zn:1,Vt:t}]}Jn(t){this.Qn(),this.Wn.push({Zn:5,Vt:t})}Kn(){this.Qn(),this.Wn.push({Zn:6})}ts(){this.Kn(),this.Wn=[{Zn:4}]}ns(t){this.Kn(),this.Wn.push({Zn:2,Vt:t})}ss(t){this.Kn(),this.Wn.push({Zn:3,Vt:t})}es(){return this.Wn}rs(t){for(const i of t.Wn)this.hs(i);this.jn=Math.max(this.jn,t.jn),t.Fn.forEach(((t,i)=>{this.Hn(i,t)}))}static ls(){return new wt(2)}static os(){return new wt(3)}hs(t){switch(t.Zn){case 0:this.Xn();break;case 1:this.Gn(t.Vt);break;case 2:this.ns(t.Vt);break;case 3:this.ss(t.Vt);break;case 4:this.ts();break;case 5:this.Jn(t.Vt);break;case 6:this.Qn()}}Qn(){const t=this.Wn.findIndex((t=>5===t.Zn));-1!==t&&this.Wn.splice(t,1)}}function yt(t,i){if(!V(t))return"n/a";if(!B(i))throw new TypeError("invalid length");if(i<0||i>16)throw new TypeError("invalid length");return 0===i?t.toString():("0000000000000000"+t.toString()).slice(-i)}class St{constructor(t,i){if(i||(i=1),V(t)&&B(t)||(t=100),t<0)throw new TypeError("invalid base");this.ji=t,this._s=i,this.us()}format(t){const i=t<0?"\u2212":"";return t=Math.abs(t),i+this.cs(t)}us(){if(this.ds=0,this.ji>0&&this._s>0){let t=this.ji;for(;t>1;)t/=10,this.ds++}}cs(t){const i=this.ji/this._s;let s=Math.floor(t),e="";const h=void 0!==this.ds?this.ds:NaN;if(i>1){let n=+(Math.round(t*i)-s*i).toFixed(this.ds);n>=i&&(n-=i,s+=1),e="."+yt(+n.toFixed(this.ds)*this._s,h)}else s=Math.round(s*i)/i,h>0&&(e="."+yt(0,h));return s.toFixed(0)+e}}class _t extends St{constructor(t=100){super(t)}format(t){return`${super.format(t)}%`}}class Mt{constructor(t){this.fs=t}format(t){let i="";return t<0&&(i="-",t=-t),t<995?i+this.vs(t):t<999995?i+this.vs(t/1e3)+"K":t<999999995?(t=1e3*Math.round(t/1e3),i+this.vs(t/1e6)+"M"):(t=1e6*Math.round(t/1e6),i+this.vs(t/1e9)+"B")}vs(t){let i;const s=Math.pow(10,this.fs);return i=(t=Math.round(t*s)/s)>=1e-15&&t<1?t.toFixed(this.fs).replace(/\.?0+$/,""):String(t),i.replace(/(\.[1-9]*)0+$/,((t,i)=>i))}}function xt(t,i,s,e,h,n,r){if(0===i.length||e.from>=i.length||e.to<=0)return;const{context:o,horizontalPixelRatio:l,verticalPixelRatio:a}=t,u=i[e.from];let c=n(t,u),d=u;if(e.to-e.from<2){const i=h/2;o.beginPath();const s={et:u.et-i,rt:u.rt},e={et:u.et+i,rt:u.rt};o.moveTo(s.et*l,s.rt*a),o.lineTo(e.et*l,e.rt*a),r(t,c,s,e)}else{const h=(i,s)=>{r(t,c,d,s),o.beginPath(),c=i,d=s};let f=d;o.beginPath(),o.moveTo(u.et*l,u.rt*a);for(let r=e.from+1;r<e.to;++r){f=i[r];const e=n(t,f);switch(s){case 0:o.lineTo(f.et*l,f.rt*a);break;case 1:o.lineTo(f.et*l,i[r-1].rt*a),e!==c&&(h(e,f),o.lineTo(f.et*l,i[r-1].rt*a)),o.lineTo(f.et*l,f.rt*a);break;case 2:{const[t,s]=zt(i,r-1,r);o.bezierCurveTo(t.et*l,t.rt*a,s.et*l,s.rt*a,f.et*l,f.rt*a);break}}1!==s&&e!==c&&(h(e,f),o.moveTo(f.et*l,f.rt*a))}(d!==f||d===f&&1===s)&&r(t,c,d,f)}}const Ct=6;function Et(t,i){return{et:t.et-i.et,rt:t.rt-i.rt}}function Tt(t,i){return{et:t.et/i,rt:t.rt/i}}function zt(t,i,s){const e=Math.max(0,i-1),h=Math.min(t.length-1,s+1);var n,r;return[(n=t[i],r=Tt(Et(t[s],t[e]),Ct),{et:n.et+r.et,rt:n.rt+r.rt}),Et(t[s],Tt(Et(t[h],t[i]),Ct))]}function kt(t,i,s,e,h){const{context:n,horizontalPixelRatio:r,verticalPixelRatio:o}=i;n.lineTo(h.et*r,t*o),n.lineTo(e.et*r,t*o),n.closePath(),n.fillStyle=s,n.fill()}class Wt extends tt{constructor(){super(...arguments),this.tt=null}it(t){this.tt=t}Z(t){var i;if(null===this.tt)return;const{st:s,nt:e,ps:h,ht:n,jt:r,bs:o}=this.tt,l=null!==(i=this.tt.ws)&&void 0!==i?i:this.tt.gs?0:t.mediaSize.height;if(null===e)return;const a=t.context;a.lineCap="butt",a.lineJoin="round",a.lineWidth=n,S(a,r),a.lineWidth=1,xt(t,s,o,e,h,this.Ms.bind(this),kt.bind(null,l))}}function Rt(t,i,s){return Math.min(Math.max(t,i),s)}function Ot(t,i,s){return i-t<=s}function Pt(t){const i=Math.ceil(t);return i%2==0?i-1:i}class Lt{xs(t,i){const s=this.Ss,{ks:e,ys:h,Cs:n,Ts:r,Ps:o,ws:l}=i;if(void 0===this.Rs||void 0===s||s.ks!==e||s.ys!==h||s.Cs!==n||s.Ts!==r||s.ws!==l||s.Ps!==o){const s=t.context.createLinearGradient(0,0,0,o);if(s.addColorStop(0,e),null!=l){const i=Rt(l*t.verticalPixelRatio/o,0,1);s.addColorStop(i,h),s.addColorStop(i,n)}s.addColorStop(1,r),this.Rs=s,this.Ss=i}return this.Rs}}class Nt extends Wt{constructor(){super(...arguments),this.Ds=new Lt}Ms(t,i){return this.Ds.xs(t,{ks:i.Os,ys:"",Cs:"",Ts:i.As,Ps:t.bitmapSize.height})}}function Kt(t,i){const s=t.context;s.strokeStyle=i,s.stroke()}class Dt extends tt{constructor(){super(...arguments),this.tt=null}it(t){this.tt=t}Z(t){if(null===this.tt)return;const{st:i,nt:s,ps:e,bs:h,ht:n,jt:r,Vs:o}=this.tt;if(null===s)return;const l=t.context;l.lineCap="butt",l.lineWidth=n*t.verticalPixelRatio,S(l,r),l.lineJoin="round";const a=this.Bs.bind(this);void 0!==h&&xt(t,i,h,s,e,a,Kt),o&&function(t,i,s,e,h){const{horizontalPixelRatio:n,verticalPixelRatio:r,context:o}=t;let l=null;const a=Math.max(1,Math.floor(n))%2/2,u=s*r+a;for(let c=e.to-1;c>=e.from;--c){const s=i[c];if(s){const i=h(t,s);i!==l&&(o.beginPath(),null!==l&&o.fill(),o.fillStyle=i,l=i);const e=Math.round(s.et*n)+a,c=s.rt*r;o.moveTo(e,c),o.arc(e,c,u,0,2*Math.PI)}}o.fill()}(t,i,o,s,a)}}class Vt extends Dt{Bs(t,i){return i._t}}function Bt(t,i,s,e,h=0,n=i.length){let r=n-h;for(;0<r;){const n=r>>1,o=h+n;e(i[o],s)===t?(h=o+1,r-=n+1):r=n}return h}const At=Bt.bind(null,!0),It=Bt.bind(null,!1);function jt(t,i){return t.ut<i}function Yt(t,i){return i<t.ut}function Ft(t,i,s){const e=i.Is(),h=i.mi(),n=At(t,e,jt),r=It(t,h,Yt);if(!s)return{from:n,to:r};let o=n,l=r;return n>0&&n<t.length&&t[n].ut>=e&&(o=n-1),r>0&&r<t.length&&t[r-1].ut<=h&&(l=r+1),{from:o,to:l}}class $t{constructor(t,i,s){this.Ls=!0,this.zs=!0,this.Es=!0,this.Ns=[],this.Fs=null,this.Ws=t,this.js=i,this.Hs=s}gt(t){this.Ls=!0,"data"===t&&(this.zs=!0),"options"===t&&(this.Es=!0)}xt(){return this.Ws.Tt()?(this.$s(),null===this.Fs?null:this.Us):null}qs(){this.Ns=this.Ns.map((t=>Object.assign(Object.assign({},t),this.Ws.Xs().Ys(t.ut))))}Ks(){this.Fs=null}$s(){this.zs&&(this.Zs(),this.zs=!1),this.Es&&(this.qs(),this.Es=!1),this.Ls&&(this.Gs(),this.Ls=!1)}Gs(){const t=this.Ws.At(),i=this.js.yt();if(this.Ks(),i.$i()||t.$i())return;const s=i.Js();if(null===s)return;if(0===this.Ws.Nn().Qs())return;const e=this.Ws.Pt();null!==e&&(this.Fs=Ft(this.Ns,s,this.Hs),this.te(t,i,e.Vt),this.ie())}}class Xt extends $t{constructor(t,i){super(t,i,!0)}te(t,i,s){i.ne(this.Ns,F(this.Fs)),t.se(this.Ns,s,F(this.Fs))}ee(t,i){return{ut:t,ct:i,et:NaN,rt:NaN}}Zs(){const t=this.Ws.Xs();this.Ns=this.Ws.Nn().re().map((i=>{const s=i.Vt[3];return this.he(i.le,s,t)}))}}class Ut extends Xt{constructor(t,i){super(t,i),this.Us=new q,this.ae=new Nt,this.oe=new Vt,this.Us.X([this.ae,this.oe])}he(t,i,s){return Object.assign(Object.assign({},this.ee(t,i)),s.Ys(t))}ie(){const t=this.Ws.W();this.ae.it({bs:t.lineType,st:this.Ns,jt:t.lineStyle,ht:t.lineWidth,ws:null,gs:t.invertFilledArea,nt:this.Fs,ps:this.js.yt()._e()}),this.oe.it({bs:t.lineVisible?t.lineType:void 0,st:this.Ns,jt:t.lineStyle,ht:t.lineWidth,nt:this.Fs,ps:this.js.yt()._e(),Vs:t.pointMarkersVisible?t.pointMarkersRadius||t.lineWidth/2+2:void 0})}}class qt extends tt{constructor(){super(...arguments),this.Et=null,this.ue=0,this.ce=0}it(t){this.Et=t}Z({context:t,horizontalPixelRatio:i,verticalPixelRatio:s}){if(null===this.Et||0===this.Et.Nn.length||null===this.Et.nt)return;this.ue=this.de(i),this.ue>=2&&Math.max(1,Math.floor(i))%2!=this.ue%2&&this.ue--,this.ce=this.Et.fe?Math.min(this.ue,Math.floor(i)):this.ue;let e=null;const h=this.ce<=this.ue&&this.Et._e>=Math.floor(1.5*i);for(let n=this.Et.nt.from;n<this.Et.nt.to;++n){const r=this.Et.Nn[n];e!==r.ve&&(t.fillStyle=r.ve,e=r.ve);const o=Math.floor(.5*this.ce),l=Math.round(r.et*i),a=l-o,u=this.ce,c=a+u-1,d=Math.min(r.pe,r.me),f=Math.max(r.pe,r.me),p=Math.round(d*s)-o,m=Math.round(f*s)+o,v=Math.max(m-p,this.ce);t.fillRect(a,p,u,v);const b=Math.ceil(1.5*this.ue);if(h){if(this.Et.be){const i=l-b;let e=Math.max(p,Math.round(r.we*s)-o),h=e+u-1;h>p+v-1&&(h=p+v-1,e=h-u+1),t.fillRect(i,e,a-i,h-e+1)}const i=l+b;let e=Math.max(p,Math.round(r.ge*s)-o),h=e+u-1;h>p+v-1&&(h=p+v-1,e=h-u+1),t.fillRect(c+1,e,i-c,h-e+1)}}}de(t){const i=Math.floor(t);return Math.max(i,Math.floor(function(t,i){return Math.floor(.3*t*i)}(C(this.Et)._e,t)))}}class Zt extends $t{constructor(t,i){super(t,i,!1)}te(t,i,s){i.ne(this.Ns,F(this.Fs)),t.Me(this.Ns,s,F(this.Fs))}xe(t,i,s){return{ut:t,Se:i.Vt[0],ke:i.Vt[1],ye:i.Vt[2],Ce:i.Vt[3],et:NaN,we:NaN,pe:NaN,me:NaN,ge:NaN}}Zs(){const t=this.Ws.Xs();this.Ns=this.Ws.Nn().re().map((i=>this.he(i.le,i,t)))}}class Qt extends Zt{constructor(){super(...arguments),this.Us=new qt}he(t,i,s){return Object.assign(Object.assign({},this.xe(t,i,s)),s.Ys(t))}ie(){const t=this.Ws.W();this.Us.it({Nn:this.Ns,_e:this.js.yt()._e(),be:t.openVisible,fe:t.thinBars,nt:this.Fs})}}class Ht extends Wt{constructor(){super(...arguments),this.Ds=new Lt}Ms(t,i){const s=this.tt;return this.Ds.xs(t,{ks:i.Te,ys:i.Pe,Cs:i.Re,Ts:i.De,Ps:t.bitmapSize.height,ws:s.ws})}}class Gt extends Dt{constructor(){super(...arguments),this.Oe=new Lt}Bs(t,i){const s=this.tt;return this.Oe.xs(t,{ks:i.Ae,ys:i.Ae,Cs:i.Ve,Ts:i.Ve,Ps:t.bitmapSize.height,ws:s.ws})}}class Jt extends Xt{constructor(t,i){super(t,i),this.Us=new q,this.Be=new Ht,this.Ie=new Gt,this.Us.X([this.Be,this.Ie])}he(t,i,s){return Object.assign(Object.assign({},this.ee(t,i)),s.Ys(t))}ie(){const t=this.Ws.Pt();if(null===t)return;const i=this.Ws.W(),s=this.Ws.At().Ot(i.baseValue.price,t.Vt),e=this.js.yt()._e();this.Be.it({st:this.Ns,ht:i.lineWidth,jt:i.lineStyle,bs:i.lineType,ws:s,gs:!1,nt:this.Fs,ps:e}),this.Ie.it({st:this.Ns,ht:i.lineWidth,jt:i.lineStyle,bs:i.lineVisible?i.lineType:void 0,Vs:i.pointMarkersVisible?i.pointMarkersRadius||i.lineWidth/2+2:void 0,ws:s,nt:this.Fs,ps:e})}}class ti extends tt{constructor(){super(...arguments),this.Et=null,this.ue=0}it(t){this.Et=t}Z(t){if(null===this.Et||0===this.Et.Nn.length||null===this.Et.nt)return;const{horizontalPixelRatio:i}=t;this.ue=function(t,i){if(t>=2.5&&t<=4)return Math.floor(3*i);const s=1-.2*Math.atan(Math.max(4,t)-4)/(.5*Math.PI),e=Math.floor(t*s*i),h=Math.floor(t*i),n=Math.min(e,h);return Math.max(Math.floor(i),n)}(this.Et._e,i),this.ue>=2&&Math.floor(i)%2!=this.ue%2&&this.ue--;const s=this.Et.Nn;this.Et.Le&&this.ze(t,s,this.Et.nt),this.Et.pi&&this.Ee(t,s,this.Et.nt);const e=this.Ne(i);(!this.Et.pi||this.ue>2*e)&&this.Fe(t,s,this.Et.nt)}ze(t,i,s){if(null===this.Et)return;const{context:e,horizontalPixelRatio:h,verticalPixelRatio:n}=t;let r,o="";r=Math.min(Math.floor(h),Math.floor(this.Et._e*h)),r=Math.max(Math.floor(h),Math.min(r,this.ue));for(let l=s.from;l<s.to;l++){const t=i[l];t.We!==o&&(e.strokeStyle=t.We,e.lineWidth=r,e.lineCap=this.Et.je?"round":"butt",o=t.We);const s=Math.round(Math.min(t.we,t.ge)*n),a=Math.round(Math.max(t.we,t.ge)*n),u=Math.round(t.pe*n),c=Math.round(t.me*n),d=Math.round(h*t.et);e.beginPath(),e.moveTo(d,u),e.lineTo(d,s),e.stroke(),e.beginPath(),e.moveTo(d,a),e.lineTo(d,c),e.stroke()}}Ne(t){let i=Math.floor(1*t);this.ue<=2*i&&(i=Math.floor(.5*(this.ue-1)));const s=Math.max(Math.floor(t),i);return this.ue<=2*s?Math.max(Math.floor(t),Math.floor(1*t)):s}Ee(t,i,s){if(null===this.Et)return;const{context:e,horizontalPixelRatio:h,verticalPixelRatio:n}=t;let r="";const o=this.Ne(h);let l=null;for(let a=s.from;a<s.to;a++){const t=i[a];t.He!==r&&(e.fillStyle=t.He,r=t.He);let s=Math.round(t.et*h)-Math.floor(.5*this.ue);const u=s+this.ue-1,c=Math.round(Math.min(t.we,t.ge)*n),d=Math.round(Math.max(t.we,t.ge)*n);if(null!==l&&(s=Math.max(l+1,s),s=Math.min(s,u)),this.Et._e*h>2*o)et(e,s,c,u-s+1,d-c+1,o);else{const t=u-s+1;e.fillRect(s,c,t,d-c+1)}l=u}}Fe(t,i,s){if(null===this.Et)return;const{context:e,horizontalPixelRatio:h,verticalPixelRatio:n}=t;let r="";const o=this.Ne(h),l=this.Et.$e;for(let a=s.from;a<s.to;a++){const t=i[a];let s=Math.round(Math.min(t.we,t.ge)*n),u=Math.round(Math.max(t.we,t.ge)*n),c=Math.round(t.et*h)-Math.floor(.5*this.ue),d=c+this.ue-1;if(t.ve!==r){const i=t.ve;e.fillStyle=i,r=i}this.Et.pi&&(c+=o,s+=o,d-=o,u-=o),s>u||this.Ue(e,c,s,d-c+1,u-s+1,l)}}Ue(t,i,s,e,h,n){t.beginPath(),t.moveTo(i+n,s),t.lineTo(i+e-n,s),t.quadraticCurveTo(i+e,s,i+e,s+n),t.lineTo(i+e,s+h-n),t.quadraticCurveTo(i+e,s+h,i+e-n,s+h),t.lineTo(i+n,s+h),t.quadraticCurveTo(i,s+h,i,s+h-n),t.lineTo(i,s+n),t.quadraticCurveTo(i,s,i+n,s),t.closePath(),t.fill()}}class ii extends Zt{constructor(){super(...arguments),this.Us=new ti}he(t,i,s){return Object.assign(Object.assign({},this.xe(t,i,s)),s.Ys(t))}ie(){const t=this.Ws.W();this.Us.it({Nn:this.Ns,_e:this.js.yt()._e(),Le:t.wickVisible,pi:t.borderVisible,nt:this.Fs,$e:t.cornerRadius,je:t.roundedWickTip})}}class si{constructor(t,i){this.qe=t,this.ji=i}K(t,i,s){this.qe.draw(t,this.ji,i,s)}}class ei extends $t{constructor(t,i,s){super(t,i,!1),this.Sn=s,this.Us=new si(this.Sn.renderer(),(i=>{const s=t.Pt();return null===s?null:t.At().Ot(i,s.Vt)}))}Ye(t){return this.Sn.priceValueBuilder(t)}Xe(t){return this.Sn.isWhitespace(t)}Zs(){const t=this.Ws.Xs();this.Ns=this.Ws.Nn().re().map((i=>Object.assign(Object.assign({ut:i.le,et:NaN},t.Ys(i.le)),{Ke:i.Ze})))}te(t,i){i.ne(this.Ns,F(this.Fs))}ie(){this.Sn.update({bars:this.Ns.map(hi),barSpacing:this.js.yt()._e(),visibleRange:this.Fs},this.Ws.W())}}function hi(t){return{x:t.et,time:t.ut,originalData:t.Ke,barColor:t.ve}}class ni extends tt{constructor(){super(...arguments),this.Et=null,this.Ge=[]}it(t){this.Et=t,this.Ge=[]}Z({context:t,horizontalPixelRatio:i,verticalPixelRatio:s}){if(null===this.Et||0===this.Et.st.length||null===this.Et.nt)return;this.Ge.length||this.Je(i);const e=Math.max(1,Math.floor(s)),h=Math.round(this.Et.Qe*s)-Math.floor(e/2),n=h+e;for(let r=this.Et.nt.from;r<this.Et.nt.to;r++){const i=this.Et.st[r],o=this.Ge[r-this.Et.nt.from],l=Math.round(i.rt*s);let a,u;t.fillStyle=i.ve,l<=h?(a=l,u=n):(a=h,u=l-Math.floor(e/2)+e),this.Ue(t,o.Is,a,o.mi-o.Is+1,u-a,this.Et.$e)}}Ue(t,i,s,e,h,n){const r=Math.min(e,h)*n;t.beginPath(),t.moveTo(i+r,s),t.lineTo(i+e-r,s),t.quadraticCurveTo(i+e,s,i+e,s+r),t.lineTo(i+e,s+h),t.lineTo(i,s+h),t.lineTo(i,s+r),t.quadraticCurveTo(i,s,i+r,s),t.closePath(),t.fill()}Je(t){if(null===this.Et||0===this.Et.st.length||null===this.Et.nt)return void(this.Ge=[]);const i=Math.ceil(this.Et._e*t)<=1?0:Math.max(1,Math.floor(t)),s=Math.round(this.Et._e*t)-i;this.Ge=new Array(this.Et.nt.to-this.Et.nt.from);for(let h=this.Et.nt.from;h<this.Et.nt.to;h++){const i=this.Et.st[h],e=Math.round(i.et*t);let n,r;if(s%2){const t=(s-1)/2;n=e-t,r=e+t}else{const t=s/2;n=e-t,r=e+t-1}this.Ge[h-this.Et.nt.from]={Is:n,mi:r,tr:e,ir:i.et*t,ut:i.ut}}for(let h=this.Et.nt.from+1;h<this.Et.nt.to;h++){const t=this.Ge[h-this.Et.nt.from],s=this.Ge[h-this.Et.nt.from-1];t.ut===s.ut+1&&t.Is-s.mi!==i+1&&(s.tr>s.ir?s.mi=t.Is-i-1:t.Is=s.mi+i+1)}let e=Math.ceil(this.Et._e*t);for(let h=this.Et.nt.from;h<this.Et.nt.to;h++){const t=this.Ge[h-this.Et.nt.from];t.mi<t.Is&&(t.mi=t.Is);const i=t.mi-t.Is+1;e=Math.min(i,e)}if(i>0&&e<4)for(let h=this.Et.nt.from;h<this.Et.nt.to;h++){const t=this.Ge[h-this.Et.nt.from];t.mi-t.Is+1>e&&(t.tr>t.ir?t.mi-=1:t.Is+=1)}}}class ri extends Xt{constructor(){super(...arguments),this.Us=new ni}he(t,i,s){return Object.assign(Object.assign({},this.ee(t,i)),s.Ys(t))}ie(){const t={st:this.Ns,_e:this.js.yt()._e(),nt:this.Fs,Qe:this.Ws.At().Ot(this.Ws.W().base,C(this.Ws.Pt()).Vt),$e:this.Ws.W().cornerRadius};this.Us.it(t)}}class oi extends Xt{constructor(){super(...arguments),this.Us=new Vt}he(t,i,s){return Object.assign(Object.assign({},this.ee(t,i)),s.Ys(t))}ie(){const t=this.Ws.W(),i={st:this.Ns,jt:t.lineStyle,bs:t.lineVisible?t.lineType:void 0,ht:t.lineWidth,Vs:t.pointMarkersVisible?t.pointMarkersRadius||t.lineWidth/2+2:void 0,nt:this.Fs,ps:this.js.yt()._e()};this.Us.it(i)}}const li=/[2-9]/g;class ai{constructor(t=50){this.nr=0,this.sr=1,this.er=1,this.rr={},this.hr=new Map,this.lr=t}ar(){this.nr=0,this.hr.clear(),this.sr=1,this.er=1,this.rr={}}Ti(t,i,s){return this._r(t,i,s).width}Ci(t,i,s){const e=this._r(t,i,s);return((e.actualBoundingBoxAscent||0)-(e.actualBoundingBoxDescent||0))/2}_r(t,i,s){const e=s||li,h=String(i).replace(e,"0");if(this.hr.has(h))return x(this.hr.get(h)).ur;if(this.nr===this.lr){const t=this.rr[this.er];delete this.rr[this.er],this.hr.delete(t),this.er++,this.nr--}t.save(),t.textBaseline="middle";const n=t.measureText(h);return t.restore(),0===n.width&&i.length||(this.hr.set(h,{ur:n,cr:this.sr}),this.rr[this.sr]=h,this.nr++,this.sr++),n}}class ui{constructor(t){this.dr=null,this.k=null,this.vr="right",this.pr=t}mr(t,i,s){this.dr=t,this.k=i,this.vr=s}K(t){null!==this.k&&null!==this.dr&&this.dr.K(t,this.k,this.pr,this.vr)}}class ci{constructor(t,i,s){this.br=t,this.pr=new ai(50),this.wr=i,this.F=s,this.j=-1,this.qt=new ui(this.pr)}xt(){const t=this.F.gr(this.wr);if(null===t)return null;const i=t.Mr(this.wr)?t.Sr():this.wr.At();if(null===i)return null;const s=t.kr(i);if("overlay"===s)return null;const e=this.F.yr();return e.P!==this.j&&(this.j=e.P,this.pr.ar()),this.qt.mr(this.br.Fi(),e,s),this.qt}}class di extends tt{constructor(){super(...arguments),this.Et=null}it(t){this.Et=t}Cr(t,i){var s;if(!(null===(s=this.Et)||void 0===s?void 0:s.Tt))return null;const{rt:e,ht:h,Tr:n}=this.Et;return i>=e-h-7&&i<=e+h+7?{Pr:this.Et,Tr:n}:null}Z({context:t,bitmapSize:i,horizontalPixelRatio:s,verticalPixelRatio:e}){if(null===this.Et)return;if(!1===this.Et.Tt)return;const h=Math.round(this.Et.rt*e);h<0||h>i.height||(t.lineCap="butt",t.strokeStyle=this.Et.O,t.lineWidth=Math.floor(this.Et.ht*s),S(t,this.Et.jt),_(t,h,0,i.width))}}class fi{constructor(t){this.Rr={rt:0,O:"rgba(0, 0, 0, 0)",ht:1,jt:0,Tt:!1},this.Dr=new di,this.bt=!0,this.Ws=t,this.js=t.Kt(),this.Dr.it(this.Rr)}gt(){this.bt=!0}xt(){return this.Ws.Tt()?(this.bt&&(this.Or(),this.bt=!1),this.Dr):null}}class pi extends fi{constructor(t){super(t)}Or(){this.Rr.Tt=!1;const t=this.Ws.At(),i=t.Ar().Ar;if(2!==i&&3!==i)return;const s=this.Ws.W();if(!s.baseLineVisible||!this.Ws.Tt())return;const e=this.Ws.Pt();null!==e&&(this.Rr.Tt=!0,this.Rr.rt=t.Ot(e.Vt,e.Vt),this.Rr.O=s.baseLineColor,this.Rr.ht=s.baseLineWidth,this.Rr.jt=s.baseLineStyle)}}class mi extends tt{constructor(){super(...arguments),this.Et=null}it(t){this.Et=t}Ze(){return this.Et}Z({context:t,horizontalPixelRatio:i,verticalPixelRatio:s}){const e=this.Et;if(null===e)return;const h=Math.max(1,Math.floor(i)),n=h%2/2,r=Math.round(e.ir.x*i)+n,o=e.ir.y*s;t.fillStyle=e.Vr,t.beginPath();const l=Math.max(2,1.5*e.Br)*i;t.arc(r,o,l,0,2*Math.PI,!1),t.fill(),t.fillStyle=e.Ir,t.beginPath(),t.arc(r,o,e.ot*i,0,2*Math.PI,!1),t.fill(),t.lineWidth=h,t.strokeStyle=e.Lr,t.beginPath(),t.arc(r,o,e.ot*i+h/2,0,2*Math.PI,!1),t.stroke()}}const vi=[{zr:0,Er:.25,Nr:4,Fr:10,Wr:.25,jr:0,Hr:.4,$r:.8},{zr:.25,Er:.525,Nr:10,Fr:14,Wr:0,jr:0,Hr:.8,$r:0},{zr:.525,Er:1,Nr:14,Fr:14,Wr:0,jr:0,Hr:0,$r:0}];function bi(t,i,s,e){return function(t,i){if("transparent"===t)return t;const s=L(t),e=s[3];return`rgba(${s[0]}, ${s[1]}, ${s[2]}, ${i*e})`}(t,s+(e-s)*i)}function gi(t,i){const s=t%2600/2600;let e;for(const l of vi)if(s>=l.zr&&s<=l.Er){e=l;break}M(void 0!==e,"Last price animation internal logic error");const h=(s-e.zr)/(e.Er-e.zr);return{Ir:bi(i,h,e.Wr,e.jr),Lr:bi(i,h,e.Hr,e.$r),ot:(n=h,r=e.Nr,o=e.Fr,r+(o-r)*n)};var n,r,o}class wi{constructor(t){this.qt=new mi,this.bt=!0,this.Ur=!0,this.qr=performance.now(),this.Yr=this.qr-1,this.Xr=t}Kr(){this.Yr=this.qr-1,this.gt()}Zr(){if(this.gt(),2===this.Xr.W().lastPriceAnimation){const t=performance.now(),i=this.Yr-t;if(i>0)return void(i<650&&(this.Yr+=2600));this.qr=t,this.Yr=t+2600}}gt(){this.bt=!0}Gr(){this.Ur=!0}Tt(){return 0!==this.Xr.W().lastPriceAnimation}Jr(){switch(this.Xr.W().lastPriceAnimation){case 0:return!1;case 1:return!0;case 2:return performance.now()<=this.Yr}}xt(){return this.bt?(this.St(),this.bt=!1,this.Ur=!1):this.Ur&&(this.Qr(),this.Ur=!1),this.qt}St(){this.qt.it(null);const t=this.Xr.Kt().yt(),i=t.Js(),s=this.Xr.Pt();if(null===i||null===s)return;const e=this.Xr.th(!0);if(e.ih||!i.nh(e.le))return;const h={x:t.zt(e.le),y:this.Xr.At().Ot(e.ct,s.Vt)},n=e.O,r=this.Xr.W().lineWidth,o=gi(this.sh(),n);this.qt.it({Vr:n,Br:r,Ir:o.Ir,Lr:o.Lr,ot:o.ot,ir:h})}Qr(){const t=this.qt.Ze();if(null!==t){const i=gi(this.sh(),t.Vr);t.Ir=i.Ir,t.Lr=i.Lr,t.ot=i.ot}}sh(){return this.Jr()?performance.now()-this.qr:2599}}function yi(t,i){return Pt(Math.min(Math.max(t,12),30)*i)}function Si(t,i){switch(t){case"arrowDown":case"arrowUp":return yi(i,1);case"circle":return yi(i,.8);case"square":return yi(i,.7)}}function _i(t){return function(t){const i=Math.ceil(t);return i%2!=0?i-1:i}(yi(t,1))}function Mi(t){return Math.max(yi(t,.1),3)}function xi(t,i,s,e,h){const n=Si("square",s),r=(n-1)/2,o=t-r,l=i-r;return e>=o&&e<=o+n&&h>=l&&h<=l+n}function Ci(t,i,s,e,h){const n=(Si("arrowUp",h)-1)/2,r=(Pt(h/2)-1)/2;i.beginPath(),t?(i.moveTo(s-n,e),i.lineTo(s,e-n),i.lineTo(s+n,e),i.lineTo(s+r,e),i.lineTo(s+r,e+n),i.lineTo(s-r,e+n),i.lineTo(s-r,e)):(i.moveTo(s-n,e),i.lineTo(s,e+n),i.lineTo(s+n,e),i.lineTo(s+r,e),i.lineTo(s+r,e-n),i.lineTo(s-r,e-n),i.lineTo(s-r,e)),i.fill()}class Ei extends Z{constructor(){super(...arguments),this.Et=null,this.pr=new ai,this.j=-1,this.H="",this.eh=""}it(t){this.Et=t}mr(t,i){this.j===t&&this.H===i||(this.j=t,this.H=i,this.eh=X(t,i),this.pr.ar())}Cr(t,i){if(null===this.Et||null===this.Et.nt)return null;for(let s=this.Et.nt.from;s<this.Et.nt.to;s++){const e=this.Et.st[s];if(zi(e,t,i))return{Pr:e.rh,Tr:e.Tr}}return null}Z({context:t},i,s){if(null!==this.Et&&null!==this.Et.nt){t.textBaseline="middle",t.font=this.eh;for(let i=this.Et.nt.from;i<this.Et.nt.to;i++){const s=this.Et.st[i];void 0!==s.ii&&(s.ii.Xi=this.pr.Ti(t,s.ii.hh),s.ii.Lt=this.j,s.ii.et=s.et-s.ii.Xi/2),Ti(s,t)}}}}function Ti(t,i){i.fillStyle=t.O,void 0!==t.ii&&function(t,i,s,e){t.fillText(i,s,e)}(i,t.ii.hh,t.ii.et,t.ii.rt),function(t,i){if(0!==t.Qs){switch(t.lh){case"arrowDown":return void Ci(!1,i,t.et,t.rt,t.Qs);case"arrowUp":return void Ci(!0,i,t.et,t.rt,t.Qs);case"circle":return void function(t,i,s,e){const h=(Si("circle",e)-1)/2;t.beginPath(),t.arc(i,s,h,0,2*Math.PI,!1),t.fill()}(i,t.et,t.rt,t.Qs);case"square":return void function(t,i,s,e){const h=Si("square",e),n=(h-1)/2,r=i-n,o=s-n;t.fillRect(r,o,h,h)}(i,t.et,t.rt,t.Qs)}t.lh}}(t,i)}function zi(t,i,s){return!(void 0===t.ii||!function(t,i,s,e,h,n){const r=e/2;return h>=t&&h<=t+s&&n>=i-r&&n<=i+r}(t.ii.et,t.ii.rt,t.ii.Xi,t.ii.Lt,i,s))||function(t,i,s){if(0===t.Qs)return!1;switch(t.lh){case"arrowDown":case"arrowUp":return function(t,i,s,e,h,n){return xi(i,s,e,h,n)}(0,t.et,t.rt,t.Qs,i,s);case"circle":return function(t,i,s,e,h){const n=2+Si("circle",s)/2,r=t-e,o=i-h;return Math.sqrt(r*r+o*o)<=n}(t.et,t.rt,t.Qs,i,s);case"square":return xi(t.et,t.rt,t.Qs,i,s)}}(t,i,s)}function ki(t,i,s,e,h,n,r,o,l){const a=V(s)?s:s.Ce,u=V(s)?s:s.ke,c=V(s)?s:s.ye,d=V(i.size)?Math.max(i.size,0):1,f=_i(o._e())*d,p=f/2;switch(t.Qs=f,i.position){case"inBar":return t.rt=r.Ot(a,l),void(void 0!==t.ii&&(t.ii.rt=t.rt+p+n+.6*h));case"aboveBar":return t.rt=r.Ot(u,l)-p-e.ah,void 0!==t.ii&&(t.ii.rt=t.rt-p-.6*h,e.ah+=1.2*h),void(e.ah+=f+n);case"belowBar":return t.rt=r.Ot(c,l)+p+e.oh,void 0!==t.ii&&(t.ii.rt=t.rt+p+n+.6*h,e.oh+=1.2*h),void(e.oh+=f+n)}i.position}class Wi{constructor(t,i){this.bt=!0,this._h=!0,this.uh=!0,this.dh=null,this.qt=new Ei,this.Xr=t,this.Ki=i,this.Et={st:[],nt:null}}gt(t){this.bt=!0,this.uh=!0,"data"===t&&(this._h=!0)}xt(t){if(!this.Xr.Tt())return null;this.bt&&this.fh();const i=this.Ki.W().layout;return this.qt.mr(i.fontSize,i.fontFamily),this.qt.it(this.Et),this.qt}ph(){if(this.uh){if(this.Xr.mh().length>0){const t=this.Ki.yt()._e(),i=Mi(t),s=1.5*_i(t)+2*i;this.dh={above:s,below:s}}else this.dh=null;this.uh=!1}return this.dh}fh(){const t=this.Xr.At(),i=this.Ki.yt(),s=this.Xr.mh();this._h&&(this.Et.st=s.map((t=>({ut:t.time,et:0,rt:0,Qs:0,lh:t.shape,O:t.color,rh:t.rh,Tr:t.id,ii:void 0}))),this._h=!1);const e=this.Ki.W().layout;this.Et.nt=null;const h=i.Js();if(null===h)return;const n=this.Xr.Pt();if(null===n)return;if(0===this.Et.st.length)return;let r=NaN;const o=Mi(i._e()),l={ah:o,oh:o};this.Et.nt=Ft(this.Et.st,h,!0);for(let a=this.Et.nt.from;a<this.Et.nt.to;a++){const h=s[a];h.time!==r&&(l.ah=o,l.oh=o,r=h.time);const u=this.Et.st[a];u.et=i.zt(h.time),void 0!==h.text&&h.text.length>0&&(u.ii={hh:h.text,et:0,rt:0,Xi:0,Lt:0});const c=this.Xr.bh(h.time);null!==c&&ki(u,h,c,l,e.fontSize,o,t,i,n.Vt)}this.bt=!1}}class Ri extends fi{constructor(t){super(t)}Or(){const t=this.Rr;t.Tt=!1;const i=this.Ws.W();if(!i.priceLineVisible||!this.Ws.Tt())return;const s=this.Ws.th(0===i.priceLineSource);s.ih||(t.Tt=!0,t.rt=s.Ri,t.O=this.Ws.wh(s.O),t.ht=i.priceLineWidth,t.jt=i.priceLineStyle)}}class Oi extends ut{constructor(t){super(),this.Yt=t}Wi(t,i,s){t.Tt=!1,i.Tt=!1;const e=this.Yt;if(!e.Tt())return;const h=e.W(),n=h.lastValueVisible,r=""!==e.gh(),o=0===h.seriesLastValueMode,l=e.th(!1);if(l.ih)return;n&&(t.ii=this.Mh(l,n,o),t.Tt=0!==t.ii.length),(r||o)&&(i.ii=this.xh(l,n,r,o),i.Tt=i.ii.length>0);const a=e.wh(l.O),u=N(a);s.t=u.t,s.Ri=l.Ri,i.Bt=e.Kt().It(l.Ri/e.At().Lt()),t.Bt=a,t.O="black",i.O="black"}xh(t,i,s,e){let h="";const n=this.Yt.gh();return s&&0!==n.length&&(h+=`${n} `),i&&e&&(h+=this.Yt.At().Sh()?t.kh:t.yh),h.trim()}Mh(t,i,s){return i?s?this.Yt.At().Sh()?t.yh:t.kh:t.ii:""}}function Pi(t,i,s,e){const h=Number.isFinite(i),n=Number.isFinite(s);return h&&n?t(i,s):h||n?h?i:s:e}class Li{constructor(t,i){this.Ch=t,this.Th=i}Ph(t){return null!==t&&this.Ch===t.Ch&&this.Th===t.Th}Rh(){return new Li(this.Ch,this.Th)}Dh(){return this.Ch}Oh(){return this.Th}Ah(){return this.Th-this.Ch}$i(){return this.Th===this.Ch||Number.isNaN(this.Th)||Number.isNaN(this.Ch)}rs(t){return null===t?this:new Li(Pi(Math.min,this.Dh(),t.Dh(),-1/0),Pi(Math.max,this.Oh(),t.Oh(),1/0))}Vh(t){if(!V(t))return;if(0==this.Th-this.Ch)return;const i=.5*(this.Th+this.Ch);let s=this.Th-i,e=this.Ch-i;s*=t,e*=t,this.Th=i+s,this.Ch=i+e}Bh(t){V(t)&&(this.Th+=t,this.Ch+=t)}Ih(){return{minValue:this.Ch,maxValue:this.Th}}static Lh(t){return null===t?null:new Li(t.minValue,t.maxValue)}}class Ni{constructor(t,i){this.zh=t,this.Eh=i||null}Nh(){return this.zh}Fh(){return this.Eh}Ih(){return null===this.zh?null:{priceRange:this.zh.Ih(),margins:this.Eh||void 0}}static Lh(t){return null===t?null:new Ni(Li.Lh(t.priceRange),t.margins)}}class Ki extends fi{constructor(t,i){super(t),this.Wh=i}Or(){const t=this.Rr;t.Tt=!1;const i=this.Wh.W();if(!this.Ws.Tt()||!i.lineVisible)return;const s=this.Wh.jh();null!==s&&(t.Tt=!0,t.rt=s,t.O=i.color,t.ht=i.lineWidth,t.jt=i.lineStyle,t.Tr=this.Wh.W().id)}}class Di extends ut{constructor(t,i){super(),this.Xr=t,this.Wh=i}Wi(t,i,s){t.Tt=!1,i.Tt=!1;const e=this.Wh.W(),h=e.axisLabelVisible,n=""!==e.title,r=this.Xr;if(!h||!r.Tt())return;const o=this.Wh.jh();if(null===o)return;n&&(i.ii=e.title,i.Tt=!0),i.Bt=r.Kt().It(o/r.At().Lt()),t.ii=this.Hh(e.price),t.Tt=!0;const l=N(e.axisLabelColor||e.color);s.t=l.t;const a=e.axisLabelTextColor||l.i;t.O=a,i.O=a,t.ni=e.axisLabelCornerRadius,s.Ri=o}Hh(t){const i=this.Xr.Pt();return null===i?"":this.Xr.At().Ui(t,i.Vt)}}class Vi{constructor(t,i){this.Xr=t,this.pn=i,this.$h=new Ki(t,this),this.br=new Di(t,this),this.Uh=new ci(this.br,t,t.Kt())}qh(t){D(this.pn,t),this.gt(),this.Xr.Kt().Yh()}W(){return this.pn}Xh(){return this.$h}Kh(){return this.Uh}Zh(){return this.br}gt(){this.$h.gt(),this.br.gt()}jh(){const t=this.Xr,i=t.At();if(t.Kt().yt().$i()||i.$i())return null;const s=t.Pt();return null===s?null:i.Ot(this.pn.price,s.Vt)}}class Bi extends mt{constructor(t){super(),this.Ki=t}Kt(){return this.Ki}}const Ai={Bar:(t,i,s,e)=>{var h;const n=i.upColor,r=i.downColor,o=C(t(s,e)),l=E(o.Vt[0])<=E(o.Vt[3]);return{ve:null!==(h=o.O)&&void 0!==h?h:l?n:r}},Candlestick:(t,i,s,e)=>{var h,n,r;const o=i.upColor,l=i.downColor,a=i.borderUpColor,u=i.borderDownColor,c=i.wickUpColor,d=i.wickDownColor,f=C(t(s,e)),p=E(f.Vt[0])<=E(f.Vt[3]);return{ve:null!==(h=f.O)&&void 0!==h?h:p?o:l,He:null!==(n=f.Bt)&&void 0!==n?n:p?a:u,We:null!==(r=f.Gh)&&void 0!==r?r:p?c:d}},Custom:(t,i,s,e)=>{var h;return{ve:null!==(h=C(t(s,e)).O)&&void 0!==h?h:i.color}},Area:(t,i,s,e)=>{var h,n,r,o;const l=C(t(s,e));return{ve:null!==(h=l._t)&&void 0!==h?h:i.lineColor,_t:null!==(n=l._t)&&void 0!==n?n:i.lineColor,Os:null!==(r=l.Os)&&void 0!==r?r:i.topColor,As:null!==(o=l.As)&&void 0!==o?o:i.bottomColor}},Baseline:(t,i,s,e)=>{var h,n,r,o,l,a;const u=C(t(s,e));return{ve:u.Vt[3]>=i.baseValue.price?i.topLineColor:i.bottomLineColor,Ae:null!==(h=u.Ae)&&void 0!==h?h:i.topLineColor,Ve:null!==(n=u.Ve)&&void 0!==n?n:i.bottomLineColor,Te:null!==(r=u.Te)&&void 0!==r?r:i.topFillColor1,Pe:null!==(o=u.Pe)&&void 0!==o?o:i.topFillColor2,Re:null!==(l=u.Re)&&void 0!==l?l:i.bottomFillColor1,De:null!==(a=u.De)&&void 0!==a?a:i.bottomFillColor2}},Line:(t,i,s,e)=>{var h,n;const r=C(t(s,e));return{ve:null!==(h=r.O)&&void 0!==h?h:i.color,_t:null!==(n=r.O)&&void 0!==n?n:i.color}},Histogram:(t,i,s,e)=>{var h;return{ve:null!==(h=C(t(s,e)).O)&&void 0!==h?h:i.color}}};class Ii{constructor(t){this.Jh=(t,i)=>void 0!==i?i.Vt:this.Xr.Nn().Qh(t),this.Xr=t,this.tl=Ai[t.il()]}Ys(t,i){return this.tl(this.Jh,this.Xr.W(),t,i)}}var ji;!function(t){t[t.NearestLeft=-1]="NearestLeft",t[t.None=0]="None",t[t.NearestRight=1]="NearestRight"}(ji||(ji={}));const Yi=30;class Fi{constructor(){this.nl=[],this.sl=new Map,this.el=new Map}rl(){return this.Qs()>0?this.nl[this.nl.length-1]:null}hl(){return this.Qs()>0?this.ll(0):null}En(){return this.Qs()>0?this.ll(this.nl.length-1):null}Qs(){return this.nl.length}$i(){return 0===this.Qs()}nh(t){return null!==this.al(t,0)}Qh(t){return this.ol(t)}ol(t,i=0){const s=this.al(t,i);return null===s?null:Object.assign(Object.assign({},this._l(s)),{le:this.ll(s)})}re(){return this.nl}ul(t,i,s){if(this.$i())return null;let e=null;for(const h of s)e=$i(e,this.cl(t,i,h));return e}it(t){this.el.clear(),this.sl.clear(),this.nl=t}ll(t){return this.nl[t].le}_l(t){return this.nl[t]}al(t,i){const s=this.dl(t);if(null===s&&0!==i)switch(i){case-1:return this.fl(t);case 1:return this.vl(t);default:throw new TypeError("Unknown search mode")}return s}fl(t){let i=this.pl(t);return i>0&&(i-=1),i!==this.nl.length&&this.ll(i)<t?i:null}vl(t){const i=this.ml(t);return i!==this.nl.length&&t<this.ll(i)?i:null}dl(t){const i=this.pl(t);return i===this.nl.length||t<this.nl[i].le?null:i}pl(t){return At(this.nl,t,((t,i)=>t.le<i))}ml(t){return It(this.nl,t,((t,i)=>t.le>i))}bl(t,i,s){let e=null;for(let h=t;h<i;h++){const t=this.nl[h].Vt[s];Number.isNaN(t)||(null===e?e={wl:t,gl:t}:(t<e.wl&&(e.wl=t),t>e.gl&&(e.gl=t)))}return e}cl(t,i,s){if(this.$i())return null;let e=null;const h=C(this.hl()),n=C(this.En()),r=Math.max(t,h),o=Math.min(i,n),l=Math.ceil(r/Yi)*Yi,a=Math.max(l,Math.floor(o/Yi)*Yi);{const t=this.pl(r),h=this.ml(Math.min(o,l,i));e=$i(e,this.bl(t,h,s))}let u=this.sl.get(s);void 0===u&&(u=new Map,this.sl.set(s,u));for(let c=Math.max(l+1,r);c<a;c+=Yi){const t=Math.floor(c/Yi);let i=u.get(t);if(void 0===i){const e=this.pl(t*Yi),h=this.ml((t+1)*Yi-1);i=this.bl(e,h,s),u.set(t,i)}e=$i(e,i)}{const t=this.pl(a),i=this.ml(o);e=$i(e,this.bl(t,i,s))}return e}}function $i(t,i){return null===t?i:null===i?t:{wl:Math.min(t.wl,i.wl),gl:Math.max(t.gl,i.gl)}}class Xi{constructor(t){this.Ml=t}K(t,i,s){this.Ml.draw(t)}G(t,i,s){var e,h;null===(h=(e=this.Ml).drawBackground)||void 0===h||h.call(e,t)}}class Ui{constructor(t){this.hr=null,this.Sn=t}xt(){var t;const i=this.Sn.renderer();if(null===i)return null;if((null===(t=this.hr)||void 0===t?void 0:t.xl)===i)return this.hr.Sl;const s=new Xi(i);return this.hr={xl:i,Sl:s},s}kl(){var t,i,s;return null!==(s=null===(i=(t=this.Sn).zOrder)||void 0===i?void 0:i.call(t))&&void 0!==s?s:"normal"}}function qi(t){var i,s,e,h,n;return{ii:t.text(),Ri:t.coordinate(),Pi:null===(i=t.fixedCoordinate)||void 0===i?void 0:i.call(t),O:t.textColor(),t:t.backColor(),Tt:null===(e=null===(s=t.visible)||void 0===s?void 0:s.call(t))||void 0===e||e,ci:null===(n=null===(h=t.tickVisible)||void 0===h?void 0:h.call(t))||void 0===n||n}}class Zi{constructor(t,i){this.qt=new ft,this.yl=t,this.Cl=i}xt(){return this.qt.it(Object.assign(Object.assign({Xi:this.Cl.Xi()},qi(this.yl)),{ni:10})),this.qt}}class Qi extends ut{constructor(t,i){super(),this.yl=t,this.ji=i}Wi(t,i,s){const e=qi(this.yl);s.t=e.t,t.O=e.O;const h=2/12*this.ji.P();s.ki=h,s.yi=h,s.Ri=e.Ri,s.Pi=e.Pi,t.ii=e.ii,t.Tt=e.Tt,t.ci=e.ci}}class Hi{constructor(t,i){this.Tl=null,this.Pl=null,this.Rl=null,this.Dl=null,this.Ol=null,this.Al=t,this.Xr=i}Vl(){return this.Al}In(){var t,i;null===(i=(t=this.Al).updateAllViews)||void 0===i||i.call(t)}An(){var t,i,s,e;const h=null!==(s=null===(i=(t=this.Al).paneViews)||void 0===i?void 0:i.call(t))&&void 0!==s?s:[];if((null===(e=this.Tl)||void 0===e?void 0:e.xl)===h)return this.Tl.Sl;const n=h.map((t=>new Ui(t)));return this.Tl={xl:h,Sl:n},n}rn(){var t,i,s,e;const h=null!==(s=null===(i=(t=this.Al).timeAxisViews)||void 0===i?void 0:i.call(t))&&void 0!==s?s:[];if((null===(e=this.Pl)||void 0===e?void 0:e.xl)===h)return this.Pl.Sl;const n=this.Xr.Kt().yt(),r=h.map((t=>new Zi(t,n)));return this.Pl={xl:h,Sl:r},r}Vn(){var t,i,s,e;const h=null!==(s=null===(i=(t=this.Al).priceAxisViews)||void 0===i?void 0:i.call(t))&&void 0!==s?s:[];if((null===(e=this.Rl)||void 0===e?void 0:e.xl)===h)return this.Rl.Sl;const n=this.Xr.At(),r=h.map((t=>new Qi(t,n)));return this.Rl={xl:h,Sl:r},r}Bl(){var t,i,s,e;const h=null!==(s=null===(i=(t=this.Al).priceAxisPaneViews)||void 0===i?void 0:i.call(t))&&void 0!==s?s:[];if((null===(e=this.Dl)||void 0===e?void 0:e.xl)===h)return this.Dl.Sl;const n=h.map((t=>new Ui(t)));return this.Dl={xl:h,Sl:n},n}Il(){var t,i,s,e;const h=null!==(s=null===(i=(t=this.Al).timeAxisPaneViews)||void 0===i?void 0:i.call(t))&&void 0!==s?s:[];if((null===(e=this.Ol)||void 0===e?void 0:e.xl)===h)return this.Ol.Sl;const n=h.map((t=>new Ui(t)));return this.Ol={xl:h,Sl:n},n}Ll(t,i){var s,e,h;return null!==(h=null===(e=(s=this.Al).autoscaleInfo)||void 0===e?void 0:e.call(s,t,i))&&void 0!==h?h:null}Cr(t,i){var s,e,h;return null!==(h=null===(e=(s=this.Al).hitTest)||void 0===e?void 0:e.call(s,t,i))&&void 0!==h?h:null}}function Gi(t,i,s,e){t.forEach((t=>{i(t).forEach((t=>{t.kl()===s&&e.push(t)}))}))}function Ji(t){return t.An()}function ts(t){return t.Bl()}function is(t){return t.Il()}class ss extends Bi{constructor(t,i,s,e,h){super(t),this.Et=new Fi,this.$h=new Ri(this),this.zl=[],this.El=new pi(this),this.Nl=null,this.Fl=null,this.Wl=[],this.jl=[],this.Hl=null,this.$l=[],this.pn=i,this.Ul=s;const n=new Oi(this);this._n=[n],this.Uh=new ci(n,this,t),"Area"!==s&&"Line"!==s&&"Baseline"!==s||(this.Nl=new wi(this)),this.ql(),this.Yl(h)}S(){null!==this.Hl&&clearTimeout(this.Hl)}wh(t){return this.pn.priceLineColor||t}th(t){const i={ih:!0},s=this.At();if(this.Kt().yt().$i()||s.$i()||this.Et.$i())return i;const e=this.Kt().yt().Js(),h=this.Pt();if(null===e||null===h)return i;let n,r;if(t){const t=this.Et.rl();if(null===t)return i;n=t,r=t.le}else{const t=this.Et.ol(e.mi(),-1);if(null===t)return i;if(n=this.Et.Qh(t.le),null===n)return i;r=t.le}const o=n.Vt[3],l=this.Xs().Ys(r,{Vt:n}),a=s.Ot(o,h.Vt);return{ih:!1,ct:o,ii:s.Ui(o,h.Vt),kh:s.Xl(o),yh:s.Kl(o,h.Vt),O:l.ve,Ri:a,le:r}}Xs(){return null!==this.Fl||(this.Fl=new Ii(this)),this.Fl}W(){return this.pn}qh(t){const i=t.priceScaleId;void 0!==i&&i!==this.pn.priceScaleId&&this.Kt().Zl(this,i),D(this.pn,t),void 0!==t.priceFormat&&(this.ql(),this.Kt().Gl()),this.Kt().Jl(this),this.Kt().Ql(),this.Sn.gt("options")}it(t,i){this.Et.it(t),this.ta(),this.Sn.gt("data"),this.mn.gt("data"),null!==this.Nl&&(i&&i.ia?this.Nl.Zr():0===t.length&&this.Nl.Kr());const s=this.Kt().gr(this);this.Kt().na(s),this.Kt().Jl(this),this.Kt().Ql(),this.Kt().Yh()}sa(t){this.Wl=t,this.ta();const i=this.Kt().gr(this);this.mn.gt("data"),this.Kt().na(i),this.Kt().Jl(this),this.Kt().Ql(),this.Kt().Yh()}ea(){return this.Wl}mh(){return this.jl}ra(t){const i=new Vi(this,t);return this.zl.push(i),this.Kt().Jl(this),i}ha(t){const i=this.zl.indexOf(t);-1!==i&&this.zl.splice(i,1),this.Kt().Jl(this)}il(){return this.Ul}Pt(){const t=this.la();return null===t?null:{Vt:t.Vt[3],aa:t.ut}}la(){const t=this.Kt().yt().Js();if(null===t)return null;const i=t.Is();return this.Et.ol(i,1)}Nn(){return this.Et}bh(t){const i=this.Et.Qh(t);return null===i?null:"Bar"===this.Ul||"Candlestick"===this.Ul||"Custom"===this.Ul?{Se:i.Vt[0],ke:i.Vt[1],ye:i.Vt[2],Ce:i.Vt[3]}:i.Vt[3]}oa(t){const i=[];Gi(this.$l,Ji,"top",i);const s=this.Nl;return null!==s&&s.Tt()?(null===this.Hl&&s.Jr()&&(this.Hl=setTimeout((()=>{this.Hl=null,this.Kt()._a()}),0)),s.Gr(),i.push(s),i):i}An(){const t=[];this.ua()||t.push(this.El),t.push(this.Sn,this.$h,this.mn);const i=this.zl.map((t=>t.Xh()));return t.push(...i),Gi(this.$l,Ji,"normal",t),t}ca(){return this.da(Ji,"bottom")}fa(t){return this.da(ts,t)}va(t){return this.da(is,t)}pa(t,i){return this.$l.map((s=>s.Cr(t,i))).filter((t=>null!==t))}en(t){return[this.Uh,...this.zl.map((t=>t.Kh()))]}Vn(t,i){if(i!==this.Ji&&!this.ua())return[];const s=[...this._n];for(const e of this.zl)s.push(e.Zh());return this.$l.forEach((t=>{s.push(...t.Vn())})),s}rn(){const t=[];return this.$l.forEach((i=>{t.push(...i.rn())})),t}Ll(t,i){if(void 0!==this.pn.autoscaleInfoProvider){const s=this.pn.autoscaleInfoProvider((()=>{const s=this.ma(t,i);return null===s?null:s.Ih()}));return Ni.Lh(s)}return this.ma(t,i)}ba(){return this.pn.priceFormat.minMove}wa(){return this.ga}In(){var t;this.Sn.gt(),this.mn.gt();for(const i of this._n)i.gt();for(const i of this.zl)i.gt();this.$h.gt(),this.El.gt(),null===(t=this.Nl)||void 0===t||t.gt(),this.$l.forEach((t=>t.In()))}At(){return C(super.At())}Ct(t){if("Line"!==this.Ul&&"Area"!==this.Ul&&"Baseline"!==this.Ul||!this.pn.crosshairMarkerVisible)return null;const i=this.Et.Qh(t);return null===i?null:{ct:i.Vt[3],ot:this.Ma(),Bt:this.xa(),Dt:this.Sa(),Rt:this.ka(t)}}gh(){return this.pn.title}Tt(){return this.pn.visible}ya(t){this.$l.push(new Hi(t,this))}Ca(t){this.$l=this.$l.filter((i=>i.Vl()!==t))}Ta(){if(this.Sn instanceof ei!=0)return t=>this.Sn.Ye(t)}Pa(){if(this.Sn instanceof ei!=0)return t=>this.Sn.Xe(t)}ua(){return!gt(this.At().Ra())}ma(t,i){if(!B(t)||!B(i)||this.Et.$i())return null;const s="Line"===this.Ul||"Area"===this.Ul||"Baseline"===this.Ul||"Histogram"===this.Ul?[3]:[2,1],e=this.Et.ul(t,i,s);let h=null!==e?new Li(e.wl,e.gl):null;if("Histogram"===this.il()){const t=this.pn.base,i=new Li(t,t);h=null!==h?h.rs(i):i}let n=this.mn.ph();return this.$l.forEach((s=>{const e=s.Ll(t,i);if(null==e?void 0:e.priceRange){const t=new Li(e.priceRange.minValue,e.priceRange.maxValue);h=null!==h?h.rs(t):t}var r,o,l,a;(null==e?void 0:e.margins)&&(r=n,o=e.margins,n={above:Math.max(null!==(l=null==r?void 0:r.above)&&void 0!==l?l:0,o.above),below:Math.max(null!==(a=null==r?void 0:r.below)&&void 0!==a?a:0,o.below)})})),new Ni(h,n)}Ma(){switch(this.Ul){case"Line":case"Area":case"Baseline":return this.pn.crosshairMarkerRadius}return 0}xa(){switch(this.Ul){case"Line":case"Area":case"Baseline":{const t=this.pn.crosshairMarkerBorderColor;if(0!==t.length)return t}}return null}Sa(){switch(this.Ul){case"Line":case"Area":case"Baseline":return this.pn.crosshairMarkerBorderWidth}return 0}ka(t){switch(this.Ul){case"Line":case"Area":case"Baseline":{const t=this.pn.crosshairMarkerBackgroundColor;if(0!==t.length)return t}}return this.Xs().Ys(t).ve}ql(){switch(this.pn.priceFormat.type){case"custom":this.ga={format:this.pn.priceFormat.formatter};break;case"volume":this.ga=new Mt(this.pn.priceFormat.precision);break;case"percent":this.ga=new _t(this.pn.priceFormat.precision);break;default:{const t=Math.pow(10,this.pn.priceFormat.precision);this.ga=new St(t,this.pn.priceFormat.minMove*t)}}null!==this.Ji&&this.Ji.Da()}ta(){const t=this.Kt().yt();if(!t.Oa()||this.Et.$i())return void(this.jl=[]);const i=C(this.Et.hl());this.jl=this.Wl.map(((s,e)=>{const h=C(t.Aa(s.time,!0)),n=h<i?1:-1;return{time:C(this.Et.ol(h,n)).le,position:s.position,shape:s.shape,color:s.color,id:s.id,rh:e,text:s.text,size:s.size,originalTime:s.originalTime}}))}Yl(t){switch(this.mn=new Wi(this,this.Kt()),this.Ul){case"Bar":this.Sn=new Qt(this,this.Kt());break;case"Candlestick":this.Sn=new ii(this,this.Kt());break;case"Line":this.Sn=new oi(this,this.Kt());break;case"Custom":this.Sn=new ei(this,this.Kt(),x(t));break;case"Area":this.Sn=new Ut(this,this.Kt());break;case"Baseline":this.Sn=new Jt(this,this.Kt());break;case"Histogram":this.Sn=new ri(this,this.Kt());break;default:throw Error("Unknown chart style assigned: "+this.Ul)}}da(t,i){const s=[];return Gi(this.$l,t,i,s),s}}class es{constructor(t){this.pn=t}Va(t,i,s){let e=t;if(0===this.pn.mode)return e;const h=s.wn(),n=h.Pt();if(null===n)return e;const r=h.Ot(t,n),o=s.Ba().filter((t=>t instanceof ss)).reduce(((t,e)=>{if(s.Mr(e)||!e.Tt())return t;const h=e.At(),n=e.Nn();if(h.$i()||!n.nh(i))return t;const r=n.Qh(i);if(null===r)return t;const o=E(e.Pt());return t.concat([h.Ot(r.Vt[3],o.Vt)])}),[]);if(0===o.length)return e;o.sort(((t,i)=>Math.abs(t-r)-Math.abs(i-r)));const l=o[0];return e=h.gn(l,n),e}}class hs extends tt{constructor(){super(...arguments),this.Et=null}it(t){this.Et=t}Z({context:t,bitmapSize:i,horizontalPixelRatio:s,verticalPixelRatio:e}){if(null===this.Et)return;const h=Math.max(1,Math.floor(s));t.lineWidth=h,function(t,i){t.save(),t.lineWidth%2&&t.translate(.5,.5),i(),t.restore()}(t,(()=>{const n=C(this.Et);if(n.Ia){t.strokeStyle=n.La,S(t,n.za),t.beginPath();for(const e of n.Ea){const n=Math.round(e.Na*s);t.moveTo(n,-h),t.lineTo(n,i.height+h)}t.stroke()}if(n.Fa){t.strokeStyle=n.Wa,S(t,n.ja),t.beginPath();for(const s of n.Ha){const n=Math.round(s.Na*e);t.moveTo(-h,n),t.lineTo(i.width+h,n)}t.stroke()}}))}}class ns{constructor(t){this.qt=new hs,this.bt=!0,this.hn=t}gt(){this.bt=!0}xt(){if(this.bt){const t=this.hn.Kt().W().grid,i={Fa:t.horzLines.visible,Ia:t.vertLines.visible,Wa:t.horzLines.color,La:t.vertLines.color,ja:t.horzLines.style,za:t.vertLines.style,Ha:this.hn.wn().$a(),Ea:(this.hn.Kt().yt().$a()||[]).map((t=>({Na:t.coord})))};this.qt.it(i),this.bt=!1}return this.qt}}class rs{constructor(t){this.Sn=new ns(t)}Xh(){return this.Sn}}const os={Ua:4,qa:1e-4};function ls(t,i){const s=100*(t-i)/i;return i<0?-s:s}function as(t,i){const s=ls(t.Dh(),i),e=ls(t.Oh(),i);return new Li(s,e)}function us(t,i){const s=100*(t-i)/i+100;return i<0?-s:s}function cs(t,i){const s=us(t.Dh(),i),e=us(t.Oh(),i);return new Li(s,e)}function ds(t,i){const s=Math.abs(t);if(s<1e-15)return 0;const e=Math.log10(s+i.qa)+i.Ua;return t<0?-e:e}function fs(t,i){const s=Math.abs(t);if(s<1e-15)return 0;const e=Math.pow(10,s-i.Ua)-i.qa;return t<0?-e:e}function ps(t,i){if(null===t)return null;const s=ds(t.Dh(),i),e=ds(t.Oh(),i);return new Li(s,e)}function ms(t,i){if(null===t)return null;const s=fs(t.Dh(),i),e=fs(t.Oh(),i);return new Li(s,e)}function vs(t){if(null===t)return os;const i=Math.abs(t.Oh()-t.Dh());if(i>=1||i<1e-15)return os;const s=Math.ceil(Math.abs(Math.log10(i))),e=os.Ua+s;return{Ua:e,qa:1/Math.pow(10,e)}}class bs{constructor(t,i){if(this.Ya=t,this.Xa=i,function(t){if(t<0)return!1;for(let i=t;i>1;i/=10)if(i%10!=0)return!1;return!0}(this.Ya))this.Ka=[2,2.5,2];else{this.Ka=[];for(let t=this.Ya;1!==t;){if(t%2==0)this.Ka.push(2),t/=2;else{if(t%5!=0)throw new Error("unexpected base");this.Ka.push(2,2.5),t/=5}if(this.Ka.length>100)throw new Error("something wrong with base")}}}Za(t,i,s){const e=0===this.Ya?0:1/this.Ya;let h=Math.pow(10,Math.max(0,Math.ceil(Math.log10(t-i)))),n=0,r=this.Xa[0];for(;;){const t=Ot(h,e,1e-14)&&h>e+1e-14,i=Ot(h,s*r,1e-14),o=Ot(h,1,1e-14);if(!(t&&i&&o))break;h/=r,r=this.Xa[++n%this.Xa.length]}if(h<=e+1e-14&&(h=e),h=Math.max(1,h),this.Ka.length>0&&(o=h,1,1e-14,Math.abs(o-1)<1e-14))for(n=0,r=this.Ka[0];Ot(h,s*r,1e-14)&&h>e+1e-14;)h/=r,r=this.Ka[++n%this.Ka.length];var o;return h}}class gs{constructor(t,i,s,e){this.Ga=[],this.ji=t,this.Ya=i,this.Ja=s,this.Qa=e}Za(t,i){if(t<i)throw new Error("high < low");const s=this.ji.Lt(),e=(t-i)*this.io()/s,h=new bs(this.Ya,[2,2.5,2]),n=new bs(this.Ya,[2,2,2.5]),r=new bs(this.Ya,[2.5,2,2]),o=[];return o.push(h.Za(t,i,e),n.Za(t,i,e),r.Za(t,i,e)),function(t){if(t.length<1)throw Error("array is empty");let i=t[0];for(let s=1;s<t.length;++s)t[s]<i&&(i=t[s]);return i}(o)}no(){const t=this.ji,i=t.Pt();if(null===i)return void(this.Ga=[]);const s=t.Lt(),e=this.Ja(s-1,i),h=this.Ja(0,i),n=this.ji.W().entireTextOnly?this.so()/2:0,r=n,o=s-1-n,l=Math.max(e,h),a=Math.min(e,h);if(l===a)return void(this.Ga=[]);let u=this.Za(l,a),c=l%u;c+=c<0?u:0;const d=l>=a?1:-1;let f=null,p=0;for(let m=l-c;m>a;m-=u){const s=this.Qa(m,i,!0);null!==f&&Math.abs(s-f)<this.io()||s<r||s>o||(p<this.Ga.length?(this.Ga[p].Na=s,this.Ga[p].eo=t.ro(m)):this.Ga.push({Na:s,eo:t.ro(m)}),p++,f=s,t.ho()&&(u=this.Za(m*d,a)))}this.Ga.length=p}$a(){return this.Ga}so(){return this.ji.P()}io(){return Math.ceil(2.5*this.so())}}function ws(t){return t.slice().sort(((t,i)=>C(t.tn())-C(i.tn())))}var ys;!function(t){t[t.Normal=0]="Normal",t[t.Logarithmic=1]="Logarithmic",t[t.Percentage=2]="Percentage",t[t.IndexedTo100=3]="IndexedTo100"}(ys||(ys={}));const Ss=new _t,_s=new St(100,1);class Ms{constructor(t,i,s,e){this.lo=0,this.ao=null,this.zh=null,this.oo=null,this._o={uo:!1,co:null},this.do=0,this.fo=0,this.vo=new K,this.po=new K,this.mo=[],this.bo=null,this.wo=null,this.Mo=null,this.xo=null,this.ga=_s,this.So=vs(null),this.ko=t,this.pn=i,this.yo=s,this.Co=e,this.To=new gs(this,100,this.Po.bind(this),this.Ro.bind(this))}Ra(){return this.ko}W(){return this.pn}qh(t){if(D(this.pn,t),this.Da(),void 0!==t.mode&&this.Do({Ar:t.mode}),void 0!==t.scaleMargins){const i=x(t.scaleMargins.top),s=x(t.scaleMargins.bottom);if(i<0||i>1)throw new Error(`Invalid top margin - expect value between 0 and 1, given=${i}`);if(s<0||s>1||i+s>1)throw new Error(`Invalid bottom margin - expect value between 0 and 1, given=${s}`);if(i+s>1)throw new Error(`Invalid margins - sum of margins must be less than 1, given=${i+s}`);this.Oo(),this.wo=null}}Ao(){return this.pn.autoScale}ho(){return 1===this.pn.mode}Sh(){return 2===this.pn.mode}Vo(){return 3===this.pn.mode}Ar(){return{Un:this.pn.autoScale,Bo:this.pn.invertScale,Ar:this.pn.mode}}Do(t){const i=this.Ar();let s=null;void 0!==t.Un&&(this.pn.autoScale=t.Un),void 0!==t.Ar&&(this.pn.mode=t.Ar,2!==t.Ar&&3!==t.Ar||(this.pn.autoScale=!0),this._o.uo=!1),1===i.Ar&&t.Ar!==i.Ar&&(function(t,i){if(null===t)return!1;const s=fs(t.Dh(),i),e=fs(t.Oh(),i);return isFinite(s)&&isFinite(e)}(this.zh,this.So)?(s=ms(this.zh,this.So),null!==s&&this.Io(s)):this.pn.autoScale=!0),1===t.Ar&&t.Ar!==i.Ar&&(s=ps(this.zh,this.So),null!==s&&this.Io(s));const e=i.Ar!==this.pn.mode;e&&(2===i.Ar||this.Sh())&&this.Da(),e&&(3===i.Ar||this.Vo())&&this.Da(),void 0!==t.Bo&&i.Bo!==t.Bo&&(this.pn.invertScale=t.Bo,this.Lo()),this.po.m(i,this.Ar())}zo(){return this.po}P(){return this.yo.fontSize}Lt(){return this.lo}Eo(t){this.lo!==t&&(this.lo=t,this.Oo(),this.wo=null)}No(){if(this.ao)return this.ao;const t=this.Lt()-this.Fo()-this.Wo();return this.ao=t,t}Nh(){return this.jo(),this.zh}Io(t,i){const s=this.zh;(i||null===s&&null!==t||null!==s&&!s.Ph(t))&&(this.wo=null,this.zh=t)}$i(){return this.jo(),0===this.lo||!this.zh||this.zh.$i()}Ho(t){return this.Bo()?t:this.Lt()-1-t}Ot(t,i){return this.Sh()?t=ls(t,i):this.Vo()&&(t=us(t,i)),this.Ro(t,i)}se(t,i,s){this.jo();const e=this.Wo(),h=C(this.Nh()),n=h.Dh(),r=h.Oh(),o=this.No()-1,l=this.Bo(),a=o/(r-n),u=void 0===s?0:s.from,c=void 0===s?t.length:s.to,d=this.$o();for(let f=u;f<c;f++){const s=t[f],h=s.ct;if(isNaN(h))continue;let r=h;null!==d&&(r=d(s.ct,i));const o=e+a*(r-n),u=l?o:this.lo-1-o;s.rt=u}}Me(t,i,s){this.jo();const e=this.Wo(),h=C(this.Nh()),n=h.Dh(),r=h.Oh(),o=this.No()-1,l=this.Bo(),a=o/(r-n),u=void 0===s?0:s.from,c=void 0===s?t.length:s.to,d=this.$o();for(let f=u;f<c;f++){const s=t[f];let h=s.Se,r=s.ke,o=s.ye,u=s.Ce;null!==d&&(h=d(s.Se,i),r=d(s.ke,i),o=d(s.ye,i),u=d(s.Ce,i));let c=e+a*(h-n),p=l?c:this.lo-1-c;s.we=p,c=e+a*(r-n),p=l?c:this.lo-1-c,s.pe=p,c=e+a*(o-n),p=l?c:this.lo-1-c,s.me=p,c=e+a*(u-n),p=l?c:this.lo-1-c,s.ge=p}}gn(t,i){const s=this.Po(t,i);return this.Uo(s,i)}Uo(t,i){let s=t;return this.Sh()?s=function(t,i){return i<0&&(t=-t),t/100*i+i}(s,i):this.Vo()&&(s=function(t,i){return t-=100,i<0&&(t=-t),t/100*i+i}(s,i)),s}Ba(){return this.mo}qo(){if(this.bo)return this.bo;let t=[];for(let i=0;i<this.mo.length;i++){const s=this.mo[i];null===s.tn()&&s.nn(i+1),t.push(s)}return t=ws(t),this.bo=t,this.bo}Yo(t){-1===this.mo.indexOf(t)&&(this.mo.push(t),this.Da(),this.Xo())}Ko(t){const i=this.mo.indexOf(t);if(-1===i)throw new Error("source is not attached to scale");this.mo.splice(i,1),0===this.mo.length&&(this.Do({Un:!0}),this.Io(null)),this.Da(),this.Xo()}Pt(){let t=null;for(const i of this.mo){const s=i.Pt();null!==s&&(null===t||s.aa<t.aa)&&(t=s)}return null===t?null:t.Vt}Bo(){return this.pn.invertScale}$a(){const t=null===this.Pt();if(null!==this.wo&&(t||this.wo.Zo===t))return this.wo.$a;this.To.no();const i=this.To.$a();return this.wo={$a:i,Zo:t},this.vo.m(),i}Go(){return this.vo}Jo(t){this.Sh()||this.Vo()||null===this.Mo&&null===this.oo&&(this.$i()||(this.Mo=this.lo-t,this.oo=C(this.Nh()).Rh()))}Qo(t){if(this.Sh()||this.Vo())return;if(null===this.Mo)return;this.Do({Un:!1}),(t=this.lo-t)<0&&(t=0);let i=(this.Mo+.2*(this.lo-1))/(t+.2*(this.lo-1));const s=C(this.oo).Rh();i=Math.max(i,.1),s.Vh(i),this.Io(s)}t_(){this.Sh()||this.Vo()||(this.Mo=null,this.oo=null)}i_(t){this.Ao()||null===this.xo&&null===this.oo&&(this.$i()||(this.xo=t,this.oo=C(this.Nh()).Rh()))}n_(t){if(this.Ao())return;if(null===this.xo)return;const i=C(this.Nh()).Ah()/(this.No()-1);let s=t-this.xo;this.Bo()&&(s*=-1);const e=s*i,h=C(this.oo).Rh();h.Bh(e),this.Io(h,!0),this.wo=null}s_(){this.Ao()||null!==this.xo&&(this.xo=null,this.oo=null)}wa(){return this.ga||this.Da(),this.ga}Ui(t,i){switch(this.pn.mode){case 2:return this.e_(ls(t,i));case 3:return this.wa().format(us(t,i));default:return this.Hh(t)}}ro(t){switch(this.pn.mode){case 2:return this.e_(t);case 3:return this.wa().format(t);default:return this.Hh(t)}}Xl(t){return this.Hh(t,C(this.r_()).wa())}Kl(t,i){return t=ls(t,i),this.e_(t,Ss)}h_(){return this.mo}l_(t){this._o={co:t,uo:!1}}In(){this.mo.forEach((t=>t.In()))}Da(){this.wo=null;const t=this.r_();let i=100;null!==t&&(i=Math.round(1/t.ba())),this.ga=_s,this.Sh()?(this.ga=Ss,i=100):this.Vo()?(this.ga=new St(100,1),i=100):null!==t&&(this.ga=t.wa()),this.To=new gs(this,i,this.Po.bind(this),this.Ro.bind(this)),this.To.no()}Xo(){this.bo=null}r_(){return this.mo[0]||null}Fo(){return this.Bo()?this.pn.scaleMargins.bottom*this.Lt()+this.fo:this.pn.scaleMargins.top*this.Lt()+this.do}Wo(){return this.Bo()?this.pn.scaleMargins.top*this.Lt()+this.do:this.pn.scaleMargins.bottom*this.Lt()+this.fo}jo(){this._o.uo||(this._o.uo=!0,this.a_())}Oo(){this.ao=null}Ro(t,i){if(this.jo(),this.$i())return 0;t=this.ho()&&t?ds(t,this.So):t;const s=C(this.Nh()),e=this.Wo()+(this.No()-1)*(t-s.Dh())/s.Ah();return this.Ho(e)}Po(t,i){if(this.jo(),this.$i())return 0;const s=this.Ho(t),e=C(this.Nh()),h=e.Dh()+e.Ah()*((s-this.Wo())/(this.No()-1));return this.ho()?fs(h,this.So):h}Lo(){this.wo=null,this.To.no()}a_(){const t=this._o.co;if(null===t)return;let i=null;const s=this.h_();let e=0,h=0;for(const o of s){if(!o.Tt())continue;const s=o.Pt();if(null===s)continue;const n=o.Ll(t.Is(),t.mi());let r=n&&n.Nh();if(null!==r){switch(this.pn.mode){case 1:r=ps(r,this.So);break;case 2:r=as(r,s.Vt);break;case 3:r=cs(r,s.Vt)}if(i=null===i?r:i.rs(C(r)),null!==n){const t=n.Fh();null!==t&&(e=Math.max(e,t.above),h=Math.max(e,t.below))}}}if(e===this.do&&h===this.fo||(this.do=e,this.fo=h,this.wo=null,this.Oo()),null!==i){if(i.Dh()===i.Oh()){const t=this.r_(),s=5*(null===t||this.Sh()||this.Vo()?1:t.ba());this.ho()&&(i=ms(i,this.So)),i=new Li(i.Dh()-s,i.Oh()+s),this.ho()&&(i=ps(i,this.So))}if(this.ho()){const t=ms(i,this.So),s=vs(t);if(n=s,r=this.So,n.Ua!==r.Ua||n.qa!==r.qa){const e=null!==this.oo?ms(this.oo,this.So):null;this.So=s,i=ps(t,s),null!==e&&(this.oo=ps(e,s))}}this.Io(i)}else null===this.zh&&(this.Io(new Li(-.5,.5)),this.So=vs(null));var n,r;this._o.uo=!0}$o(){return this.Sh()?ls:this.Vo()?us:this.ho()?t=>ds(t,this.So):null}o_(t,i,s){return void 0===i?(void 0===s&&(s=this.wa()),s.format(t)):i(t)}Hh(t,i){return this.o_(t,this.Co.priceFormatter,i)}e_(t,i){return this.o_(t,this.Co.percentageFormatter,i)}}class xs{constructor(t,i){this.mo=[],this.__=new Map,this.lo=0,this.u_=0,this.c_=1e3,this.bo=null,this.d_=new K,this.Cl=t,this.Ki=i,this.f_=new rs(this);const s=i.W();this.v_=this.p_("left",s.leftPriceScale),this.m_=this.p_("right",s.rightPriceScale),this.v_.zo().l(this.b_.bind(this,this.v_),this),this.m_.zo().l(this.b_.bind(this,this.m_),this),this.w_(s)}w_(t){if(t.leftPriceScale&&this.v_.qh(t.leftPriceScale),t.rightPriceScale&&this.m_.qh(t.rightPriceScale),t.localization&&(this.v_.Da(),this.m_.Da()),t.overlayPriceScales){const i=Array.from(this.__.values());for(const s of i){const i=C(s[0].At());i.qh(t.overlayPriceScales),t.localization&&i.Da()}}}g_(t){switch(t){case"left":return this.v_;case"right":return this.m_}return this.__.has(t)?x(this.__.get(t))[0].At():null}S(){this.Kt().M_().p(this),this.v_.zo().p(this),this.m_.zo().p(this),this.mo.forEach((t=>{t.S&&t.S()})),this.d_.m()}x_(){return this.c_}S_(t){this.c_=t}Kt(){return this.Ki}Xi(){return this.u_}Lt(){return this.lo}k_(t){this.u_=t,this.y_()}Eo(t){this.lo=t,this.v_.Eo(t),this.m_.Eo(t),this.mo.forEach((i=>{if(this.Mr(i)){const s=i.At();null!==s&&s.Eo(t)}})),this.y_()}Ba(){return this.mo}Mr(t){const i=t.At();return null===i||this.v_!==i&&this.m_!==i}Yo(t,i,s){const e=void 0!==s?s:this.T_().C_+1;this.P_(t,i,e)}Ko(t){const i=this.mo.indexOf(t);M(-1!==i,"removeDataSource: invalid data source"),this.mo.splice(i,1);const s=C(t.At()).Ra();if(this.__.has(s)){const i=x(this.__.get(s)),e=i.indexOf(t);-1!==e&&(i.splice(e,1),0===i.length&&this.__.delete(s))}const e=t.At();e&&e.Ba().indexOf(t)>=0&&e.Ko(t),null!==e&&(e.Xo(),this.R_(e)),this.bo=null}kr(t){return t===this.v_?"left":t===this.m_?"right":"overlay"}D_(){return this.v_}O_(){return this.m_}A_(t,i){t.Jo(i)}V_(t,i){t.Qo(i),this.y_()}B_(t){t.t_()}I_(t,i){t.i_(i)}L_(t,i){t.n_(i),this.y_()}z_(t){t.s_()}y_(){this.mo.forEach((t=>{t.In()}))}wn(){let t=null;return this.Ki.W().rightPriceScale.visible&&0!==this.m_.Ba().length?t=this.m_:this.Ki.W().leftPriceScale.visible&&0!==this.v_.Ba().length?t=this.v_:0!==this.mo.length&&(t=this.mo[0].At()),null===t&&(t=this.m_),t}Sr(){let t=null;return this.Ki.W().rightPriceScale.visible?t=this.m_:this.Ki.W().leftPriceScale.visible&&(t=this.v_),t}R_(t){null!==t&&t.Ao()&&this.E_(t)}N_(t){const i=this.Cl.Js();t.Do({Un:!0}),null!==i&&t.l_(i),this.y_()}F_(){this.E_(this.v_),this.E_(this.m_)}W_(){this.R_(this.v_),this.R_(this.m_),this.mo.forEach((t=>{this.Mr(t)&&this.R_(t.At())})),this.y_(),this.Ki.Yh()}qo(){return null===this.bo&&(this.bo=ws(this.mo)),this.bo}j_(){return this.d_}H_(){return this.f_}E_(t){const i=t.h_();if(i&&i.length>0&&!this.Cl.$i()){const i=this.Cl.Js();null!==i&&t.l_(i)}t.In()}T_(){const t=this.qo();if(0===t.length)return{U_:0,C_:0};let i=0,s=0;for(let e=0;e<t.length;e++){const h=t[e].tn();null!==h&&(h<i&&(i=h),h>s&&(s=h))}return{U_:i,C_:s}}P_(t,i,s){let e=this.g_(i);if(null===e&&(e=this.p_(i,this.Ki.W().overlayPriceScales)),this.mo.push(t),!gt(i)){const s=this.__.get(i)||[];s.push(t),this.__.set(i,s)}e.Yo(t),t.sn(e),t.nn(s),this.R_(e),this.bo=null}b_(t,i,s){i.Ar!==s.Ar&&this.E_(t)}p_(t,i){const s=Object.assign({visible:!0,autoScale:!0},j(i)),e=new Ms(t,s,this.Ki.W().layout,this.Ki.W().localization);return e.Eo(this.Lt()),e}}class Cs{constructor(t,i,s=50){this.nr=0,this.sr=1,this.er=1,this.hr=new Map,this.rr=new Map,this.q_=t,this.Y_=i,this.lr=s}X_(t){const i=t.time,s=this.Y_.cacheKey(i),e=this.hr.get(s);if(void 0!==e)return e.K_;if(this.nr===this.lr){const t=this.rr.get(this.er);this.rr.delete(this.er),this.hr.delete(x(t)),this.er++,this.nr--}const h=this.q_(t);return this.hr.set(s,{K_:h,cr:this.sr}),this.rr.set(this.sr,s),this.nr++,this.sr++,h}}class Es{constructor(t,i){M(t<=i,"right should be >= left"),this.Z_=t,this.G_=i}Is(){return this.Z_}mi(){return this.G_}J_(){return this.G_-this.Z_+1}nh(t){return this.Z_<=t&&t<=this.G_}Ph(t){return this.Z_===t.Is()&&this.G_===t.mi()}}function Ts(t,i){return null===t||null===i?t===i:t.Ph(i)}class zs{constructor(){this.Q_=new Map,this.hr=null,this.tu=!1}iu(t){this.tu=t,this.hr=null}nu(t,i){this.su(i),this.hr=null;for(let s=i;s<t.length;++s){const i=t[s];let e=this.Q_.get(i.timeWeight);void 0===e&&(e=[],this.Q_.set(i.timeWeight,e)),e.push({index:s,time:i.time,weight:i.timeWeight,originalTime:i.originalTime})}}eu(t,i){const s=Math.ceil(i/t);return null!==this.hr&&this.hr.ru===s||(this.hr={$a:this.hu(s),ru:s}),this.hr.$a}su(t){if(0===t)return void this.Q_.clear();const i=[];this.Q_.forEach(((s,e)=>{t<=s[0].index?i.push(e):s.splice(At(s,t,(i=>i.index<t)),1/0)}));for(const s of i)this.Q_.delete(s)}hu(t){let i=[];for(const s of Array.from(this.Q_.keys()).sort(((t,i)=>i-t))){if(!this.Q_.get(s))continue;const e=i;i=[];const h=e.length;let n=0;const r=x(this.Q_.get(s)),o=r.length;let l=1/0,a=-1/0;for(let s=0;s<o;s++){const o=r[s],u=o.index;for(;n<h;){const t=e[n],s=t.index;if(!(s<u)){l=s;break}n++,i.push(t),a=s,l=1/0}if(l-u>=t&&u-a>=t)i.push(o),a=u;else if(this.tu)return e}for(;n<h;n++)i.push(e[n])}return i}}class ks{constructor(t){this.lu=t}au(){return null===this.lu?null:new Es(Math.floor(this.lu.Is()),Math.ceil(this.lu.mi()))}ou(){return this.lu}static _u(){return new ks(null)}}function Ws(t,i){return t.weight>i.weight?t:i}class Rs{constructor(t,i,s,e){this.u_=0,this.uu=null,this.cu=[],this.xo=null,this.Mo=null,this.du=new zs,this.fu=new Map,this.vu=ks._u(),this.pu=!0,this.mu=new K,this.bu=new K,this.wu=new K,this.gu=null,this.Mu=null,this.xu=[],this.pn=i,this.Co=s,this.Su=i.rightOffset,this.ku=i.barSpacing,this.Ki=t,this.Y_=e,this.yu(),this.du.iu(i.uniformDistribution)}W(){return this.pn}Cu(t){D(this.Co,t),this.Tu(),this.yu()}qh(t,i){var s;D(this.pn,t),this.pn.fixLeftEdge&&this.Pu(),this.pn.fixRightEdge&&this.Ru(),void 0!==t.barSpacing&&this.Ki.ns(t.barSpacing),void 0!==t.rightOffset&&this.Ki.ss(t.rightOffset),void 0!==t.minBarSpacing&&this.Ki.ns(null!==(s=t.barSpacing)&&void 0!==s?s:this.ku),this.Tu(),this.yu(),this.wu.m()}Mn(t){var i,s;return null!==(s=null===(i=this.cu[t])||void 0===i?void 0:i.time)&&void 0!==s?s:null}Zi(t){var i;return null!==(i=this.cu[t])&&void 0!==i?i:null}Aa(t,i){if(this.cu.length<1)return null;if(this.Y_.key(t)>this.Y_.key(this.cu[this.cu.length-1].time))return i?this.cu.length-1:null;const s=At(this.cu,this.Y_.key(t),((t,i)=>this.Y_.key(t.time)<i));return this.Y_.key(t)<this.Y_.key(this.cu[s].time)?i?s:null:s}$i(){return 0===this.u_||0===this.cu.length||null===this.uu}Oa(){return this.cu.length>0}Js(){return this.Du(),this.vu.au()}Ou(){return this.Du(),this.vu.ou()}Au(){const t=this.Js();if(null===t)return null;const i={from:t.Is(),to:t.mi()};return this.Vu(i)}Vu(t){const i=Math.round(t.from),s=Math.round(t.to),e=C(this.Bu()),h=C(this.En());return{from:C(this.Zi(Math.max(e,i))),to:C(this.Zi(Math.min(h,s)))}}Iu(t){return{from:C(this.Aa(t.from,!0)),to:C(this.Aa(t.to,!0))}}Xi(){return this.u_}k_(t){if(!isFinite(t)||t<=0)return;if(this.u_===t)return;const i=this.Ou(),s=this.u_;if(this.u_=t,this.pu=!0,this.pn.lockVisibleTimeRangeOnResize&&0!==s){const i=this.ku*t/s;this.ku=i}if(this.pn.fixLeftEdge&&null!==i&&i.Is()<=0){const i=s-t;this.Su-=Math.round(i/this.ku)+1,this.pu=!0}this.Lu(),this.zu()}zt(t){if(this.$i()||!B(t))return 0;const i=this.Eu()+this.Su-t;return this.u_-(i+.5)*this.ku-1}ne(t,i){const s=this.Eu(),e=void 0===i?0:i.from,h=void 0===i?t.length:i.to;for(let n=e;n<h;n++){const i=t[n].ut,e=s+this.Su-i,h=this.u_-(e+.5)*this.ku-1;t[n].et=h}}Nu(t){return Math.ceil(this.Fu(t))}ss(t){this.pu=!0,this.Su=t,this.zu(),this.Ki.Wu(),this.Ki.Yh()}_e(){return this.ku}ns(t){this.ju(t),this.zu(),this.Ki.Wu(),this.Ki.Yh()}Hu(){return this.Su}$a(){if(this.$i())return null;if(null!==this.Mu)return this.Mu;const t=this.ku,i=5*(this.Ki.W().layout.fontSize+4)/8*(this.pn.tickMarkMaxCharacterLength||8),s=Math.round(i/t),e=C(this.Js()),h=Math.max(e.Is(),e.Is()-s),n=Math.max(e.mi(),e.mi()-s),r=this.du.eu(t,i),o=this.Bu()+s,l=this.En()-s,a=this.$u(),u=this.pn.fixLeftEdge||a,c=this.pn.fixRightEdge||a;let d=0;for(const f of r){if(!(h<=f.index&&f.index<=n))continue;let t;d<this.xu.length?(t=this.xu[d],t.coord=this.zt(f.index),t.label=this.Uu(f),t.weight=f.weight):(t={needAlignCoordinate:!1,coord:this.zt(f.index),label:this.Uu(f),weight:f.weight},this.xu.push(t)),this.ku>i/2&&!a?t.needAlignCoordinate=!1:t.needAlignCoordinate=u&&f.index<=o||c&&f.index>=l,d++}return this.xu.length=d,this.Mu=this.xu,this.xu}qu(){this.pu=!0,this.ns(this.pn.barSpacing),this.ss(this.pn.rightOffset)}Yu(t){this.pu=!0,this.uu=t,this.zu(),this.Pu()}Xu(t,i){const s=this.Fu(t),e=this._e(),h=e+i*(e/10);this.ns(h),this.pn.rightBarStaysOnScroll||this.ss(this.Hu()+(s-this.Fu(t)))}Jo(t){this.xo&&this.s_(),null===this.Mo&&null===this.gu&&(this.$i()||(this.Mo=t,this.Ku()))}Qo(t){if(null===this.gu)return;const i=Rt(this.u_-t,0,this.u_),s=Rt(this.u_-C(this.Mo),0,this.u_);0!==i&&0!==s&&this.ns(this.gu._e*i/s)}t_(){null!==this.Mo&&(this.Mo=null,this.Zu())}i_(t){null===this.xo&&null===this.gu&&(this.$i()||(this.xo=t,this.Ku()))}n_(t){if(null===this.xo)return;const i=(this.xo-t)/this._e();this.Su=C(this.gu).Hu+i,this.pu=!0,this.zu()}s_(){null!==this.xo&&(this.xo=null,this.Zu())}Gu(){this.Ju(this.pn.rightOffset)}Ju(t,i=400){if(!isFinite(t))throw new RangeError("offset is required and must be finite number");if(!isFinite(i)||i<=0)throw new RangeError("animationDuration (optional) must be finite positive number");const s=this.Su,e=performance.now();this.Ki.Jn({Qu:t=>(t-e)/i>=1,tc:h=>{const n=(h-e)/i;return n>=1?t:s+(t-s)*n}})}gt(t,i){this.pu=!0,this.cu=t,this.du.nu(t,i),this.zu()}ic(){return this.mu}nc(){return this.bu}sc(){return this.wu}Eu(){return this.uu||0}ec(t){const i=t.J_();this.ju(this.u_/i),this.Su=t.mi()-this.Eu(),this.zu(),this.pu=!0,this.Ki.Wu(),this.Ki.Yh()}rc(){const t=this.Bu(),i=this.En();null!==t&&null!==i&&this.ec(new Es(t,i+this.pn.rightOffset))}hc(t){const i=new Es(t.from,t.to);this.ec(i)}Gi(t){return void 0!==this.Co.timeFormatter?this.Co.timeFormatter(t.originalTime):this.Y_.formatHorzItem(t.time)}En(){return 0===this.cu.length?null:this.cu.length-1}$u(){const{handleScroll:t,handleScale:i}=this.Ki.W();return!(t.horzTouchDrag||t.mouseWheel||t.pressedMouseMove||t.vertTouchDrag||i.axisDoubleClickReset.time||i.axisPressedMouseMove.time||i.mouseWheel||i.pinch)}Bu(){return 0===this.cu.length?null:0}lc(t){return(this.u_-1-t)/this.ku}Fu(t){const i=this.lc(t),s=this.Eu()+this.Su-i;return Math.round(1e6*s)/1e6}ju(t){const i=this.ku;this.ku=t,this.Lu(),i!==this.ku&&(this.pu=!0,this.ac())}Du(){if(!this.pu)return;if(this.pu=!1,this.$i())return void this.oc(ks._u());const t=this.Eu(),i=this.u_/this.ku,s=this.Su+t,e=new Es(s-i+1,s);this.oc(new ks(e))}Lu(){const t=this._c();if(this.ku<t&&(this.ku=t,this.pu=!0),0!==this.u_){const t=.5*this.u_;this.ku>t&&(this.ku=t,this.pu=!0)}}_c(){return this.pn.fixLeftEdge&&this.pn.fixRightEdge&&0!==this.cu.length?this.u_/this.cu.length:this.pn.minBarSpacing}zu(){const t=this.uc();this.Su>t&&(this.Su=t,this.pu=!0);const i=this.cc();null!==i&&this.Su<i&&(this.Su=i,this.pu=!0)}cc(){const t=this.Bu(),i=this.uu;return null===t||null===i?null:t-i-1+(this.pn.fixLeftEdge?this.u_/this.ku:Math.min(2,this.cu.length))}uc(){return this.pn.fixRightEdge?0:this.u_/this.ku-Math.min(2,this.cu.length)}Ku(){this.gu={_e:this._e(),Hu:this.Hu()}}Zu(){this.gu=null}Uu(t){let i=this.fu.get(t.weight);return void 0===i&&(i=new Cs((t=>this.dc(t)),this.Y_),this.fu.set(t.weight,i)),i.X_(t)}dc(t){return this.Y_.formatTickmark(t,this.Co)}oc(t){const i=this.vu;this.vu=t,Ts(i.au(),this.vu.au())||this.mu.m(),Ts(i.ou(),this.vu.ou())||this.bu.m(),this.ac()}ac(){this.Mu=null}Tu(){this.ac(),this.fu.clear()}yu(){this.Y_.updateFormatter(this.Co)}Pu(){if(!this.pn.fixLeftEdge)return;const t=this.Bu();if(null===t)return;const i=this.Js();if(null===i)return;const s=i.Is()-t;if(s<0){const t=this.Su-s-1;this.ss(t)}this.Lu()}Ru(){this.zu(),this.Lu()}}class Os extends Z{constructor(t){super(),this.fc=new Map,this.Et=t}Z(t){}J(t){if(!this.Et.Tt)return;const{context:i,mediaSize:s}=t;let e=0;for(const n of this.Et.vc){if(0===n.ii.length)continue;i.font=n.R;const t=this.mc(i,n.ii);t>s.width?n.Xu=s.width/t:n.Xu=1,e+=n.bc*n.Xu}let h=0;switch(this.Et.wc){case"top":h=0;break;case"center":h=Math.max((s.height-e)/2,0);break;case"bottom":h=Math.max(s.height-e,0)}i.fillStyle=this.Et.O;for(const n of this.Et.vc){i.save();let t=0;switch(this.Et.gc){case"left":i.textAlign="left",t=n.bc/2;break;case"center":i.textAlign="center",t=s.width/2;break;case"right":i.textAlign="right",t=s.width-1-n.bc/2}i.translate(t,h),i.textBaseline="top",i.font=n.R,i.scale(n.Xu,n.Xu),i.fillText(n.ii,0,n.Mc),i.restore(),h+=n.bc*n.Xu}}mc(t,i){const s=this.xc(t.font);let e=s.get(i);return void 0===e&&(e=t.measureText(i).width,s.set(i,e)),e}xc(t){let i=this.fc.get(t);return void 0===i&&(i=new Map,this.fc.set(t,i)),i}}class Ps{constructor(t){this.bt=!0,this.Ut={Tt:!1,O:"",vc:[],wc:"center",gc:"center"},this.qt=new Os(this.Ut),this.Yt=t}gt(){this.bt=!0}xt(){return this.bt&&(this.St(),this.bt=!1),this.qt}St(){const t=this.Yt.W(),i=this.Ut;i.Tt=t.visible,i.Tt&&(i.O=t.color,i.gc=t.horzAlign,i.wc=t.vertAlign,i.vc=[{ii:t.text,R:X(t.fontSize,t.fontFamily,t.fontStyle),bc:1.2*t.fontSize,Mc:0,Xu:0}])}}class Ls extends mt{constructor(t,i){super(),this.pn=i,this.Sn=new Ps(this)}Vn(){return[]}An(){return[this.Sn]}W(){return this.pn}In(){this.Sn.gt()}}var Ns,Ks,Ds,Vs,Bs;!function(t){t[t.OnTouchEnd=0]="OnTouchEnd",t[t.OnNextTap=1]="OnNextTap"}(Ns||(Ns={}));class As{constructor(t,i,s){this.Sc=[],this.kc=[],this.u_=0,this.yc=null,this.Cc=new K,this.Tc=new K,this.Pc=null,this.Rc=t,this.pn=i,this.Y_=s,this.Dc=new U(this),this.Cl=new Rs(this,i.timeScale,this.pn.localization,s),this.wt=new bt(this,i.crosshair),this.Oc=new es(i.crosshair),this.Ac=new Ls(this,i.watermark),this.Vc(),this.Sc[0].S_(2e3),this.Bc=this.Ic(0),this.Lc=this.Ic(1)}Gl(){this.zc(wt.os())}Yh(){this.zc(wt.ls())}_a(){this.zc(new wt(1))}Jl(t){const i=this.Ec(t);this.zc(i)}Nc(){return this.yc}Fc(t){const i=this.yc;this.yc=t,null!==i&&this.Jl(i.Wc),null!==t&&this.Jl(t.Wc)}W(){return this.pn}qh(t){D(this.pn,t),this.Sc.forEach((i=>i.w_(t))),void 0!==t.timeScale&&this.Cl.qh(t.timeScale),void 0!==t.localization&&this.Cl.Cu(t.localization),(t.leftPriceScale||t.rightPriceScale)&&this.Cc.m(),this.Bc=this.Ic(0),this.Lc=this.Ic(1),this.Gl()}jc(t,i){if("left"===t)return void this.qh({leftPriceScale:i});if("right"===t)return void this.qh({rightPriceScale:i});const s=this.Hc(t);null!==s&&(s.At.qh(i),this.Cc.m())}Hc(t){for(const i of this.Sc){const s=i.g_(t);if(null!==s)return{Xt:i,At:s}}return null}yt(){return this.Cl}$c(){return this.Sc}Uc(){return this.Ac}qc(){return this.wt}Yc(){return this.Tc}Xc(t,i){t.Eo(i),this.Wu()}k_(t){this.u_=t,this.Cl.k_(this.u_),this.Sc.forEach((i=>i.k_(t))),this.Wu()}Vc(t){const i=new xs(this.Cl,this);void 0!==t?this.Sc.splice(t,0,i):this.Sc.push(i);const s=void 0===t?this.Sc.length-1:t,e=wt.os();return e.Hn(s,{$n:0,Un:!0}),this.zc(e),i}A_(t,i,s){t.A_(i,s)}V_(t,i,s){t.V_(i,s),this.Ql(),this.zc(this.Kc(t,2))}B_(t,i){t.B_(i),this.zc(this.Kc(t,2))}I_(t,i,s){i.Ao()||t.I_(i,s)}L_(t,i,s){i.Ao()||(t.L_(i,s),this.Ql(),this.zc(this.Kc(t,2)))}z_(t,i){i.Ao()||(t.z_(i),this.zc(this.Kc(t,2)))}N_(t,i){t.N_(i),this.zc(this.Kc(t,2))}Zc(t){this.Cl.Jo(t)}Gc(t,i){const s=this.yt();if(s.$i()||0===i)return;const e=s.Xi();t=Math.max(1,Math.min(t,e)),s.Xu(t,i),this.Wu()}Jc(t){this.Qc(0),this.td(t),this.nd()}sd(t){this.Cl.Qo(t),this.Wu()}ed(){this.Cl.t_(),this.Yh()}Qc(t){this.Cl.i_(t)}td(t){this.Cl.n_(t),this.Wu()}nd(){this.Cl.s_(),this.Yh()}Mt(){return this.kc}rd(t,i,s,e,h){this.wt.kn(t,i);let n=NaN,r=this.Cl.Nu(t);const o=this.Cl.Js();null!==o&&(r=Math.min(Math.max(o.Is(),r),o.mi()));const l=e.wn(),a=l.Pt();null!==a&&(n=l.gn(i,a)),n=this.Oc.Va(n,r,e),this.wt.Pn(r,n,e),this._a(),h||this.Tc.m(this.wt.kt(),{x:t,y:i},s)}hd(t,i,s){const e=s.wn(),h=e.Pt(),n=e.Ot(t,C(h)),r=this.Cl.Aa(i,!0),o=this.Cl.zt(C(r));this.rd(o,n,null,s,!0)}ld(t){this.qc().Dn(),this._a(),t||this.Tc.m(null,null,null)}Ql(){const t=this.wt.Xt();if(null!==t){const i=this.wt.Cn(),s=this.wt.Tn();this.rd(i,s,null,t)}this.wt.In()}ad(t,i,s){const e=this.Cl.Mn(0),h=this.Cl.En();void 0!==i&&void 0!==s&&this.Cl.gt(i,s);const n=this.Cl.Mn(0),r=this.Cl.Eu(),o=this.Cl.Js();if(null!==o&&null!==e&&null!==n){const i=o.nh(r),s=this.Y_.key(e)>this.Y_.key(n),l=null!==t&&t>r&&!s,a=this.Cl.En(),u=i&&!(a===h)&&this.Cl.W().shiftVisibleRangeOnNewBar;if(l&&!u){const i=t-r;this.Cl.ss(this.Cl.Hu()-i)}}this.Cl.Yu(t)}na(t){null!==t&&t.W_()}gr(t){const i=this.Sc.find((i=>i.qo().includes(t)));return void 0===i?null:i}Wu(){this.Ac.In(),this.Sc.forEach((t=>t.W_())),this.Ql()}S(){this.Sc.forEach((t=>t.S())),this.Sc.length=0,this.pn.localization.priceFormatter=void 0,this.pn.localization.percentageFormatter=void 0,this.pn.localization.timeFormatter=void 0}od(){return this.Dc}yr(){return this.Dc.W()}M_(){return this.Cc}_d(t,i,s){const e=this.Sc[0],h=this.ud(i,t,e,s);return this.kc.push(h),1===this.kc.length?this.Gl():this.Yh(),h}dd(t){const i=this.gr(t),s=this.kc.indexOf(t);M(-1!==s,"Series not found"),this.kc.splice(s,1),C(i).Ko(t),t.S&&t.S()}Zl(t,i){const s=C(this.gr(t));s.Ko(t);const e=this.Hc(i);if(null===e){const e=t.tn();s.Yo(t,i,e)}else{const h=e.Xt===s?t.tn():void 0;e.Xt.Yo(t,i,h)}}rc(){const t=wt.ls();t.Xn(),this.zc(t)}fd(t){const i=wt.ls();i.Gn(t),this.zc(i)}ts(){const t=wt.ls();t.ts(),this.zc(t)}ns(t){const i=wt.ls();i.ns(t),this.zc(i)}ss(t){const i=wt.ls();i.ss(t),this.zc(i)}Jn(t){const i=wt.ls();i.Jn(t),this.zc(i)}Kn(){const t=wt.ls();t.Kn(),this.zc(t)}vd(){return this.pn.rightPriceScale.visible?"right":"left"}pd(){return this.Lc}q(){return this.Bc}It(t){const i=this.Lc,s=this.Bc;if(i===s)return i;if(t=Math.max(0,Math.min(100,Math.round(100*t))),null===this.Pc||this.Pc.Os!==s||this.Pc.As!==i)this.Pc={Os:s,As:i,md:new Map};else{const i=this.Pc.md.get(t);if(void 0!==i)return i}const e=function(t,i,s){const[e,h,n,r]=L(t),[o,l,a,u]=L(i),c=[z(e+s*(o-e)),z(h+s*(l-h)),z(n+s*(a-n)),k(r+s*(u-r))];return`rgba(${c[0]}, ${c[1]}, ${c[2]}, ${c[3]})`}(s,i,t/100);return this.Pc.md.set(t,e),e}Kc(t,i){const s=new wt(i);if(null!==t){const e=this.Sc.indexOf(t);s.Hn(e,{$n:i})}return s}Ec(t,i){return void 0===i&&(i=2),this.Kc(this.gr(t),i)}zc(t){this.Rc&&this.Rc(t),this.Sc.forEach((t=>t.H_().Xh().gt()))}ud(t,i,s,e){const h=new ss(this,t,i,s,e),n=void 0!==t.priceScaleId?t.priceScaleId:this.vd();return s.Yo(h,n),gt(n)||h.qh(t),h}Ic(t){const i=this.pn.layout;return"gradient"===i.background.type?0===t?i.background.topColor:i.background.bottomColor:i.background.color}}function Is(t){return!V(t)&&!A(t)}function js(t){return V(t)}!function(t){t[t.Disabled=0]="Disabled",t[t.Continuous=1]="Continuous",t[t.OnDataUpdate=2]="OnDataUpdate"}(Ks||(Ks={})),function(t){t[t.LastBar=0]="LastBar",t[t.LastVisible=1]="LastVisible"}(Ds||(Ds={})),function(t){t.Solid="solid",t.VerticalGradient="gradient"}(Vs||(Vs={})),function(t){t[t.Year=0]="Year",t[t.Month=1]="Month",t[t.DayOfMonth=2]="DayOfMonth",t[t.Time=3]="Time",t[t.TimeWithSeconds=4]="TimeWithSeconds"}(Bs||(Bs={}));const Ys=t=>t.getUTCFullYear();class Fs{constructor(t="yyyy-MM-dd",i="default"){this.bd=t,this.wd=i}X_(t){return function(t,i,s){return i.replace(/yyyy/g,(t=>yt(Ys(t),4))(t)).replace(/yy/g,(t=>yt(Ys(t)%100,2))(t)).replace(/MMMM/g,((t,i)=>new Date(t.getUTCFullYear(),t.getUTCMonth(),1).toLocaleString(i,{month:"long"}))(t,s)).replace(/MMM/g,((t,i)=>new Date(t.getUTCFullYear(),t.getUTCMonth(),1).toLocaleString(i,{month:"short"}))(t,s)).replace(/MM/g,(t=>yt((t=>t.getUTCMonth()+1)(t),2))(t)).replace(/dd/g,(t=>yt((t=>t.getUTCDate())(t),2))(t))}(t,this.bd,this.wd)}}class $s{constructor(t){this.gd=t||"%h:%m:%s"}X_(t){return this.gd.replace("%h",yt(t.getUTCHours(),2)).replace("%m",yt(t.getUTCMinutes(),2)).replace("%s",yt(t.getUTCSeconds(),2))}}const Xs={Md:"yyyy-MM-dd",xd:"%h:%m:%s",Sd:" ",kd:"default"};class Us{constructor(t={}){const i=Object.assign(Object.assign({},Xs),t);this.yd=new Fs(i.Md,i.kd),this.Cd=new $s(i.xd),this.Td=i.Sd}X_(t){return`${this.yd.X_(t)}${this.Td}${this.Cd.X_(t)}`}}function qs(t){return 60*t*60*1e3}function Zs(t){return 60*t*1e3}const Qs=[{Pd:(1,1e3),Rd:10},{Pd:Zs(1),Rd:20},{Pd:Zs(5),Rd:21},{Pd:Zs(30),Rd:22},{Pd:qs(1),Rd:30},{Pd:qs(3),Rd:31},{Pd:qs(6),Rd:32},{Pd:qs(12),Rd:33}];function Hs(t,i){if(t.getUTCFullYear()!==i.getUTCFullYear())return 70;if(t.getUTCMonth()!==i.getUTCMonth())return 60;if(t.getUTCDate()!==i.getUTCDate())return 50;for(let s=Qs.length-1;s>=0;--s)if(Math.floor(i.getTime()/Qs[s].Pd)!==Math.floor(t.getTime()/Qs[s].Pd))return Qs[s].Rd;return 0}function Gs(t){let i=t;if(A(t)&&(i=te(t)),!Is(i))throw new Error("time must be of type BusinessDay");const s=new Date(Date.UTC(i.year,i.month-1,i.day,0,0,0,0));return{Dd:Math.round(s.getTime()/1e3),Od:i}}function Js(t){if(!js(t))throw new Error("time must be of type isUTCTimestamp");return{Dd:t}}function te(t){const i=new Date(t);if(isNaN(i.getTime()))throw new Error(`Invalid date string=${t}, expected format=yyyy-mm-dd`);return{day:i.getUTCDate(),month:i.getUTCMonth()+1,year:i.getUTCFullYear()}}function ie(t){A(t.time)&&(t.time=te(t.time))}class se{options(){return this.pn}setOptions(t){this.pn=t,this.updateFormatter(t.localization)}preprocessData(t){Array.isArray(t)?function(t){t.forEach(ie)}(t):ie(t)}createConverterToInternalObj(t){return C(function(t){return 0===t.length?null:Is(t[0].time)||A(t[0].time)?Gs:Js}(t))}key(t){return"object"==typeof t&&"Dd"in t?t.Dd:this.key(this.convertHorzItemToInternal(t))}cacheKey(t){const i=t;return void 0===i.Od?new Date(1e3*i.Dd).getTime():new Date(Date.UTC(i.Od.year,i.Od.month-1,i.Od.day)).getTime()}convertHorzItemToInternal(t){return js(i=t)?Js(i):Is(i)?Gs(i):Gs(te(i));var i}updateFormatter(t){if(!this.pn)return;const i=t.dateFormat;this.pn.timeScale.timeVisible?this.Ad=new Us({Md:i,xd:this.pn.timeScale.secondsVisible?"%h:%m:%s":"%h:%m",Sd:"   ",kd:t.locale}):this.Ad=new Fs(i,t.locale)}formatHorzItem(t){const i=t;return this.Ad.X_(new Date(1e3*i.Dd))}formatTickmark(t,i){const s=function(t,i,s){switch(t){case 0:case 10:return i?s?4:3:2;case 20:case 21:case 22:case 30:case 31:case 32:case 33:return i?3:2;case 50:return 2;case 60:return 1;case 70:return 0}}(t.weight,this.pn.timeScale.timeVisible,this.pn.timeScale.secondsVisible),e=this.pn.timeScale;if(void 0!==e.tickMarkFormatter){const h=e.tickMarkFormatter(t.originalTime,s,i.locale);if(null!==h)return h}return function(t,i,s){const e={};switch(i){case 0:e.year="numeric";break;case 1:e.month="short";break;case 2:e.day="numeric";break;case 3:e.hour12=!1,e.hour="2-digit",e.minute="2-digit";break;case 4:e.hour12=!1,e.hour="2-digit",e.minute="2-digit",e.second="2-digit"}const h=void 0===t.Od?new Date(1e3*t.Dd):new Date(Date.UTC(t.Od.year,t.Od.month-1,t.Od.day));return new Date(h.getUTCFullYear(),h.getUTCMonth(),h.getUTCDate(),h.getUTCHours(),h.getUTCMinutes(),h.getUTCSeconds(),h.getUTCMilliseconds()).toLocaleString(s,e)}(t.time,s,i.locale)}maxTickMarkWeight(t){let i=t.reduce(Ws,t[0]).weight;return i>30&&i<50&&(i=30),i}fillWeightsForPoints(t,i){!function(t,i=0){if(0===t.length)return;let s=0===i?null:t[i-1].time.Dd,e=null!==s?new Date(1e3*s):null,h=0;for(let n=i;n<t.length;++n){const i=t[n],r=new Date(1e3*i.time.Dd);null!==e&&(i.timeWeight=Hs(r,e)),h+=i.time.Dd-(s||i.time.Dd),s=i.time.Dd,e=r}if(0===i&&t.length>1){const i=Math.ceil(h/(t.length-1)),s=new Date(1e3*(t[0].time.Dd-i));t[0].timeWeight=Hs(new Date(1e3*t[0].time.Dd),s)}}(t,i)}static Vd(t){return D({localization:{dateFormat:"dd MMM 'yy"}},null!=t?t:{})}}const ee="undefined"!=typeof window;function he(){return!!ee&&window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1}function ne(){return!!ee&&/iPhone|iPad|iPod/.test(window.navigator.platform)}function re(t){return t+t%2}function oe(t,i){return t.Bd-i.Bd}function le(t,i,s){const e=(t.Bd-i.Bd)/(t.ut-i.ut);return Math.sign(e)*Math.min(Math.abs(e),s)}class ae{constructor(t,i,s,e){this.Id=null,this.Ld=null,this.zd=null,this.Ed=null,this.Nd=null,this.Fd=0,this.Wd=0,this.jd=t,this.Hd=i,this.$d=s,this._s=e}Ud(t,i){if(null!==this.Id){if(this.Id.ut===i)return void(this.Id.Bd=t);if(Math.abs(this.Id.Bd-t)<this._s)return}this.Ed=this.zd,this.zd=this.Ld,this.Ld=this.Id,this.Id={ut:i,Bd:t}}zr(t,i){if(null===this.Id||null===this.Ld)return;if(i-this.Id.ut>50)return;let s=0;const e=le(this.Id,this.Ld,this.Hd),h=oe(this.Id,this.Ld),n=[e],r=[h];if(s+=h,null!==this.zd){const t=le(this.Ld,this.zd,this.Hd);if(Math.sign(t)===Math.sign(e)){const i=oe(this.Ld,this.zd);if(n.push(t),r.push(i),s+=i,null!==this.Ed){const t=le(this.zd,this.Ed,this.Hd);if(Math.sign(t)===Math.sign(e)){const i=oe(this.zd,this.Ed);n.push(t),r.push(i),s+=i}}}}let o=0;for(let l=0;l<n.length;++l)o+=r[l]/s*n[l];Math.abs(o)<this.jd||(this.Nd={Bd:t,ut:i},this.Wd=o,this.Fd=function(t,i){const s=Math.log(i);return Math.log(1*s/-t)/s}(Math.abs(o),this.$d))}tc(t){const i=C(this.Nd),s=t-i.ut;return i.Bd+this.Wd*(Math.pow(this.$d,s)-1)/Math.log(this.$d)}Qu(t){return null===this.Nd||this.qd(t)===this.Fd}qd(t){const i=t-C(this.Nd).ut;return Math.min(i,this.Fd)}}function ue(t,i){const s=C(t.ownerDocument).createElement("canvas");t.appendChild(s);const e=function(t,i){if("device-pixel-content-box"===i.type)return new r(t,i.transform,i.options);throw new Error("Unsupported binding target")}(s,{type:"device-pixel-content-box",options:{allowResizeObserver:!1},transform:(t,i)=>({width:Math.max(t.width,i.width),height:Math.max(t.height,i.height)})});return e.resizeCanvasElement(i),e}function ce(t,i,s,e){t.G&&t.G(i,s,e)}function de(t,i,s,e){t.K(i,s,e)}function fe(t,i,s,e){const h=t(s,e);for(const n of h){const t=n.xt();null!==t&&i(t)}}class pe{constructor(t,i,s){this.Yd=0,this.Xd=null,this.Kd={et:Number.NEGATIVE_INFINITY,rt:Number.POSITIVE_INFINITY},this.Zd=0,this.Gd=null,this.Jd={et:Number.NEGATIVE_INFINITY,rt:Number.POSITIVE_INFINITY},this.Qd=null,this.tf=!1,this.if=null,this.nf=null,this.sf=!1,this.ef=!1,this.rf=!1,this.hf=null,this.lf=null,this.af=null,this._f=null,this.uf=null,this.cf=null,this.df=null,this.ff=0,this.vf=!1,this.pf=!1,this.mf=!1,this.bf=0,this.wf=null,this.gf=!ne(),this.Mf=t=>{this.xf(t)},this.Sf=t=>{if(this.kf(t)){const i=this.yf(t);if(++this.Zd,this.Gd&&this.Zd>1){const{Cf:s}=this.Tf(be(t),this.Jd);s<30&&!this.rf&&this.Pf(i,this.Df.Rf),this.Of()}}else{const i=this.yf(t);if(++this.Yd,this.Xd&&this.Yd>1){const{Cf:s}=this.Tf(be(t),this.Kd);s<5&&!this.ef&&this.Af(i,this.Df.Vf),this.Bf()}}},this.If=t,this.Df=i,this.pn=s,this.Lf()}S(){null!==this.hf&&(this.hf(),this.hf=null),null!==this.lf&&(this.lf(),this.lf=null),null!==this._f&&(this._f(),this._f=null),null!==this.uf&&(this.uf(),this.uf=null),null!==this.cf&&(this.cf(),this.cf=null),null!==this.af&&(this.af(),this.af=null),this.zf(),this.Bf()}Ef(t){this._f&&this._f();const i=this.Nf.bind(this);if(this._f=()=>{this.If.removeEventListener("mousemove",i)},this.If.addEventListener("mousemove",i),this.kf(t))return;const s=this.yf(t);this.Af(s,this.Df.Ff),this.gf=!0}Bf(){null!==this.Xd&&clearTimeout(this.Xd),this.Yd=0,this.Xd=null,this.Kd={et:Number.NEGATIVE_INFINITY,rt:Number.POSITIVE_INFINITY}}Of(){null!==this.Gd&&clearTimeout(this.Gd),this.Zd=0,this.Gd=null,this.Jd={et:Number.NEGATIVE_INFINITY,rt:Number.POSITIVE_INFINITY}}Nf(t){if(this.mf||null!==this.nf)return;if(this.kf(t))return;const i=this.yf(t);this.Af(i,this.Df.Wf),this.gf=!0}jf(t){const i=we(t.changedTouches,C(this.wf));if(null===i)return;if(this.bf=ge(t),null!==this.df)return;if(this.pf)return;this.vf=!0;const s=this.Tf(be(i),C(this.nf)),{Hf:e,$f:h,Cf:n}=s;if(this.sf||!(n<5)){if(!this.sf){const t=.5*e,i=h>=t&&!this.pn.Uf(),s=t>h&&!this.pn.qf();i||s||(this.pf=!0),this.sf=!0,this.rf=!0,this.zf(),this.Of()}if(!this.pf){const s=this.yf(t,i);this.Pf(s,this.Df.Yf),ve(t)}}}Xf(t){if(0!==t.button)return;const i=this.Tf(be(t),C(this.if)),{Cf:s}=i;if(s>=5&&(this.ef=!0,this.Bf()),this.ef){const i=this.yf(t);this.Af(i,this.Df.Kf)}}Tf(t,i){const s=Math.abs(i.et-t.et),e=Math.abs(i.rt-t.rt);return{Hf:s,$f:e,Cf:s+e}}Zf(t){let i=we(t.changedTouches,C(this.wf));if(null===i&&0===t.touches.length&&(i=t.changedTouches[0]),null===i)return;this.wf=null,this.bf=ge(t),this.zf(),this.nf=null,this.cf&&(this.cf(),this.cf=null);const s=this.yf(t,i);if(this.Pf(s,this.Df.Gf),++this.Zd,this.Gd&&this.Zd>1){const{Cf:t}=this.Tf(be(i),this.Jd);t<30&&!this.rf&&this.Pf(s,this.Df.Rf),this.Of()}else this.rf||(this.Pf(s,this.Df.Jf),this.Df.Jf&&ve(t));0===this.Zd&&ve(t),0===t.touches.length&&this.tf&&(this.tf=!1,ve(t))}xf(t){if(0!==t.button)return;const i=this.yf(t);if(this.if=null,this.mf=!1,this.uf&&(this.uf(),this.uf=null),he()&&this.If.ownerDocument.documentElement.removeEventListener("mouseleave",this.Mf),!this.kf(t))if(this.Af(i,this.Df.Qf),++this.Yd,this.Xd&&this.Yd>1){const{Cf:s}=this.Tf(be(t),this.Kd);s<5&&!this.ef&&this.Af(i,this.Df.Vf),this.Bf()}else this.ef||this.Af(i,this.Df.tv)}zf(){null!==this.Qd&&(clearTimeout(this.Qd),this.Qd=null)}iv(t){if(null!==this.wf)return;const i=t.changedTouches[0];this.wf=i.identifier,this.bf=ge(t);const s=this.If.ownerDocument.documentElement;this.rf=!1,this.sf=!1,this.pf=!1,this.nf=be(i),this.cf&&(this.cf(),this.cf=null);{const i=this.jf.bind(this),e=this.Zf.bind(this);this.cf=()=>{s.removeEventListener("touchmove",i),s.removeEventListener("touchend",e)},s.addEventListener("touchmove",i,{passive:!1}),s.addEventListener("touchend",e,{passive:!1}),this.zf(),this.Qd=setTimeout(this.nv.bind(this,t),240)}const e=this.yf(t,i);this.Pf(e,this.Df.sv),this.Gd||(this.Zd=0,this.Gd=setTimeout(this.Of.bind(this),500),this.Jd=be(i))}ev(t){if(0!==t.button)return;const i=this.If.ownerDocument.documentElement;he()&&i.addEventListener("mouseleave",this.Mf),this.ef=!1,this.if=be(t),this.uf&&(this.uf(),this.uf=null);{const t=this.Xf.bind(this),s=this.xf.bind(this);this.uf=()=>{i.removeEventListener("mousemove",t),i.removeEventListener("mouseup",s)},i.addEventListener("mousemove",t),i.addEventListener("mouseup",s)}if(this.mf=!0,this.kf(t))return;const s=this.yf(t);this.Af(s,this.Df.rv),this.Xd||(this.Yd=0,this.Xd=setTimeout(this.Bf.bind(this),500),this.Kd=be(t))}Lf(){this.If.addEventListener("mouseenter",this.Ef.bind(this)),this.If.addEventListener("touchcancel",this.zf.bind(this));{const t=this.If.ownerDocument,i=t=>{this.Df.hv&&(t.composed&&this.If.contains(t.composedPath()[0])||t.target&&this.If.contains(t.target)||this.Df.hv())};this.lf=()=>{t.removeEventListener("touchstart",i)},this.hf=()=>{t.removeEventListener("mousedown",i)},t.addEventListener("mousedown",i),t.addEventListener("touchstart",i,{passive:!0})}ne()&&(this.af=()=>{this.If.removeEventListener("dblclick",this.Sf)},this.If.addEventListener("dblclick",this.Sf)),this.If.addEventListener("mouseleave",this.lv.bind(this)),this.If.addEventListener("touchstart",this.iv.bind(this),{passive:!0}),function(t){ee&&void 0!==window.chrome&&t.addEventListener("mousedown",(t=>{if(1===t.button)return t.preventDefault(),!1}))}(this.If),this.If.addEventListener("mousedown",this.ev.bind(this)),this.av(),this.If.addEventListener("touchmove",(()=>{}),{passive:!1})}av(){void 0===this.Df.ov&&void 0===this.Df._v&&void 0===this.Df.uv||(this.If.addEventListener("touchstart",(t=>this.cv(t.touches)),{passive:!0}),this.If.addEventListener("touchmove",(t=>{if(2===t.touches.length&&null!==this.df&&void 0!==this.Df._v){const i=me(t.touches[0],t.touches[1])/this.ff;this.Df._v(this.df,i),ve(t)}}),{passive:!1}),this.If.addEventListener("touchend",(t=>{this.cv(t.touches)})))}cv(t){1===t.length&&(this.vf=!1),2!==t.length||this.vf||this.tf?this.dv():this.fv(t)}fv(t){const i=this.If.getBoundingClientRect()||{left:0,top:0};this.df={et:(t[0].clientX-i.left+(t[1].clientX-i.left))/2,rt:(t[0].clientY-i.top+(t[1].clientY-i.top))/2},this.ff=me(t[0],t[1]),void 0!==this.Df.ov&&this.Df.ov(),this.zf()}dv(){null!==this.df&&(this.df=null,void 0!==this.Df.uv&&this.Df.uv())}lv(t){if(this._f&&this._f(),this.kf(t))return;if(!this.gf)return;const i=this.yf(t);this.Af(i,this.Df.vv),this.gf=!ne()}nv(t){const i=we(t.touches,C(this.wf));if(null===i)return;const s=this.yf(t,i);this.Pf(s,this.Df.pv),this.rf=!0,this.tf=!0}kf(t){return t.sourceCapabilities&&void 0!==t.sourceCapabilities.firesTouchEvents?t.sourceCapabilities.firesTouchEvents:ge(t)<this.bf+500}Pf(t,i){i&&i.call(this.Df,t)}Af(t,i){i&&i.call(this.Df,t)}yf(t,i){const s=i||t,e=this.If.getBoundingClientRect()||{left:0,top:0};return{clientX:s.clientX,clientY:s.clientY,pageX:s.pageX,pageY:s.pageY,screenX:s.screenX,screenY:s.screenY,localX:s.clientX-e.left,localY:s.clientY-e.top,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,metaKey:t.metaKey,mv:!t.type.startsWith("mouse")&&"contextmenu"!==t.type&&"click"!==t.type,bv:t.type,wv:s.target,gv:t.view,Mv:()=>{"touchstart"!==t.type&&ve(t)}}}}function me(t,i){const s=t.clientX-i.clientX,e=t.clientY-i.clientY;return Math.sqrt(s*s+e*e)}function ve(t){t.cancelable&&t.preventDefault()}function be(t){return{et:t.pageX,rt:t.pageY}}function ge(t){return t.timeStamp||performance.now()}function we(t,i){for(let s=0;s<t.length;++s)if(t[s].identifier===i)return t[s];return null}function ye(t){return{Wc:t.Wc,xv:{Tr:t.Sv.externalId},kv:t.Sv.cursorStyle}}function Se(t,i,s){for(const e of t){const t=e.xt();if(null!==t&&t.Cr){const h=t.Cr(i,s);if(null!==h)return{gv:e,xv:h}}}return null}function _e(t,i){return s=>{var e,h,n,r;return(null!==(h=null===(e=s.At())||void 0===e?void 0:e.Ra())&&void 0!==h?h:"")!==i?[]:null!==(r=null===(n=s.fa)||void 0===n?void 0:n.call(s,t))&&void 0!==r?r:[]}}class Me{constructor(t,i,s,h){this.ji=null,this.yv=null,this.Cv=!1,this.Tv=new ai(200),this.eh=null,this.Pv=0,this.Rv=!1,this.Dv=()=>{this.Rv||this.hn.Ov().Kt().Yh()},this.Av=()=>{this.Rv||this.hn.Ov().Kt().Yh()},this.hn=t,this.pn=i,this.yo=i.layout,this.Dc=s,this.Vv="left"===h,this.Bv=_e("normal",h),this.Iv=_e("top",h),this.Lv=_e("bottom",h),this.zv=document.createElement("div"),this.zv.style.height="100%",this.zv.style.overflow="hidden",this.zv.style.width="25px",this.zv.style.left="0",this.zv.style.position="relative",this.Ev=ue(this.zv,e({width:16,height:16})),this.Ev.subscribeSuggestedBitmapSizeChanged(this.Dv);const n=this.Ev.canvasElement;n.style.position="absolute",n.style.zIndex="1",n.style.left="0",n.style.top="0",this.Nv=ue(this.zv,e({width:16,height:16})),this.Nv.subscribeSuggestedBitmapSizeChanged(this.Av);const r=this.Nv.canvasElement;r.style.position="absolute",r.style.zIndex="2",r.style.left="0",r.style.top="0";const o={rv:this.Fv.bind(this),sv:this.Fv.bind(this),Kf:this.Wv.bind(this),Yf:this.Wv.bind(this),hv:this.jv.bind(this),Qf:this.Hv.bind(this),Gf:this.Hv.bind(this),Vf:this.$v.bind(this),Rf:this.$v.bind(this),Ff:this.Uv.bind(this),vv:this.qv.bind(this)};this.Yv=new pe(this.Nv.canvasElement,o,{Uf:()=>!1,qf:()=>!0})}S(){this.Yv.S(),this.Nv.unsubscribeSuggestedBitmapSizeChanged(this.Av),this.Nv.dispose(),this.Ev.unsubscribeSuggestedBitmapSizeChanged(this.Dv),this.Ev.dispose(),null!==this.ji&&this.ji.Go().p(this),this.ji=null}Xv(){return this.zv}P(){return this.yo.fontSize}Kv(){const t=this.Dc.W();return this.eh!==t.R&&(this.Tv.ar(),this.eh=t.R),t}Zv(){if(null===this.ji)return 0;let t=0;const i=this.Kv(),s=C(this.Ev.canvasElement.getContext("2d"));s.save();const e=this.ji.$a();s.font=this.Gv(),e.length>0&&(t=Math.max(this.Tv.Ti(s,e[0].eo),this.Tv.Ti(s,e[e.length-1].eo)));const h=this.Jv();for(let o=h.length;o--;){const i=this.Tv.Ti(s,h[o].ii());i>t&&(t=i)}const n=this.ji.Pt();if(null!==n&&null!==this.yv){const i=this.ji.gn(1,n),e=this.ji.gn(this.yv.height-2,n);t=Math.max(t,this.Tv.Ti(s,this.ji.Ui(Math.floor(Math.min(i,e))+.11111111111111,n)),this.Tv.Ti(s,this.ji.Ui(Math.ceil(Math.max(i,e))-.11111111111111,n)))}s.restore();const r=t||34;return re(Math.ceil(i.C+i.T+i.B+i.I+5+r))}Qv(t){null!==this.yv&&h(this.yv,t)||(this.yv=t,this.Rv=!0,this.Ev.resizeCanvasElement(t),this.Nv.resizeCanvasElement(t),this.Rv=!1,this.zv.style.width=`${t.width}px`,this.zv.style.height=`${t.height}px`)}tp(){return C(this.yv).width}sn(t){this.ji!==t&&(null!==this.ji&&this.ji.Go().p(this),this.ji=t,t.Go().l(this.vo.bind(this),this))}At(){return this.ji}ar(){const t=this.hn.ip();this.hn.Ov().Kt().N_(t,C(this.At()))}np(t){if(null===this.yv)return;if(1!==t){this.sp(),this.Ev.applySuggestedBitmapSize();const t=a(this.Ev);null!==t&&(t.useBitmapCoordinateSpace((t=>{this.ep(t),this.Ee(t)})),this.hn.rp(t,this.Lv),this.hp(t),this.hn.rp(t,this.Bv),this.lp(t))}this.Nv.applySuggestedBitmapSize();const i=a(this.Nv);null!==i&&(i.useBitmapCoordinateSpace((({context:t,bitmapSize:i})=>{t.clearRect(0,0,i.width,i.height)})),this.ap(i),this.hn.rp(i,this.Iv))}op(){return this.Ev.bitmapSize}_p(t,i,s){const e=this.op();e.width>0&&e.height>0&&t.drawImage(this.Ev.canvasElement,i,s)}gt(){var t;null===(t=this.ji)||void 0===t||t.$a()}Fv(t){if(null===this.ji||this.ji.$i()||!this.pn.handleScale.axisPressedMouseMove.price)return;const i=this.hn.Ov().Kt(),s=this.hn.ip();this.Cv=!0,i.A_(s,this.ji,t.localY)}Wv(t){if(null===this.ji||!this.pn.handleScale.axisPressedMouseMove.price)return;const i=this.hn.Ov().Kt(),s=this.hn.ip(),e=this.ji;i.V_(s,e,t.localY)}jv(){if(null===this.ji||!this.pn.handleScale.axisPressedMouseMove.price)return;const t=this.hn.Ov().Kt(),i=this.hn.ip(),s=this.ji;this.Cv&&(this.Cv=!1,t.B_(i,s))}Hv(t){if(null===this.ji||!this.pn.handleScale.axisPressedMouseMove.price)return;const i=this.hn.Ov().Kt(),s=this.hn.ip();this.Cv=!1,i.B_(s,this.ji)}$v(t){this.pn.handleScale.axisDoubleClickReset.price&&this.ar()}Uv(t){null!==this.ji&&(!this.hn.Ov().Kt().W().handleScale.axisPressedMouseMove.price||this.ji.Sh()||this.ji.Vo()||this.up(1))}qv(t){this.up(0)}Jv(){const t=[],i=null===this.ji?void 0:this.ji;return(s=>{for(let e=0;e<s.length;++e){const h=s[e].Vn(this.hn.ip(),i);for(let i=0;i<h.length;i++)t.push(h[i])}})(this.hn.ip().qo()),t}ep({context:t,bitmapSize:i}){const{width:s,height:e}=i,h=this.hn.ip().Kt(),n=h.q(),r=h.pd();n===r?ht(t,0,0,s,e,n):lt(t,0,0,s,e,n,r)}Ee({context:t,bitmapSize:i,horizontalPixelRatio:s}){if(null===this.yv||null===this.ji||!this.ji.W().borderVisible)return;t.fillStyle=this.ji.W().borderColor;const e=Math.max(1,Math.floor(this.Kv().C*s));let h;h=this.Vv?i.width-e:0,t.fillRect(h,0,e,i.height)}hp(t){if(null===this.yv||null===this.ji)return;const i=this.ji.$a(),s=this.ji.W(),e=this.Kv(),h=this.Vv?this.yv.width-e.T:0;s.borderVisible&&s.ticksVisible&&t.useBitmapCoordinateSpace((({context:t,horizontalPixelRatio:n,verticalPixelRatio:r})=>{t.fillStyle=s.borderColor;const o=Math.max(1,Math.floor(r)),l=Math.floor(.5*r),a=Math.round(e.T*n);t.beginPath();for(const s of i)t.rect(Math.floor(h*n),Math.round(s.Na*r)-l,a,o);t.fill()})),t.useMediaCoordinateSpace((({context:t})=>{var n;t.font=this.Gv(),t.fillStyle=null!==(n=s.textColor)&&void 0!==n?n:this.yo.textColor,t.textAlign=this.Vv?"right":"left",t.textBaseline="middle";const r=this.Vv?Math.round(h-e.B):Math.round(h+e.T+e.B),o=i.map((i=>this.Tv.Ci(t,i.eo)));for(let s=i.length;s--;){const e=i[s];t.fillText(e.eo,r,e.Na+o[s])}}))}sp(){if(null===this.yv||null===this.ji)return;let t=this.yv.height/2;const i=[],s=this.ji.qo().slice(),e=this.hn.ip(),h=this.Kv();this.ji===e.Sr()&&this.hn.ip().qo().forEach((t=>{e.Mr(t)&&s.push(t)}));const n=this.ji.Ba()[0],r=this.ji;s.forEach((s=>{const h=s.Vn(e,r);h.forEach((t=>{t.zi(null),t.Ei()&&i.push(t)})),n===s&&h.length>0&&(t=h[0].Ri())})),i.forEach((t=>t.zi(t.Ri()))),this.ji.W().alignLabels&&this.cp(i,h,t)}cp(t,i,s){if(null===this.yv)return;const e=t.filter((t=>t.Ri()<=s)),h=t.filter((t=>t.Ri()>s));e.sort(((t,i)=>i.Ri()-t.Ri())),e.length&&h.length&&h.push(e[0]),h.sort(((t,i)=>t.Ri()-i.Ri()));for(const n of t){const t=Math.floor(n.Lt(i)/2),s=n.Ri();s>-t&&s<t&&n.zi(t),s>this.yv.height-t&&s<this.yv.height+t&&n.zi(this.yv.height-t)}for(let n=1;n<e.length;n++){const t=e[n],s=e[n-1],h=s.Lt(i,!1),r=t.Ri(),o=s.Li();r>o-h&&t.zi(o-h)}for(let n=1;n<h.length;n++){const t=h[n],s=h[n-1],e=s.Lt(i,!0),r=t.Ri(),o=s.Li();r<o+e&&t.zi(o+e)}}lp(t){if(null===this.yv)return;const i=this.Jv(),s=this.Kv(),e=this.Vv?"right":"left";i.forEach((i=>{i.Ni()&&i.xt(C(this.ji)).K(t,s,this.Tv,e)}))}ap(t){if(null===this.yv||null===this.ji)return;const i=this.hn.Ov().Kt(),s=[],e=this.hn.ip(),h=i.qc().Vn(e,this.ji);h.length&&s.push(h);const n=this.Kv(),r=this.Vv?"right":"left";s.forEach((i=>{i.forEach((i=>{i.xt(C(this.ji)).K(t,n,this.Tv,r)}))}))}up(t){this.zv.style.cursor=1===t?"ns-resize":"default"}vo(){const t=this.Zv();this.Pv<t&&this.hn.Ov().Kt().Gl(),this.Pv=t}Gv(){return X(this.yo.fontSize,this.yo.fontFamily)}}function xe(t,i){var s,e;return null!==(e=null===(s=t.ca)||void 0===s?void 0:s.call(t,i))&&void 0!==e?e:[]}function Ce(t,i){var s,e;return null!==(e=null===(s=t.An)||void 0===s?void 0:s.call(t,i))&&void 0!==e?e:[]}function Ee(t,i){var s,e;return null!==(e=null===(s=t.en)||void 0===s?void 0:s.call(t,i))&&void 0!==e?e:[]}function Te(t,i){var s,e;return null!==(e=null===(s=t.oa)||void 0===s?void 0:s.call(t,i))&&void 0!==e?e:[]}class ze{constructor(t,i){this.yv=e({width:0,height:0}),this.dp=null,this.fp=null,this.vp=null,this.pp=!1,this.mp=new K,this.bp=new K,this.wp=0,this.gp=!1,this.Mp=null,this.xp=!1,this.Sp=null,this.kp=null,this.Rv=!1,this.Dv=()=>{this.Rv||null===this.yp||this.Ki().Yh()},this.Av=()=>{this.Rv||null===this.yp||this.Ki().Yh()},this.Cp=t,this.yp=i,this.yp.j_().l(this.Tp.bind(this),this,!0),this.Pp=document.createElement("td"),this.Pp.style.padding="0",this.Pp.style.position="relative";const s=document.createElement("div");s.style.width="100%",s.style.height="100%",s.style.position="relative",s.style.overflow="hidden",this.Rp=document.createElement("td"),this.Rp.style.padding="0",this.Dp=document.createElement("td"),this.Dp.style.padding="0",this.Pp.appendChild(s),this.Ev=ue(s,e({width:16,height:16})),this.Ev.subscribeSuggestedBitmapSizeChanged(this.Dv);const h=this.Ev.canvasElement;h.style.position="absolute",h.style.zIndex="1",h.style.left="0",h.style.top="0",this.Nv=ue(s,e({width:16,height:16})),this.Nv.subscribeSuggestedBitmapSizeChanged(this.Av);const n=this.Nv.canvasElement;n.style.position="absolute",n.style.zIndex="2",n.style.left="0",n.style.top="0",this.Op=document.createElement("tr"),this.Op.appendChild(this.Rp),this.Op.appendChild(this.Pp),this.Op.appendChild(this.Dp),this.Ap(),this.Yv=new pe(this.Nv.canvasElement,this,{Uf:()=>null===this.Mp&&!this.Cp.W().handleScroll.vertTouchDrag,qf:()=>null===this.Mp&&!this.Cp.W().handleScroll.horzTouchDrag})}S(){null!==this.dp&&this.dp.S(),null!==this.fp&&this.fp.S(),this.Nv.unsubscribeSuggestedBitmapSizeChanged(this.Av),this.Nv.dispose(),this.Ev.unsubscribeSuggestedBitmapSizeChanged(this.Dv),this.Ev.dispose(),null!==this.yp&&this.yp.j_().p(this),this.Yv.S()}ip(){return C(this.yp)}Vp(t){null!==this.yp&&this.yp.j_().p(this),this.yp=t,null!==this.yp&&this.yp.j_().l(ze.prototype.Tp.bind(this),this,!0),this.Ap()}Ov(){return this.Cp}Xv(){return this.Op}Ap(){if(null!==this.yp&&(this.Bp(),0!==this.Ki().Mt().length)){if(null!==this.dp){const t=this.yp.D_();this.dp.sn(C(t))}if(null!==this.fp){const t=this.yp.O_();this.fp.sn(C(t))}}}Ip(){null!==this.dp&&this.dp.gt(),null!==this.fp&&this.fp.gt()}x_(){return null!==this.yp?this.yp.x_():0}S_(t){this.yp&&this.yp.S_(t)}Ff(t){if(!this.yp)return;this.Lp();const i=t.localX,s=t.localY;this.zp(i,s,t)}rv(t){this.Lp(),this.Ep(),this.zp(t.localX,t.localY,t)}Wf(t){var i;if(!this.yp)return;this.Lp();const s=t.localX,e=t.localY;this.zp(s,e,t);const h=this.Cr(s,e);this.Cp.Np(null!==(i=null==h?void 0:h.kv)&&void 0!==i?i:null),this.Ki().Fc(h&&{Wc:h.Wc,xv:h.xv})}tv(t){null!==this.yp&&(this.Lp(),this.Fp(t))}Vf(t){null!==this.yp&&this.Wp(this.bp,t)}Rf(t){this.Vf(t)}Kf(t){this.Lp(),this.jp(t),this.zp(t.localX,t.localY,t)}Qf(t){null!==this.yp&&(this.Lp(),this.gp=!1,this.Hp(t))}Jf(t){null!==this.yp&&this.Fp(t)}pv(t){if(this.gp=!0,null===this.Mp){const i={x:t.localX,y:t.localY};this.$p(i,i,t)}}vv(t){null!==this.yp&&(this.Lp(),this.yp.Kt().Fc(null),this.Up())}qp(){return this.mp}Yp(){return this.bp}ov(){this.wp=1,this.Ki().Kn()}_v(t,i){if(!this.Cp.W().handleScale.pinch)return;const s=5*(i-this.wp);this.wp=i,this.Ki().Gc(t.et,s)}sv(t){this.gp=!1,this.xp=null!==this.Mp,this.Ep();const i=this.Ki().qc();null!==this.Mp&&i.Tt()&&(this.Sp={x:i.Jt(),y:i.Qt()},this.Mp={x:t.localX,y:t.localY})}Yf(t){if(null===this.yp)return;const i=t.localX,s=t.localY;if(null===this.Mp)this.jp(t);else{this.xp=!1;const e=C(this.Sp),h=e.x+(i-this.Mp.x),n=e.y+(s-this.Mp.y);this.zp(h,n,t)}}Gf(t){0===this.Ov().W().trackingMode.exitMode&&(this.xp=!0),this.Xp(),this.Hp(t)}Cr(t,i){const s=this.yp;return null===s?null:function(t,i,s){const e=t.qo(),h=function(t,i,s){var e,h;let n,r;for(const a of t){const t=null!==(h=null===(e=a.pa)||void 0===e?void 0:e.call(a,i,s))&&void 0!==h?h:[];for(const i of t)o=i.zOrder,(!(l=null==n?void 0:n.zOrder)||"top"===o&&"top"!==l||"normal"===o&&"bottom"===l)&&(n=i,r=a)}var o,l;return n&&r?{Sv:n,Wc:r}:null}(e,i,s);if("top"===(null==h?void 0:h.Sv.zOrder))return ye(h);for(const n of e){if(h&&h.Wc===n&&"bottom"!==h.Sv.zOrder&&!h.Sv.isBackground)return ye(h);const e=Se(n.An(t),i,s);if(null!==e)return{Wc:n,gv:e.gv,xv:e.xv};if(h&&h.Wc===n&&"bottom"!==h.Sv.zOrder&&h.Sv.isBackground)return ye(h)}return(null==h?void 0:h.Sv)?ye(h):null}(s,t,i)}Kp(t,i){C("left"===i?this.dp:this.fp).Qv(e({width:t,height:this.yv.height}))}Zp(){return this.yv}Qv(t){h(this.yv,t)||(this.yv=t,this.Rv=!0,this.Ev.resizeCanvasElement(t),this.Nv.resizeCanvasElement(t),this.Rv=!1,this.Pp.style.width=t.width+"px",this.Pp.style.height=t.height+"px")}Gp(){const t=C(this.yp);t.R_(t.D_()),t.R_(t.O_());for(const i of t.Ba())if(t.Mr(i)){const s=i.At();null!==s&&t.R_(s),i.In()}}op(){return this.Ev.bitmapSize}_p(t,i,s){const e=this.op();e.width>0&&e.height>0&&t.drawImage(this.Ev.canvasElement,i,s)}np(t){if(0===t)return;if(null===this.yp)return;if(t>1&&this.Gp(),null!==this.dp&&this.dp.np(t),null!==this.fp&&this.fp.np(t),1!==t){this.Ev.applySuggestedBitmapSize();const t=a(this.Ev);null!==t&&(t.useBitmapCoordinateSpace((t=>{this.ep(t)})),this.yp&&(this.Jp(t,xe),this.Qp(t),this.tm(t),this.Jp(t,Ce),this.Jp(t,Ee)))}this.Nv.applySuggestedBitmapSize();const i=a(this.Nv);null!==i&&(i.useBitmapCoordinateSpace((({context:t,bitmapSize:i})=>{t.clearRect(0,0,i.width,i.height)})),this.im(i),this.Jp(i,Te))}nm(){return this.dp}sm(){return this.fp}rp(t,i){this.Jp(t,i)}Tp(){null!==this.yp&&this.yp.j_().p(this),this.yp=null}Fp(t){this.Wp(this.mp,t)}Wp(t,i){const s=i.localX,e=i.localY;t.M()&&t.m(this.Ki().yt().Nu(s),{x:s,y:e},i)}ep({context:t,bitmapSize:i}){const{width:s,height:e}=i,h=this.Ki(),n=h.q(),r=h.pd();n===r?ht(t,0,0,s,e,r):lt(t,0,0,s,e,n,r)}Qp(t){const i=C(this.yp).H_().Xh().xt();null!==i&&i.K(t,!1)}tm(t){const i=this.Ki().Uc();this.rm(t,Ce,ce,i),this.rm(t,Ce,de,i)}im(t){this.rm(t,Ce,de,this.Ki().qc())}Jp(t,i){const s=C(this.yp).qo();for(const e of s)this.rm(t,i,ce,e);for(const e of s)this.rm(t,i,de,e)}rm(t,i,s,e){const h=C(this.yp),n=h.Kt().Nc(),r=null!==n&&n.Wc===e,o=null!==n&&r&&void 0!==n.xv?n.xv.Pr:void 0;fe(i,(i=>s(i,t,r,o)),e,h)}Bp(){if(null===this.yp)return;const t=this.Cp,i=this.yp.D_().W().visible,s=this.yp.O_().W().visible;i||null===this.dp||(this.Rp.removeChild(this.dp.Xv()),this.dp.S(),this.dp=null),s||null===this.fp||(this.Dp.removeChild(this.fp.Xv()),this.fp.S(),this.fp=null);const e=t.Kt().od();i&&null===this.dp&&(this.dp=new Me(this,t.W(),e,"left"),this.Rp.appendChild(this.dp.Xv())),s&&null===this.fp&&(this.fp=new Me(this,t.W(),e,"right"),this.Dp.appendChild(this.fp.Xv()))}hm(t){return t.mv&&this.gp||null!==this.Mp}lm(t){return Math.max(0,Math.min(t,this.yv.width-1))}am(t){return Math.max(0,Math.min(t,this.yv.height-1))}zp(t,i,s){this.Ki().rd(this.lm(t),this.am(i),s,C(this.yp))}Up(){this.Ki().ld()}Xp(){this.xp&&(this.Mp=null,this.Up())}$p(t,i,s){this.Mp=t,this.xp=!1,this.zp(i.x,i.y,s);const e=this.Ki().qc();this.Sp={x:e.Jt(),y:e.Qt()}}Ki(){return this.Cp.Kt()}Hp(t){if(!this.pp)return;const i=this.Ki(),s=this.ip();if(i.z_(s,s.wn()),this.vp=null,this.pp=!1,i.nd(),null!==this.kp){const t=performance.now(),s=i.yt();this.kp.zr(s.Hu(),t),this.kp.Qu(t)||i.Jn(this.kp)}}Lp(){this.Mp=null}Ep(){if(this.yp){if(this.Ki().Kn(),document.activeElement!==document.body&&document.activeElement!==document.documentElement)C(document.activeElement).blur();else{const t=document.getSelection();null!==t&&t.removeAllRanges()}!this.yp.wn().$i()&&this.Ki().yt().$i()}}jp(t){if(null===this.yp)return;const i=this.Ki(),s=i.yt();if(s.$i())return;const e=this.Cp.W(),h=e.handleScroll,n=e.kineticScroll;if((!h.pressedMouseMove||t.mv)&&(!h.horzTouchDrag&&!h.vertTouchDrag||!t.mv))return;const r=this.yp.wn(),o=performance.now();if(null!==this.vp||this.hm(t)||(this.vp={x:t.clientX,y:t.clientY,Dd:o,om:t.localX,_m:t.localY}),null!==this.vp&&!this.pp&&(this.vp.x!==t.clientX||this.vp.y!==t.clientY)){if(t.mv&&n.touch||!t.mv&&n.mouse){const t=s._e();this.kp=new ae(.2/t,7/t,.997,15/t),this.kp.Ud(s.Hu(),this.vp.Dd)}else this.kp=null;r.$i()||i.I_(this.yp,r,t.localY),i.Qc(t.localX),this.pp=!0}this.pp&&(r.$i()||i.L_(this.yp,r,t.localY),i.td(t.localX),null!==this.kp&&this.kp.Ud(s.Hu(),o))}}class ke{constructor(t,i,s,h,n){this.bt=!0,this.yv=e({width:0,height:0}),this.Dv=()=>this.np(3),this.Vv="left"===t,this.Dc=s.od,this.pn=i,this.um=h,this.dm=n,this.zv=document.createElement("div"),this.zv.style.width="25px",this.zv.style.height="100%",this.zv.style.overflow="hidden",this.Ev=ue(this.zv,e({width:16,height:16})),this.Ev.subscribeSuggestedBitmapSizeChanged(this.Dv)}S(){this.Ev.unsubscribeSuggestedBitmapSizeChanged(this.Dv),this.Ev.dispose()}Xv(){return this.zv}Zp(){return this.yv}Qv(t){h(this.yv,t)||(this.yv=t,this.Ev.resizeCanvasElement(t),this.zv.style.width=`${t.width}px`,this.zv.style.height=`${t.height}px`,this.bt=!0)}np(t){if(t<3&&!this.bt)return;if(0===this.yv.width||0===this.yv.height)return;this.bt=!1,this.Ev.applySuggestedBitmapSize();const i=a(this.Ev);null!==i&&i.useBitmapCoordinateSpace((t=>{this.ep(t),this.Ee(t)}))}op(){return this.Ev.bitmapSize}_p(t,i,s){const e=this.op();e.width>0&&e.height>0&&t.drawImage(this.Ev.canvasElement,i,s)}Ee({context:t,bitmapSize:i,horizontalPixelRatio:s,verticalPixelRatio:e}){if(!this.um())return;t.fillStyle=this.pn.timeScale.borderColor;const h=Math.floor(this.Dc.W().C*s),n=Math.floor(this.Dc.W().C*e),r=this.Vv?i.width-h:0;t.fillRect(r,0,h,n)}ep({context:t,bitmapSize:i}){ht(t,0,0,i.width,i.height,this.dm())}}function We(t){return i=>{var s,e;return null!==(e=null===(s=i.va)||void 0===s?void 0:s.call(i,t))&&void 0!==e?e:[]}}const Re=We("normal"),Oe=We("top"),Pe=We("bottom");class Le{constructor(t,i){this.fm=null,this.vm=null,this.k=null,this.pm=!1,this.yv=e({width:0,height:0}),this.bm=new K,this.Tv=new ai(5),this.Rv=!1,this.Dv=()=>{this.Rv||this.Cp.Kt().Yh()},this.Av=()=>{this.Rv||this.Cp.Kt().Yh()},this.Cp=t,this.Y_=i,this.pn=t.W().layout,this.wm=document.createElement("tr"),this.gm=document.createElement("td"),this.gm.style.padding="0",this.Mm=document.createElement("td"),this.Mm.style.padding="0",this.zv=document.createElement("td"),this.zv.style.height="25px",this.zv.style.padding="0",this.xm=document.createElement("div"),this.xm.style.width="100%",this.xm.style.height="100%",this.xm.style.position="relative",this.xm.style.overflow="hidden",this.zv.appendChild(this.xm),this.Ev=ue(this.xm,e({width:16,height:16})),this.Ev.subscribeSuggestedBitmapSizeChanged(this.Dv);const s=this.Ev.canvasElement;s.style.position="absolute",s.style.zIndex="1",s.style.left="0",s.style.top="0",this.Nv=ue(this.xm,e({width:16,height:16})),this.Nv.subscribeSuggestedBitmapSizeChanged(this.Av);const h=this.Nv.canvasElement;h.style.position="absolute",h.style.zIndex="2",h.style.left="0",h.style.top="0",this.wm.appendChild(this.gm),this.wm.appendChild(this.zv),this.wm.appendChild(this.Mm),this.Sm(),this.Cp.Kt().M_().l(this.Sm.bind(this),this),this.Yv=new pe(this.Nv.canvasElement,this,{Uf:()=>!0,qf:()=>!1})}S(){this.Yv.S(),null!==this.fm&&this.fm.S(),null!==this.vm&&this.vm.S(),this.Nv.unsubscribeSuggestedBitmapSizeChanged(this.Av),this.Nv.dispose(),this.Ev.unsubscribeSuggestedBitmapSizeChanged(this.Dv),this.Ev.dispose()}Xv(){return this.wm}km(){return this.fm}ym(){return this.vm}rv(t){if(this.pm)return;this.pm=!0;const i=this.Cp.Kt();!i.yt().$i()&&this.Cp.W().handleScale.axisPressedMouseMove.time&&i.Zc(t.localX)}sv(t){this.rv(t)}hv(){const t=this.Cp.Kt();!t.yt().$i()&&this.pm&&(this.pm=!1,this.Cp.W().handleScale.axisPressedMouseMove.time&&t.ed())}Kf(t){const i=this.Cp.Kt();!i.yt().$i()&&this.Cp.W().handleScale.axisPressedMouseMove.time&&i.sd(t.localX)}Yf(t){this.Kf(t)}Qf(){this.pm=!1;const t=this.Cp.Kt();t.yt().$i()&&!this.Cp.W().handleScale.axisPressedMouseMove.time||t.ed()}Gf(){this.Qf()}Vf(){this.Cp.W().handleScale.axisDoubleClickReset.time&&this.Cp.Kt().ts()}Rf(){this.Vf()}Ff(){this.Cp.Kt().W().handleScale.axisPressedMouseMove.time&&this.up(1)}vv(){this.up(0)}Zp(){return this.yv}Cm(){return this.bm}Tm(t,i,s){h(this.yv,t)||(this.yv=t,this.Rv=!0,this.Ev.resizeCanvasElement(t),this.Nv.resizeCanvasElement(t),this.Rv=!1,this.zv.style.width=`${t.width}px`,this.zv.style.height=`${t.height}px`,this.bm.m(t)),null!==this.fm&&this.fm.Qv(e({width:i,height:t.height})),null!==this.vm&&this.vm.Qv(e({width:s,height:t.height}))}Pm(){const t=this.Rm();return Math.ceil(t.C+t.T+t.P+t.L+t.V+t.Dm)}gt(){this.Cp.Kt().yt().$a()}op(){return this.Ev.bitmapSize}_p(t,i,s){const e=this.op();e.width>0&&e.height>0&&t.drawImage(this.Ev.canvasElement,i,s)}np(t){if(0===t)return;if(1!==t){this.Ev.applySuggestedBitmapSize();const i=a(this.Ev);null!==i&&(i.useBitmapCoordinateSpace((t=>{this.ep(t),this.Ee(t),this.Om(i,Pe)})),this.hp(i),this.Om(i,Re)),null!==this.fm&&this.fm.np(t),null!==this.vm&&this.vm.np(t)}this.Nv.applySuggestedBitmapSize();const i=a(this.Nv);null!==i&&(i.useBitmapCoordinateSpace((({context:t,bitmapSize:i})=>{t.clearRect(0,0,i.width,i.height)})),this.Am([...this.Cp.Kt().Mt(),this.Cp.Kt().qc()],i),this.Om(i,Oe))}Om(t,i){const s=this.Cp.Kt().Mt();for(const e of s)fe(i,(i=>ce(i,t,!1,void 0)),e,void 0);for(const e of s)fe(i,(i=>de(i,t,!1,void 0)),e,void 0)}ep({context:t,bitmapSize:i}){ht(t,0,0,i.width,i.height,this.Cp.Kt().pd())}Ee({context:t,bitmapSize:i,verticalPixelRatio:s}){if(this.Cp.W().timeScale.borderVisible){t.fillStyle=this.Vm();const e=Math.max(1,Math.floor(this.Rm().C*s));t.fillRect(0,0,i.width,e)}}hp(t){const i=this.Cp.Kt().yt(),s=i.$a();if(!s||0===s.length)return;const e=this.Y_.maxTickMarkWeight(s),h=this.Rm(),n=i.W();n.borderVisible&&n.ticksVisible&&t.useBitmapCoordinateSpace((({context:t,horizontalPixelRatio:i,verticalPixelRatio:e})=>{t.strokeStyle=this.Vm(),t.fillStyle=this.Vm();const n=Math.max(1,Math.floor(i)),r=Math.floor(.5*i);t.beginPath();const o=Math.round(h.T*e);for(let h=s.length;h--;){const e=Math.round(s[h].coord*i);t.rect(e-r,0,n,o)}t.fill()})),t.useMediaCoordinateSpace((({context:t})=>{const i=h.C+h.T+h.L+h.P/2;t.textAlign="center",t.textBaseline="middle",t.fillStyle=this.$(),t.font=this.Gv();for(const h of s)if(h.weight<e){const s=h.needAlignCoordinate?this.Bm(t,h.coord,h.label):h.coord;t.fillText(h.label,s,i)}t.font=this.Im();for(const h of s)if(h.weight>=e){const s=h.needAlignCoordinate?this.Bm(t,h.coord,h.label):h.coord;t.fillText(h.label,s,i)}}))}Bm(t,i,s){const e=this.Tv.Ti(t,s),h=e/2,n=Math.floor(i-h)+.5;return n<0?i+=Math.abs(0-n):n+e>this.yv.width&&(i-=Math.abs(this.yv.width-(n+e))),i}Am(t,i){const s=this.Rm();for(const e of t)for(const t of e.rn())t.xt().K(i,s)}Vm(){return this.Cp.W().timeScale.borderColor}$(){return this.pn.textColor}j(){return this.pn.fontSize}Gv(){return X(this.j(),this.pn.fontFamily)}Im(){return X(this.j(),this.pn.fontFamily,"bold")}Rm(){null===this.k&&(this.k={C:1,N:NaN,L:NaN,V:NaN,Yi:NaN,T:5,P:NaN,R:"",qi:new ai,Dm:0});const t=this.k,i=this.Gv();if(t.R!==i){const s=this.j();t.P=s,t.R=i,t.L=4*s/12,t.V=1*s/12,t.Yi=9*s/12,t.N=0,t.Dm=4*s/12,t.qi.ar()}return this.k}up(t){this.zv.style.cursor=1===t?"ew-resize":"default"}Sm(){const t=this.Cp.Kt(),i=t.W();i.leftPriceScale.visible||null===this.fm||(this.gm.removeChild(this.fm.Xv()),this.fm.S(),this.fm=null),i.rightPriceScale.visible||null===this.vm||(this.Mm.removeChild(this.vm.Xv()),this.vm.S(),this.vm=null);const s={od:this.Cp.Kt().od()},e=()=>i.leftPriceScale.borderVisible&&t.yt().W().borderVisible,h=()=>t.pd();i.leftPriceScale.visible&&null===this.fm&&(this.fm=new ke("left",i,s,e,h),this.gm.appendChild(this.fm.Xv())),i.rightPriceScale.visible&&null===this.vm&&(this.vm=new ke("right",i,s,e,h),this.Mm.appendChild(this.vm.Xv()))}}const Ne=!!ee&&!!navigator.userAgentData&&navigator.userAgentData.brands.some((t=>t.brand.includes("Chromium")))&&!!ee&&((null===(Ke=null===navigator||void 0===navigator?void 0:navigator.userAgentData)||void 0===Ke?void 0:Ke.platform)?"Windows"===navigator.userAgentData.platform:navigator.userAgent.toLowerCase().indexOf("win")>=0);var Ke;class De{constructor(t,i,s){var e;this.Lm=[],this.zm=0,this.lo=0,this.u_=0,this.Em=0,this.Nm=0,this.Fm=null,this.Wm=!1,this.mp=new K,this.bp=new K,this.Tc=new K,this.jm=null,this.Hm=null,this.$m=t,this.pn=i,this.Y_=s,this.wm=document.createElement("div"),this.wm.classList.add("tv-lightweight-charts"),this.wm.style.overflow="hidden",this.wm.style.direction="ltr",this.wm.style.width="100%",this.wm.style.height="100%",(e=this.wm).style.userSelect="none",e.style.webkitUserSelect="none",e.style.msUserSelect="none",e.style.MozUserSelect="none",e.style.webkitTapHighlightColor="transparent",this.Um=document.createElement("table"),this.Um.setAttribute("cellspacing","0"),this.wm.appendChild(this.Um),this.qm=this.Ym.bind(this),Ve(this.pn)&&this.Xm(!0),this.Ki=new As(this.Rc.bind(this),this.pn,s),this.Kt().Yc().l(this.Km.bind(this),this),this.Zm=new Le(this,this.Y_),this.Um.appendChild(this.Zm.Xv());const h=i.autoSize&&this.Gm();let n=this.pn.width,r=this.pn.height;if(h||0===n||0===r){const i=t.getBoundingClientRect();n=n||i.width,r=r||i.height}this.Jm(n,r),this.Qm(),t.appendChild(this.wm),this.tb(),this.Ki.yt().sc().l(this.Ki.Gl.bind(this.Ki),this),this.Ki.M_().l(this.Ki.Gl.bind(this.Ki),this)}Kt(){return this.Ki}W(){return this.pn}ib(){return this.Lm}nb(){return this.Zm}S(){this.Xm(!1),0!==this.zm&&window.cancelAnimationFrame(this.zm),this.Ki.Yc().p(this),this.Ki.yt().sc().p(this),this.Ki.M_().p(this),this.Ki.S();for(const t of this.Lm)this.Um.removeChild(t.Xv()),t.qp().p(this),t.Yp().p(this),t.S();this.Lm=[],C(this.Zm).S(),null!==this.wm.parentElement&&this.wm.parentElement.removeChild(this.wm),this.Tc.S(),this.mp.S(),this.bp.S(),this.sb()}Jm(t,i,s=!1){if(this.lo===i&&this.u_===t)return;const h=function(t){const i=Math.floor(t.width),s=Math.floor(t.height);return e({width:i-i%2,height:s-s%2})}(e({width:t,height:i}));this.lo=h.height,this.u_=h.width;const n=this.lo+"px",r=this.u_+"px";C(this.wm).style.height=n,C(this.wm).style.width=r,this.Um.style.height=n,this.Um.style.width=r,s?this.eb(wt.os(),performance.now()):this.Ki.Gl()}np(t){void 0===t&&(t=wt.os());for(let i=0;i<this.Lm.length;i++)this.Lm[i].np(t.Yn(i).$n);this.pn.timeScale.visible&&this.Zm.np(t.qn())}qh(t){const i=Ve(this.pn);this.Ki.qh(t);const s=Ve(this.pn);s!==i&&this.Xm(s),this.tb(),this.rb(t)}qp(){return this.mp}Yp(){return this.bp}Yc(){return this.Tc}hb(){null!==this.Fm&&(this.eb(this.Fm,performance.now()),this.Fm=null);const t=this.lb(null),i=document.createElement("canvas");i.width=t.width,i.height=t.height;const s=C(i.getContext("2d"));return this.lb(s),i}ab(t){return("left"!==t||this.ob())&&("right"!==t||this._b())?0===this.Lm.length?0:C("left"===t?this.Lm[0].nm():this.Lm[0].sm()).tp():0}ub(){return this.pn.autoSize&&null!==this.jm}cb(){return this.wm}Np(t){this.Hm=t,this.Hm?this.cb().style.setProperty("cursor",t):this.cb().style.removeProperty("cursor")}fb(){return this.Hm}vb(){return x(this.Lm[0]).Zp()}rb(t){(void 0!==t.autoSize||!this.jm||void 0===t.width&&void 0===t.height)&&(t.autoSize&&!this.jm&&this.Gm(),!1===t.autoSize&&null!==this.jm&&this.sb(),t.autoSize||void 0===t.width&&void 0===t.height||this.Jm(t.width||this.u_,t.height||this.lo))}lb(t){let i=0,s=0;const h=this.Lm[0],n=(i,s)=>{let e=0;for(let h=0;h<this.Lm.length;h++){const n=this.Lm[h],r=C("left"===i?n.nm():n.sm()),o=r.op();null!==t&&r._p(t,s,e),e+=o.height}};this.ob()&&(n("left",0),i+=C(h.nm()).op().width);for(let e=0;e<this.Lm.length;e++){const h=this.Lm[e],n=h.op();null!==t&&h._p(t,i,s),s+=n.height}i+=h.op().width,this._b()&&(n("right",i),i+=C(h.sm()).op().width);const r=(i,s,e)=>{C("left"===i?this.Zm.km():this.Zm.ym())._p(C(t),s,e)};if(this.pn.timeScale.visible){const i=this.Zm.op();if(null!==t){let e=0;this.ob()&&(r("left",e,s),e=C(h.nm()).op().width),this.Zm._p(t,e,s),e+=i.width,this._b()&&r("right",e,s)}s+=i.height}return e({width:i,height:s})}pb(){let t=0,i=0,s=0;for(const e of this.Lm)this.ob()&&(i=Math.max(i,C(e.nm()).Zv(),this.pn.leftPriceScale.minimumWidth)),this._b()&&(s=Math.max(s,C(e.sm()).Zv(),this.pn.rightPriceScale.minimumWidth)),t+=e.x_();i=re(i),s=re(s);const h=this.u_,n=this.lo,r=Math.max(h-i-s,0),o=this.pn.timeScale.visible;let l=o?Math.max(this.Zm.Pm(),this.pn.timeScale.minimumHeight):0;var a;l=(a=l)+a%2;const u=0+l,c=n<u?0:n-u,d=c/t;let f=0;for(let p=0;p<this.Lm.length;++p){const t=this.Lm[p];t.Vp(this.Ki.$c()[p]);let h=0,n=0;n=p===this.Lm.length-1?c-f:Math.round(t.x_()*d),h=Math.max(n,2),f+=h,t.Qv(e({width:r,height:h})),this.ob()&&t.Kp(i,"left"),this._b()&&t.Kp(s,"right"),t.ip()&&this.Ki.Xc(t.ip(),h)}this.Zm.Tm(e({width:o?r:0,height:l}),o?i:0,o?s:0),this.Ki.k_(r),this.Em!==i&&(this.Em=i),this.Nm!==s&&(this.Nm=s)}Xm(t){t?this.wm.addEventListener("wheel",this.qm,{passive:!1}):this.wm.removeEventListener("wheel",this.qm)}mb(t){switch(t.deltaMode){case t.DOM_DELTA_PAGE:return 120;case t.DOM_DELTA_LINE:return 32}return Ne?1/window.devicePixelRatio:1}Ym(t){if(!(0!==t.deltaX&&this.pn.handleScroll.mouseWheel||0!==t.deltaY&&this.pn.handleScale.mouseWheel))return;const i=this.mb(t),s=i*t.deltaX/100,e=-i*t.deltaY/100;if(t.cancelable&&t.preventDefault(),0!==e&&this.pn.handleScale.mouseWheel){const i=Math.sign(e)*Math.min(1,Math.abs(e)),s=t.clientX-this.wm.getBoundingClientRect().left;this.Kt().Gc(s,i)}0!==s&&this.pn.handleScroll.mouseWheel&&this.Kt().Jc(-80*s)}eb(t,i){var s;const e=t.qn();3===e&&this.bb(),3!==e&&2!==e||(this.wb(t),this.gb(t,i),this.Zm.gt(),this.Lm.forEach((t=>{t.Ip()})),3===(null===(s=this.Fm)||void 0===s?void 0:s.qn())&&(this.Fm.rs(t),this.bb(),this.wb(this.Fm),this.gb(this.Fm,i),t=this.Fm,this.Fm=null)),this.np(t)}gb(t,i){for(const s of t.es())this.hs(s,i)}wb(t){const i=this.Ki.$c();for(let s=0;s<i.length;s++)t.Yn(s).Un&&i[s].F_()}hs(t,i){const s=this.Ki.yt();switch(t.Zn){case 0:s.rc();break;case 1:s.hc(t.Vt);break;case 2:s.ns(t.Vt);break;case 3:s.ss(t.Vt);break;case 4:s.qu();break;case 5:t.Vt.Qu(i)||s.ss(t.Vt.tc(i))}}Rc(t){null!==this.Fm?this.Fm.rs(t):this.Fm=t,this.Wm||(this.Wm=!0,this.zm=window.requestAnimationFrame((t=>{if(this.Wm=!1,this.zm=0,null!==this.Fm){const i=this.Fm;this.Fm=null,this.eb(i,t);for(const s of i.es())if(5===s.Zn&&!s.Vt.Qu(t)){this.Kt().Jn(s.Vt);break}}})))}bb(){this.Qm()}Qm(){const t=this.Ki.$c(),i=t.length,s=this.Lm.length;for(let e=i;e<s;e++){const t=x(this.Lm.pop());this.Um.removeChild(t.Xv()),t.qp().p(this),t.Yp().p(this),t.S()}for(let e=s;e<i;e++){const i=new ze(this,t[e]);i.qp().l(this.Mb.bind(this),this),i.Yp().l(this.xb.bind(this),this),this.Lm.push(i),this.Um.insertBefore(i.Xv(),this.Zm.Xv())}for(let e=0;e<i;e++){const i=t[e],s=this.Lm[e];s.ip()!==i?s.Vp(i):s.Ap()}this.tb(),this.pb()}Sb(t,i,s){var e;const h=new Map;let n;if(null!==t&&this.Ki.Mt().forEach((i=>{const s=i.Nn().ol(t);null!==s&&h.set(i,s)})),null!==t){const i=null===(e=this.Ki.yt().Zi(t))||void 0===e?void 0:e.originalTime;void 0!==i&&(n=i)}const r=this.Kt().Nc(),o=null!==r&&r.Wc instanceof ss?r.Wc:void 0,l=null!==r&&void 0!==r.xv?r.xv.Tr:void 0;return{kb:n,le:null!=t?t:void 0,yb:null!=i?i:void 0,Cb:o,Tb:h,Pb:l,Rb:null!=s?s:void 0}}Mb(t,i,s){this.mp.m((()=>this.Sb(t,i,s)))}xb(t,i,s){this.bp.m((()=>this.Sb(t,i,s)))}Km(t,i,s){this.Tc.m((()=>this.Sb(t,i,s)))}tb(){const t=this.pn.timeScale.visible?"":"none";this.Zm.Xv().style.display=t}ob(){return this.Lm[0].ip().D_().W().visible}_b(){return this.Lm[0].ip().O_().W().visible}Gm(){return"ResizeObserver"in window&&(this.jm=new ResizeObserver((t=>{const i=t.find((t=>t.target===this.$m));i&&this.Jm(i.contentRect.width,i.contentRect.height)})),this.jm.observe(this.$m,{box:"border-box"}),!0)}sb(){null!==this.jm&&this.jm.disconnect(),this.jm=null}}function Ve(t){return Boolean(t.handleScroll.mouseWheel||t.handleScale.mouseWheel)}function Be(t,i){var s={};for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&i.indexOf(e)<0&&(s[e]=t[e]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var h=0;for(e=Object.getOwnPropertySymbols(t);h<e.length;h++)i.indexOf(e[h])<0&&Object.prototype.propertyIsEnumerable.call(t,e[h])&&(s[e[h]]=t[e[h]])}return s}function Ae(t,i,s,e){const h=s.value,n={le:i,ut:t,Vt:[h,h,h,h],kb:e};return void 0!==s.color&&(n.O=s.color),n}function Ie(t,i,s,e){const h=s.value,n={le:i,ut:t,Vt:[h,h,h,h],kb:e};return void 0!==s.lineColor&&(n._t=s.lineColor),void 0!==s.topColor&&(n.Os=s.topColor),void 0!==s.bottomColor&&(n.As=s.bottomColor),n}function je(t,i,s,e){const h=s.value,n={le:i,ut:t,Vt:[h,h,h,h],kb:e};return void 0!==s.topLineColor&&(n.Ae=s.topLineColor),void 0!==s.bottomLineColor&&(n.Ve=s.bottomLineColor),void 0!==s.topFillColor1&&(n.Te=s.topFillColor1),void 0!==s.topFillColor2&&(n.Pe=s.topFillColor2),void 0!==s.bottomFillColor1&&(n.Re=s.bottomFillColor1),void 0!==s.bottomFillColor2&&(n.De=s.bottomFillColor2),n}function Ye(t,i,s,e){const h={le:i,ut:t,Vt:[s.open,s.high,s.low,s.close],kb:e};return void 0!==s.color&&(h.O=s.color),h}function Fe(t,i,s,e){const h={le:i,ut:t,Vt:[s.open,s.high,s.low,s.close],kb:e};return void 0!==s.color&&(h.O=s.color),void 0!==s.borderColor&&(h.Bt=s.borderColor),void 0!==s.wickColor&&(h.Gh=s.wickColor),h}function $e(t,i,s,e,h){const n=x(h)(s),r=Math.max(...n),o=Math.min(...n),l=n[n.length-1],a=[l,r,o,l],u=s,{time:c,color:d}=u;return{le:i,ut:t,Vt:a,kb:e,Ze:Be(u,["time","color"]),O:d}}function Xe(t){return void 0!==t.Vt}function Ue(t,i){return void 0!==i.customValues&&(t.Db=i.customValues),t}function qe(t){return(i,s,e,h,n,r)=>function(t,i){return i?i(t):void 0===(s=t).open&&void 0===s.value;var s}(e,r)?Ue({ut:i,le:s,kb:h},e):Ue(t(i,s,e,h,n),e)}function Ze(t){return{Candlestick:qe(Fe),Bar:qe(Ye),Area:qe(Ie),Baseline:qe(je),Histogram:qe(Ae),Line:qe(Ae),Custom:qe($e)}[t]}function Qe(t){return{le:0,Ob:new Map,aa:t}}function He(t,i){if(void 0!==t&&0!==t.length)return{Ab:i.key(t[0].ut),Vb:i.key(t[t.length-1].ut)}}function Ge(t){let i;return t.forEach((t=>{void 0===i&&(i=t.kb)})),x(i)}class Je{constructor(t){this.Bb=new Map,this.Ib=new Map,this.Lb=new Map,this.zb=[],this.Y_=t}S(){this.Bb.clear(),this.Ib.clear(),this.Lb.clear(),this.zb=[]}Eb(t,i){let s=0!==this.Bb.size,e=!1;const h=this.Ib.get(t);if(void 0!==h)if(1===this.Ib.size)s=!1,e=!0,this.Bb.clear();else for(const o of this.zb)o.pointData.Ob.delete(t)&&(e=!0);let n=[];if(0!==i.length){const s=i.map((t=>t.time)),h=this.Y_.createConverterToInternalObj(i),r=Ze(t.il()),o=t.Ta(),l=t.Pa();n=i.map(((i,n)=>{const a=h(i.time),u=this.Y_.key(a);let c=this.Bb.get(u);void 0===c&&(c=Qe(a),this.Bb.set(u,c),e=!0);const d=r(a,c.le,i,s[n],o,l);return c.Ob.set(t,d),d}))}s&&this.Nb(),this.Fb(t,n);let r=-1;if(e){const t=[];this.Bb.forEach((i=>{t.push({timeWeight:0,time:i.aa,pointData:i,originalTime:Ge(i.Ob)})})),t.sort(((t,i)=>this.Y_.key(t.time)-this.Y_.key(i.time))),r=this.Wb(t)}return this.jb(t,r,function(t,i,s){const e=He(t,s),h=He(i,s);if(void 0!==e&&void 0!==h)return{ia:e.Vb>=h.Vb&&e.Ab>=h.Ab}}(this.Ib.get(t),h,this.Y_))}dd(t){return this.Eb(t,[])}Hb(t,i){const s=i;!function(t){void 0===t.kb&&(t.kb=t.time)}(s),this.Y_.preprocessData(i);const e=this.Y_.createConverterToInternalObj([i])(i.time),h=this.Lb.get(t);if(void 0!==h&&this.Y_.key(e)<this.Y_.key(h))throw new Error(`Cannot update oldest data, last time=${h}, new time=${e}`);let n=this.Bb.get(this.Y_.key(e));const r=void 0===n;void 0===n&&(n=Qe(e),this.Bb.set(this.Y_.key(e),n));const o=Ze(t.il()),l=t.Ta(),a=t.Pa(),u=o(e,n.le,i,s.kb,l,a);n.Ob.set(t,u),this.$b(t,u);const c={ia:Xe(u)};if(!r)return this.jb(t,-1,c);const d={timeWeight:0,time:n.aa,pointData:n,originalTime:Ge(n.Ob)},f=At(this.zb,this.Y_.key(d.time),((t,i)=>this.Y_.key(t.time)<i));this.zb.splice(f,0,d);for(let p=f;p<this.zb.length;++p)th(this.zb[p].pointData,p);return this.Y_.fillWeightsForPoints(this.zb,f),this.jb(t,f,c)}$b(t,i){let s=this.Ib.get(t);void 0===s&&(s=[],this.Ib.set(t,s));const e=0!==s.length?s[s.length-1]:null;null===e||this.Y_.key(i.ut)>this.Y_.key(e.ut)?Xe(i)&&s.push(i):Xe(i)?s[s.length-1]=i:s.splice(-1,1),this.Lb.set(t,i.ut)}Fb(t,i){0!==i.length?(this.Ib.set(t,i.filter(Xe)),this.Lb.set(t,i[i.length-1].ut)):(this.Ib.delete(t),this.Lb.delete(t))}Nb(){for(const t of this.zb)0===t.pointData.Ob.size&&this.Bb.delete(this.Y_.key(t.time))}Wb(t){let i=-1;for(let s=0;s<this.zb.length&&s<t.length;++s){const e=this.zb[s],h=t[s];if(this.Y_.key(e.time)!==this.Y_.key(h.time)){i=s;break}h.timeWeight=e.timeWeight,th(h.pointData,s)}if(-1===i&&this.zb.length!==t.length&&(i=Math.min(this.zb.length,t.length)),-1===i)return-1;for(let s=i;s<t.length;++s)th(t[s].pointData,s);return this.Y_.fillWeightsForPoints(t,i),this.zb=t,i}Ub(){if(0===this.Ib.size)return null;let t=0;return this.Ib.forEach((i=>{0!==i.length&&(t=Math.max(t,i[i.length-1].le))})),t}jb(t,i,s){const e={qb:new Map,yt:{Eu:this.Ub()}};if(-1!==i)this.Ib.forEach(((i,h)=>{e.qb.set(h,{Ze:i,Yb:h===t?s:void 0})})),this.Ib.has(t)||e.qb.set(t,{Ze:[],Yb:s}),e.yt.Xb=this.zb,e.yt.Kb=i;else{const i=this.Ib.get(t);e.qb.set(t,{Ze:i||[],Yb:s})}return e}}function th(t,i){t.le=i,t.Ob.forEach((t=>{t.le=i}))}function ih(t){const i={value:t.Vt[3],time:t.kb};return void 0!==t.Db&&(i.customValues=t.Db),i}function sh(t){const i=ih(t);return void 0!==t.O&&(i.color=t.O),i}function eh(t){const i=ih(t);return void 0!==t._t&&(i.lineColor=t._t),void 0!==t.Os&&(i.topColor=t.Os),void 0!==t.As&&(i.bottomColor=t.As),i}function hh(t){const i=ih(t);return void 0!==t.Ae&&(i.topLineColor=t.Ae),void 0!==t.Ve&&(i.bottomLineColor=t.Ve),void 0!==t.Te&&(i.topFillColor1=t.Te),void 0!==t.Pe&&(i.topFillColor2=t.Pe),void 0!==t.Re&&(i.bottomFillColor1=t.Re),void 0!==t.De&&(i.bottomFillColor2=t.De),i}function nh(t){const i={open:t.Vt[0],high:t.Vt[1],low:t.Vt[2],close:t.Vt[3],time:t.kb};return void 0!==t.Db&&(i.customValues=t.Db),i}function rh(t){const i=nh(t);return void 0!==t.O&&(i.color=t.O),i}function oh(t){const i=nh(t),{O:s,Bt:e,Gh:h}=t;return void 0!==s&&(i.color=s),void 0!==e&&(i.borderColor=e),void 0!==h&&(i.wickColor=h),i}function lh(t){return{Area:eh,Line:sh,Baseline:hh,Histogram:sh,Bar:rh,Candlestick:oh,Custom:ah}[t]}function ah(t){const i=t.kb;return Object.assign(Object.assign({},t.Ze),{time:i})}const uh={vertLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722",labelCornerRadius:10},horzLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722",labelCornerRadius:10},mode:1,centerMarker:{visible:!1,color:"#9598A1",lineWidth:1,lineLength:10}},ch={vertLines:{color:"#D6DCDE",style:0,visible:!0},horzLines:{color:"#D6DCDE",style:0,visible:!0}},dh={background:{type:"solid",color:"#FFFFFF"},textColor:"#191919",fontSize:12,fontFamily:$},fh={autoScale:!0,mode:0,invertScale:!1,alignLabels:!0,borderVisible:!0,borderColor:"#2B2B43",entireTextOnly:!1,visible:!1,ticksVisible:!1,scaleMargins:{bottom:.1,top:.2},minimumWidth:0},ph={rightOffset:0,barSpacing:6,minBarSpacing:.5,fixLeftEdge:!1,fixRightEdge:!1,lockVisibleTimeRangeOnResize:!1,rightBarStaysOnScroll:!1,borderVisible:!0,borderColor:"#2B2B43",visible:!0,timeVisible:!1,secondsVisible:!0,shiftVisibleRangeOnNewBar:!0,ticksVisible:!1,uniformDistribution:!1,minimumHeight:0},mh={color:"rgba(0, 0, 0, 0)",visible:!1,fontSize:48,fontFamily:$,fontStyle:"",text:"",horzAlign:"center",vertAlign:"center"};function vh(){return{width:0,height:0,autoSize:!1,layout:dh,crosshair:uh,grid:ch,overlayPriceScales:Object.assign({},fh),leftPriceScale:Object.assign(Object.assign({},fh),{visible:!1}),rightPriceScale:Object.assign(Object.assign({},fh),{visible:!0}),timeScale:ph,watermark:mh,localization:{locale:ee?navigator.language:"",dateFormat:"dd MMM 'yy"},handleScroll:{mouseWheel:!0,pressedMouseMove:!0,horzTouchDrag:!0,vertTouchDrag:!0},handleScale:{axisPressedMouseMove:{time:!0,price:!0},axisDoubleClickReset:{time:!0,price:!0},mouseWheel:!0,pinch:!0},kineticScroll:{mouse:!1,touch:!0},trackingMode:{exitMode:1}}}class bh{constructor(t,i){this.Zb=t,this.Gb=i}applyOptions(t){this.Zb.Kt().jc(this.Gb,t)}options(){return this.ji().W()}width(){return gt(this.Gb)?this.Zb.ab(this.Gb):0}ji(){return C(this.Zb.Kt().Hc(this.Gb)).At}}function gh(t,i,s){const e=Be(t,["time","originalTime"]),h=Object.assign({time:i},e);return void 0!==s&&(h.originalTime=s),h}const wh={color:"#FF0000",price:0,lineStyle:2,lineWidth:1,lineVisible:!0,axisLabelVisible:!0,title:"",axisLabelColor:"",axisLabelTextColor:"",axisLabelCornerRadius:11};class yh{constructor(t){this.Wh=t}applyOptions(t){this.Wh.qh(t)}options(){return this.Wh.W()}Jb(){return this.Wh}}class Sh{constructor(t,i,s,e,h){this.Qb=new K,this.Ws=t,this.tw=i,this.iw=s,this.Y_=h,this.nw=e}S(){this.Qb.S()}priceFormatter(){return this.Ws.wa()}priceToCoordinate(t){const i=this.Ws.Pt();return null===i?null:this.Ws.At().Ot(t,i.Vt)}coordinateToPrice(t){const i=this.Ws.Pt();return null===i?null:this.Ws.At().gn(t,i.Vt)}barsInLogicalRange(t){if(null===t)return null;const i=new ks(new Es(t.from,t.to)).au(),s=this.Ws.Nn();if(s.$i())return null;const e=s.ol(i.Is(),1),h=s.ol(i.mi(),-1),n=C(s.hl()),r=C(s.En());if(null!==e&&null!==h&&e.le>h.le)return{barsBefore:t.from-n,barsAfter:r-t.to};const o={barsBefore:null===e||e.le===n?t.from-n:e.le-n,barsAfter:null===h||h.le===r?r-t.to:r-h.le};return null!==e&&null!==h&&(o.from=e.kb,o.to=h.kb),o}setData(t){this.Y_,this.Ws.il(),this.tw.sw(this.Ws,t),this.ew("full")}update(t){this.Ws.il(),this.tw.rw(this.Ws,t),this.ew("update")}dataByIndex(t,i){const s=this.Ws.Nn().ol(t,i);return null===s?null:lh(this.seriesType())(s)}data(){const t=lh(this.seriesType());return this.Ws.Nn().re().map((i=>t(i)))}subscribeDataChanged(t){this.Qb.l(t)}unsubscribeDataChanged(t){this.Qb.v(t)}setMarkers(t){this.Y_;const i=t.map((t=>gh(t,this.Y_.convertHorzItemToInternal(t.time),t.time)));this.Ws.sa(i)}markers(){return this.Ws.ea().map((t=>gh(t,t.originalTime,void 0)))}applyOptions(t){this.Ws.qh(t)}options(){return j(this.Ws.W())}priceScale(){return this.iw.priceScale(this.Ws.At().Ra())}createPriceLine(t){const i=D(j(wh),t),s=this.Ws.ra(i);return new yh(s)}removePriceLine(t){this.Ws.ha(t.Jb())}seriesType(){return this.Ws.il()}attachPrimitive(t){this.Ws.ya(t),t.attached&&t.attached({chart:this.nw,series:this,requestUpdate:()=>this.Ws.Kt().Gl()})}detachPrimitive(t){this.Ws.Ca(t),t.detached&&t.detached()}ew(t){this.Qb.M()&&this.Qb.m(t)}}class _h{constructor(t,i,s){this.hw=new K,this.bu=new K,this.bm=new K,this.Ki=t,this.Cl=t.yt(),this.Zm=i,this.Cl.ic().l(this.lw.bind(this)),this.Cl.nc().l(this.aw.bind(this)),this.Zm.Cm().l(this.ow.bind(this)),this.Y_=s}S(){this.Cl.ic().p(this),this.Cl.nc().p(this),this.Zm.Cm().p(this),this.hw.S(),this.bu.S(),this.bm.S()}scrollPosition(){return this.Cl.Hu()}scrollToPosition(t,i){i?this.Cl.Ju(t,1e3):this.Ki.ss(t)}scrollToRealTime(){this.Cl.Gu()}getVisibleRange(){const t=this.Cl.Au();return null===t?null:{from:t.from.originalTime,to:t.to.originalTime}}setVisibleRange(t){const i={from:this.Y_.convertHorzItemToInternal(t.from),to:this.Y_.convertHorzItemToInternal(t.to)},s=this.Cl.Iu(i);this.Ki.fd(s)}getVisibleLogicalRange(){const t=this.Cl.Ou();return null===t?null:{from:t.Is(),to:t.mi()}}setVisibleLogicalRange(t){M(t.from<=t.to,"The from index cannot be after the to index."),this.Ki.fd(t)}resetTimeScale(){this.Ki.ts()}fitContent(){this.Ki.rc()}logicalToCoordinate(t){const i=this.Ki.yt();return i.$i()?null:i.zt(t)}coordinateToLogical(t){return this.Cl.$i()?null:this.Cl.Nu(t)}timeToCoordinate(t){const i=this.Y_.convertHorzItemToInternal(t),s=this.Cl.Aa(i,!1);return null===s?null:this.Cl.zt(s)}coordinateToTime(t){const i=this.Ki.yt(),s=i.Nu(t),e=i.Zi(s);return null===e?null:e.originalTime}width(){return this.Zm.Zp().width}height(){return this.Zm.Zp().height}subscribeVisibleTimeRangeChange(t){this.hw.l(t)}unsubscribeVisibleTimeRangeChange(t){this.hw.v(t)}subscribeVisibleLogicalRangeChange(t){this.bu.l(t)}unsubscribeVisibleLogicalRangeChange(t){this.bu.v(t)}subscribeSizeChange(t){this.bm.l(t)}unsubscribeSizeChange(t){this.bm.v(t)}applyOptions(t){this.Cl.qh(t)}options(){return Object.assign(Object.assign({},j(this.Cl.W())),{barSpacing:this.Cl._e()})}lw(){this.hw.M()&&this.hw.m(this.getVisibleRange())}aw(){this.bu.M()&&this.bu.m(this.getVisibleLogicalRange())}ow(t){this.bm.m(t.width,t.height)}}function Mh(t){return function(t){if(I(t.handleScale)){const i=t.handleScale;t.handleScale={axisDoubleClickReset:{time:i,price:i},axisPressedMouseMove:{time:i,price:i},mouseWheel:i,pinch:i}}else if(void 0!==t.handleScale){const{axisPressedMouseMove:i,axisDoubleClickReset:s}=t.handleScale;I(i)&&(t.handleScale.axisPressedMouseMove={time:i,price:i}),I(s)&&(t.handleScale.axisDoubleClickReset={time:s,price:s})}const i=t.handleScroll;I(i)&&(t.handleScroll={horzTouchDrag:i,vertTouchDrag:i,mouseWheel:i,pressedMouseMove:i})}(t),t}class xh{constructor(t,i,s){this._w=new Map,this.uw=new Map,this.cw=new K,this.dw=new K,this.fw=new K,this.pw=new Je(i);const e=void 0===s?j(vh()):D(j(vh()),Mh(s));this.Y_=i,this.Zb=new De(t,e,i),this.Zb.qp().l((t=>{this.cw.M()&&this.cw.m(this.mw(t()))}),this),this.Zb.Yp().l((t=>{this.dw.M()&&this.dw.m(this.mw(t()))}),this),this.Zb.Yc().l((t=>{this.fw.M()&&this.fw.m(this.mw(t()))}),this);const h=this.Zb.Kt();this.bw=new _h(h,this.Zb.nb(),this.Y_)}remove(){this.Zb.qp().p(this),this.Zb.Yp().p(this),this.Zb.Yc().p(this),this.bw.S(),this.Zb.S(),this._w.clear(),this.uw.clear(),this.cw.S(),this.dw.S(),this.fw.S(),this.pw.S()}resize(t,i,s){this.autoSizeActive()||this.Zb.Jm(t,i,s)}addCustomSeries(t,i){const s=E(t),e=Object.assign(Object.assign({},v),s.defaultOptions());return this.ww("Custom",e,i,s)}addAreaSeries(t){return this.ww("Area",f,t)}addBaselineSeries(t){return this.ww("Baseline",p,t)}addBarSeries(t){return this.ww("Bar",c,t)}addCandlestickSeries(t={}){return function(t){void 0!==t.borderColor&&(t.borderUpColor=t.borderColor,t.borderDownColor=t.borderColor),void 0!==t.wickColor&&(t.wickUpColor=t.wickColor,t.wickDownColor=t.wickColor)}(t),this.ww("Candlestick",u,t)}addHistogramSeries(t){return this.ww("Histogram",m,t)}addLineSeries(t){return this.ww("Line",d,t)}removeSeries(t){const i=x(this._w.get(t)),s=this.pw.dd(i);this.Zb.Kt().dd(i),this.gw(s),this._w.delete(t),this.uw.delete(i)}sw(t,i){this.gw(this.pw.Eb(t,i))}rw(t,i){this.gw(this.pw.Hb(t,i))}subscribeClick(t){this.cw.l(t)}unsubscribeClick(t){this.cw.v(t)}subscribeCrosshairMove(t){this.fw.l(t)}unsubscribeCrosshairMove(t){this.fw.v(t)}subscribeDblClick(t){this.dw.l(t)}unsubscribeDblClick(t){this.dw.v(t)}priceScale(t){return new bh(this.Zb,t)}timeScale(){return this.bw}applyOptions(t){this.Zb.qh(Mh(t))}options(){return this.Zb.W()}takeScreenshot(){return this.Zb.hb()}autoSizeActive(){return this.Zb.ub()}chartElement(){return this.Zb.cb()}paneSize(){const t=this.Zb.vb();return{height:t.height,width:t.width}}setCrosshairPosition(t,i,s){const e=this._w.get(s);if(void 0===e)return;const h=this.Zb.Kt().gr(e);null!==h&&this.Zb.Kt().hd(t,i,h)}clearCrosshairPosition(){this.Zb.Kt().ld(!0)}ww(t,i,s={},e){!function(t){if(void 0===t||"custom"===t.type)return;const i=t;void 0!==i.minMove&&void 0===i.precision&&(i.precision=function(t){if(t>=1)return 0;let i=0;for(;i<8;i++){const s=Math.round(t);if(Math.abs(s-t)<1e-8)return i;t*=10}return i}(i.minMove))}(s.priceFormat);const h=D(j(b),j(i),s),n=this.Zb.Kt()._d(t,h,e),r=new Sh(n,this,this,this,this.Y_);return this._w.set(r,n),this.uw.set(n,r),r}gw(t){const i=this.Zb.Kt();i.ad(t.yt.Eu,t.yt.Xb,t.yt.Kb),t.qb.forEach(((t,i)=>i.it(t.Ze,t.Yb))),i.Wu()}Mw(t){return x(this.uw.get(t))}mw(t){const i=new Map;t.Tb.forEach(((t,s)=>{const e=s.il(),h=lh(e)(t);if("Custom"!==e)M(function(t){return void 0!==t.open||void 0!==t.value}(h));else{const t=s.Pa();M(!t||!1===t(h))}i.set(this.Mw(s),h)}));const s=void 0===t.Cb?void 0:this.Mw(t.Cb);return{time:t.kb,logical:t.le,point:t.yb,hoveredSeries:s,hoveredObjectId:t.Pb,seriesData:i,sourceEvent:t.Rb}}}function Ch(t,i,s){let e;if(A(t)){const i=document.getElementById(t);M(null!==i,`Cannot find element in DOM with id=${t}`),e=i}else e=t;const h=new xh(e,i,s);return i.setOptions(h.options()),h}function Eh(t,i){return Ch(t,new se,se.Vd(i))}const Th=Object.assign(Object.assign({},b),v);function zh(){return"4.1.5-dev+202311170752"}}}]);